
*******************************************************************************
Perlový parser - záznam pokusù
*******************************************************************************



16.1.2002

Zkopíroval jsem si èást "am" z PDT verze 1. Tuto èást budu nyní
pou¾ívat pro trénování. Obsahuje 83197 vìt. Morfologická anotace je
provedena statisticky, morfologická analýza chybí, ale dá se snad
doplnit. Syntaktická anotace je ruèní.



17.1.2002

První mìøení na nových trénovacích datech, je¹tì v¹ak se starými
(baltimorskými) testovacími daty. Nový model je zatím výhradnì
lexikální (tj. funguje na slovních tvarech) a nebere v úvahu
závislosti, které byly pøi tréninku vidìt jenom jednou (tj. co bylo
vidìt jednou, jako by nebylo vidìt vùbec - ¹etøí se tím pamì» a èas).
Model také zatím nemá ¾ádné finesy, které jsem døíve doplòoval do
modelu na znaèkách, s výjimkou projektivity. Chybí tedy podpùrný model
pro plodnost slova, smìr závislosti i vzdálenost èlenù
závislosti. Také chybí Viterbi, tj. strom se buduje hladovou (ale
komponentovou) metodou.

G 28685 - B 35019 - P 45,0

Pøidán smìr hrany.

G 26955 - B 36749 - P 42,3

Ponechány i záznamy o hranách spatøených jen jednou.

G 43000 - B 20704 - P 67,5

Pøidána "vzdálenost" (sousední = B, blízko; nesousední = D, daleko).

G 44671 - B 19033 - P 70,1

Pøechod na testovací data z PDT1 (lu, lv, lw). Úspì¹nost klesla skoro
na polovinu, co¾ je dost zará¾ející, mo¾ná je chyba ve vyhodnocování
(nebo byla pøed chvílí).

G 49157 - B 77450 - P 38,8



18.1.2002

Po nalezení a odstranìní chyby ve skriptu se úspì¹nost vrátila u¾ jen
na 42 %. Závratné výsledky u starých dat byly zøejmì zpùsobeny tím, ¾e
stará testovací data jsou nyní souèástí nových trénovacích.

G 53217 - B 73390 - P 42,0

Z trénovacích i testovacích dat odstranìna velká písmena, zbyteènì
¹tìpila statistiky.

G 54027 - B 72580 - P 42,7

Je¹tì jeden pokus zahodit závislosti, které byly vidìt jenom jednou.

G 50365 - B 76242 - P 39,8

Vráceny závislosti vidìné jen jednou, pøidán model pro plodnost uzlu.

G 54421 - B 72186 - P 43,0

Odstranìna chyba, ¾e nìkteré vìty obsahovaly slovo "konec
øádku". Úspì¹nost klesla, proto¾e chyba umìle pøidávala neexistující
vìty, které se nedaly zkazit.

G 53982 - B 72046 - P 42,8

Pokus s modelem na znaèkách (od taggeru). Zatím neredukovaná sada
znaèek a bez Viterbiho, tak¾e pokud se výsledky podobají tìm z
Baltimoru, je to komponentovým budováním stromu a zejména vìt¹ím
objemem trénovacích dat a snadnìji analyzovatelnými testovacími daty.

G 71535 - B 54493 - P 56,8

Redukované znaèky: to snad ani za tu námahu nestojí! ®e by zase bug?

G 71622 - B 54406 - P 56,8

Znaèky redukované podle Collinse: u znaèek, které mají pád (N, A, P, C
a R), slovní druh a pád, u ostatních slovní druh a poddruh.

G 72207 - B 53821 - P 57,3

Po naètení statistik pro slova i znaèky úspì¹nost kupodivu mírnì
stoupla, by» se ve statistikách nadále hledaly jen znaèky. Mo¾ná
proto, ¾e nìkterá slova jsou shodná s nìkterými znaèkami a náhodou to
vy¹lo?

G 72364 - B 53664 - P 57,4



První kombinace modelu na slovech s modelem na znaèkách! Znaèkový
model se pou¾ije tehdy, kdy¾ slovní doporuèuje závislost, kterou nikdy
nevidìl. Jinak se dá v¾dy pøednost slovnímu modelu.

G 71445 - B 54583 - P 56,7

Pøi nahrazování slovních hran, které byly vidìt nejvý¹e jednou:

G 72593 - B 53435 - P 57,6

Pøi nahrazování slovních hran, které byly vidìt nejvý¹e dvakrát:

G 72327 - B 53701 - P 57,4



-------------------------------------------------------------------------------
Rokytnice nad Jizerou
Pozor, tento týden pokusy nejsou na stejných trénovacích ani
testovacích datech, proto¾e je dìlám na notebooku a ten neutáhne
pøíli¹ velká data. Ani bìhem toho týdne nejsou bohu¾el data poøád
stejná.



21.1.2002

V následujících testech se pøednostnì pou¾ívaly statistiky na slovech,
pokud byla èetnost 0, 1 nebo 2, pou¾ila se místo toho statistika na
znaèkách. Pokud se tedy dále mluví o èetnosti, je to buï èetnost na
slovech, nebo na znaèkách, podle toho, jak se výpoèet odvíjel.
924 slov celkem
Pøi pou¾ití v¹ech hran bez ohledu na èetnost:
G 605 - B 319 - UG 0 - UB 0 - P 65,5 % - R 65,5 %
Pøi vynechání hran s èetností 0:
G 582 - B 279 - UG 23 - UB 40 - P 67,6 % - R 63,0 %
Pøi vynechání hran s èetností men¹í ne¾ 2:
G 439 - B 168 - UG 166 - UB 151 - P 72,3 % - R 47,5 %
Pøi vynechání hran s èetností men¹í ne¾ 3:
G 354 - B 112 - UG 251 - UB 207 - P 76,0 % - R 38,3 %
Pøi vynechání hran s èetností men¹í ne¾ 4:
G 283 - B 68 - UG 322 - UB 251 - P 80,6 % - R 30,6 %
Pøi vynechání hran s èetností men¹í ne¾ 5:
G 244 - B 59 - UG 361 - UB 260 - P 80,5 % - R 26,4 %



22.1.2002

Nevynechávají se ¾ádná slova. V kolech, ve kterých vyhrála závislost se
slovní pravdìpodobností men¹í ne¾ 5, se hledání opakuje s pou¾itím
pravdìpodobnosti slo¾ené ze slovní a znaèkové pravdìpodobnosti, pøièem¾
obì mají stejnou váhu 0,5.

G 692 - B 232 - P 74,9

Dotaz: Najít pøípady, kdy na základì slovní pravdìpodobnosti vyhrála
¹patná závislost, ale s pou¾itím pravdìpodobnosti na dvojicích (heslo,
znaèka) by vyhrála správná závislost.

K tomu je nutné natrénovat model na dvojicích (heslo, znaèka). Jsou dvì
mo¾nosti, jak takový model definovat ale jen ta druhá má smysl; ta první
je témìø ekvivalentní modelu na slovech:

P = P((heslo1, znaèka1) - (heslo2, znaèka2)) = P(slovo1 - slovo2)
nebo
P = P(heslo1 - heslo2) * P(znaèka1 - znaèka2)



23.1.2002

Pøepsány kusy train.pl i parse.pl, aby se oba programy daly roz¹iøovat
o rùzné modely. Nyní je potøeba je vyladit, proto¾e kvùli nìjakým chybám
úspì¹nost zase hluboko klesla.

1. Model slovních, heslových a znaèkových závislostí pøetrénován na balíku
Lidových novin. 865 souborù, 45091 vìt, 698671 slov (bez koøenù). Kláøin
notebook trénuje rychlostí zhruba 1000 vìt za 50 vteøin (zpoèátku). Ale
limit, ne¾ notebook upadne do nekoneèného swapování, je asi 6000 vìt.
Nakonec vzat výsledek trénování podle prvních 5000 vìt. Nalezeno 57036
rùzných závislostí slov, 51328 rùzných závislostí hesel a 2681 rùzných
závislostí znaèek.



24.1.2002

Zaèínám testovat vèera natrénovaný model. Testovací data velká a malá
(kvùli rychlosti). Malá data: lu02.a (53 vìt, 924 slov bez koøenù).
Velká data: test.a = søetìzení lu02.a a¾ lu05.a (216 vì¾, 3540 slov bez
koøenù).

Samotný model závislostí znaèek bez modelu plodnosti. Výsledky v prvním
øádku platí pøi pou¾ití v¹ech hran vèetnì tìch, které nebyly v trénovacích
datech vidìt nikdy (tj. èirý odhad). Údaje ve druhém øádku takové závislosti
vynechávají.

G 510 - B 414 - P 55,2
G 488 - B 385 - P 55,9 - R 52,8

Model závislostí znaèek vèetnì plodnosti (ale bez závislostí slov).

G 519 - B 405 - P 56,2
G 499 - B 375 - P 57,1 - R 54,0

Model závislostí slov bez plodnosti. Tìch 53 vìt trvá na Kláøinì notebooku
11 minut, z toho 5 minut naèítání statistik!

G 315 - B 609 - P 34,1
G 174 - B 228 - P 43,3 - R 18,8

Toté¾, ale s plodností.

G 313 - B 611 - P 33,9
G 173 - B 229 - P 43,0 - R 18,7

Kombinace slovního a znaèkového modelu. Slovní závislosti vidìné alespoò
pìtkrát se pou¾ijí bez ohledu na plodnost. Jinak se zkombinují se znaèkovými
pùl na pùl (je u¾ nutné normalizovat èetnosti, aby se z nich staly pravdìpodobnosti,
ale døív jsem to nedìlal a fungovalo to, tak radìji vyzkou¹íme obojí).
Celková èetnost se násobí znaèkovou plodností, ¾ádná slovní plodnost se
nevyu¾ívá.

G 524 - B 400 - P 56,7
G 515 - B 379 - P 57,6 - R 55,7

Druhý pokus: od pøedchozího se li¹í pouze tím, ¾e absolutní èetnosti jsou
pøevedeny na relativní, tj. na pravdìpodobnosti.

G 524 - B 400 - P 56,7
G 515 - B 379 - P 57,6 - R 55,7

Je¹tì jeden nápad: Nekombinovat slova a znaèky pùl na pùl, ale v opaèném
pomìru, ne¾ v jakém jsou jejich prùmìrné èetnosti - aby se slova mìla
vùbec ¹anci prosadit. Nebo v pomìru "kolik je rùzných závislostí slov"
proti "kolik je rùzných znaèek".

G 525 - B 399 - P 56,8
G 516 - B 378 - P 57,7 - R 55,8



-------------------------------------------------------------------------------
Praha
Zpátky z Rokytnice nad Jizerou, nejdøív se pokusím pøesnì zopakovat
výsledky z Rokytnice (na stejných datech).



30.1.2002

Stejná trénovací i testovací data jako v Rokytnici, stejné výsledky -
to se mi ulevilo.

G 525 - B 399 - P 56,8
G 516 - B 378 - P 57,7 - R 55,8

Tohle je bez vyhlazení plodnosti a na rokytnických trénovacích datech
(prvních 5000 vìt z Lidových novin), ale na kompletních testovacích
datech (samé Lidové noviny).

G 72227 - B 53801 - P 57,3
G 69951 - B 51605 - P 57,5 - R 55,5

A teï je¹tì opaèný pokus: rokytnická testovací data (tj. pouze
lu02.a), ale v¹echna trénovací data (pøes 80000 vìt).

G 546 - B 378 - P 59,1
G 542 - B 367 - P 59,6 - R 58,7

Na závìr dne: rokytnické programy, ale kompletní trénovací i testovací
data z PDT 1.

G 72749 - B 53279 - P 57,7
G 71792 - B 52300 - P 57,9 - R 57,0



31.1.2002

Vyhlazení plodnosti. Pokud c(uzel)<5, dá se místo v¹ech nulových plodností
malé èíslo, které je men¹í ne¾ nejmen¹í skuteèná plodnost daného uzlu, celek
se pak normalizuje na souèet 1. U uzlù, které byly vidìt èastìji, se nuly
ponechávají, proto¾e se pova¾ují za dostateènì prokázané. Pseudokód pro
øídce pozorované uzly:
fmin = min(f(uzel, i), i);
n0 = count(f(uzel, i)==0);
foreach i where f(uzel, i)==0 {f(uzel, i) = 0.5*fmin/n0;}
for i = 0 to 3 {f(uzel, i) /= (1+0.5*fmin);}

G 72749 - B 53279 - P 57,7
G 71792 - B 52300 - P 57,9 - R 57,0

To je dost divné, ¾e by tato zmìna neudìlala s výsledky vùbec nic?
Nejspí¹ je to tím, ¾e momentálnì pou¾ívám jen znaèkovou plodnost a tam
se asi nuly pøíli¹ nevyskytují.

Zkusíme se tedy je¹tì vrátit ke slovní plodnosti, teï u¾
vyhlazené. Celková plodnost bude souèin slovní a znaèkové plodnosti.

G 72510 - B 53518 - P 57,5
G 72095 - B 53024 - P 57,6 - R 57,2

Pokus: adaptivní analýza. Po výbìru závislosti se tato pøidá do
statistiky a od pøí¹tì se mù¾e pou¾ít, jako by byla vidìna v
trénovacích datech.

G 71304 - B 54724 - P 56,6
G 71299 - B 54702 - P 56,6 - R 56,6

Je to zhor¹ení, tak¾e se vrátíme k pùvodnímu stavu. Chyb pøi analýze
je je¹tì pøíli¹ mnoho, ne¾ aby bylo dobré se z analýzy nìco uèit.



1.2.2002

Opìt zru¹it adaptivní analýzu a taky slovní plodnost.

Pokus o demagnetizaci souøadících spojek. Pokud se to podaøí, bude
je¹tì potøeba demagnetizovat dvojkøí¾ v koøeni, èárky (fungují jako
spojky) a mo¾ná i nìco dal¹ího.

První zpùsob demagnetizace: spojka a poslední èlen koordinace se
prohodí, ostatní èleny koordinace a èárky tedy závisejí na posledním
èlenu. Testování je zatím tím ménì èestným zpùsobem, tj. koordinace ve
vzorové analýze se transformují podobnì jako se transformovaly v
trénovacích datech. Èestnìj¹í by bylo provést inverzní transformaci
nalezené analýzy a výsledek porovnat s netransformovanou vzorovou
analýzou. Mù¾e se toti¾ stát, ¾e transformace nìjakou informaci
ztratí, a pak oba postupy nebudou ekvivalentní.

I tak je ov¹em výsledek katastrofální. Z mì neznámých pøíèin
transformace koordinací mimoøádnì zvý¹ily pøita¾livost koøenù vìt.

G 40659 - B 85369 - P 32,3
G 40656 - B 85353 - P 32,3 - R 32,3

Byla nìjaká bota v plodnosti. Zatím plodnost odstavena úplnì, ale
lep¹í výsledky asi budou, a¾ chybu odstraníme a plodnost znovu
pou¾ijeme.

G 75578 - B 50450 - P 60,0
G 75577 - B 50441 - P 60,0 - R 60,0



7.2.2002

Odstranìna chyba v plodnosti. Bohu¾el se ukazuje, ¾e ani tak není
plodnost v tomto tvaru pøínosem.

G 73320 - B 52708 - P 58,2
G 72823 - B 52255 - P 58,2 - R 57,8

Plodnost tedy vyøazena z èinnosti. Pro kontrolu je¹tì jednou test, mìl
by mít stejné výsledky jako poslední test z 1. února, ale není tomu
tak. Vý¹e zmínìná chyba (zpùsobená mimochodem u¾ pøi trénování, kdy se
dvojkøí¾ z koøene nahrazoval prázdným øetìzcem) mìla zøejmì pøi
vynechání plodnosti blahodárné úèinky. Nicménì i tohle je zlep¹ení
oproti pùvodním koordinacím o 0,6 %.

G 73427 - B 52601 - P 58,3
G 72985 - B 52059 - P 58,4 - R 57,9

Druhý zpùsob demagnetizace koordinaèních spojek. Koøenem podstromu je
poslední èlen koordinace, na ka¾dém èlenu koordinace v¾dy visí
pøedcházející èlen a èárka nebo spojka, která ho od pøedcházejícího
èlenu oddìluje.

G 74611 - B 51417 - P 59,2
G 74168 - B 50887 - P 59,3 - R 58,9

Tøetí zpùsob demagnetizace koordinaèních spojek. Koøenem podstromu je
poslední èlen koordinace, na nìm visí koordinaèní spojka, na ní
pøedcházející èlen koordinace, na nìm popø. èárka, pak dal¹í èlen atd.
---
Objevena chyba v transformacích koordinací. Po opravì chyby nové
pokusy.

První zpùsob (pouze výmìna koøene):

G 73943 - B 52085 - P 58,7
G 73464 - B 51538 - P 58,8 - R 58,3

Druhý zpùsob (binární stromeèek):

G 74398 - B 51630 - P 59,0
G 73919 - B 51084 - P 59,1 - R 58,7

Tøetí zpùsob (øetízek):

G 73059 - B 52969 - P 58,0
G 72681 - B 52474 - P 58,1 - R 57,7



8.2.2002

Velmi èasto se chybuje v teèce za vìtou. Dostane se na øadu a¾ pøíli¹
pozdì, tak¾e po ní døíve ne¾ koøen hmátne nìjaké slovo vìty. Dvì mo¾ná
øe¹ení. První: je-li na konci vìty interpunkce, hned na zaèátku ji
povìsit pod koøen. Druhé - statisticky èist¹í, ale pøedpokládám men¹í
úspì¹nost: do povolených hran pøidat hranu z koøene do posledního
dosud nezavì¹eného slova vìty - vzhledem k tomu, ¾e nepovolujeme
zavìsit koøen pod nìco jiného, projektivita se tím neporu¹í. Mo¾ná, ¾e
dokonce mù¾eme povolit hranu z koøene kamkoliv, ale tím si nejsem
jistý. Zatím zkusím nejjednodu¹¹í cestu, tj. první øe¹ení.

G 78156 - B 47872 - P 62,0
G 77975 - B 47735 - P 62,0 - R 61,9

Dal¹í problém je se slo¾enými pøedlo¾kami (napø. "v oboru"). I na nì
zavedeme transformaci a budeme je testovat "neèestným zpùsobem",
tj. tuté¾ transformaci provedeme s testovacími daty, místo abychom
inverzní transformaci provádìli s výsledkem analýzy. Výsledkem je
kupodivu zhor¹ení. Radìji tuto transformaci zru¹íme.

G 77619 - B 48409 - P 61,6
G 77440 - B 48283 - P 61,6 - R 61,4

Upravena Mikova redukce znaèek. U interpunkce pøidáno jako druhý znak
znaménko samo.

G 79364 - B 46664 - P 63,0
G 79153 - B 46359 - P 63,0 - R 62,8

Roz¹tìpena statistika o závislostech na koøeni. Místo na smìr (který
je od koøene v¾dy doprava) se ptáme, zda vìta obsahuje nebo neobsahuje
sloveso. Pokud ho toti¾ obsahuje, visí na koøeni obvykle ono,
popøípadì ¹éf koordinace, jeho¾ je èlenem, ale ne jiné slovní druhy.

G 79572 - B 46456 - P 63,1
G 78634 - B 44988 - P 63,6 - R 62,4

Neèekaným dùsledkem je velmi èasté chybné pøipojení slovesa na
koncovou interpunkci místo na koøen. Proto je¹tì roz¹íøíme úpravu sady
znaèek: pokud jde o poslední prvek vìty, pøipojí se na konec znaèky
"K", celá znaèka tedy bude napø. "Z.K".

G 81727 - B 44301 - P 64,8
G 78618 - B 40262 - P 66,1 - R 62,4

Úspì¹nost sice stoupla, ale na pøíkladech chybných vìt je vidìt, ¾e
v místech, kvùli kterým jsem k poslednímu opatøení sáhl, se toto
minulo úèinkem. Bude nutné je¹tì toté¾ co se znaèkou provést s heslem
a se slovem.

G 81901 - B 44127 - P 65,0
G 78624 - B 40100 - P 66,2 - R 62,4

Navzdory v¹í snaze ukázky chyb i nadále ukazují øadu závislostí vedoucích
koncové interpunkce dolù, tak¾e bychom je mo¾ná mohli zakázat natvrdo. Efekt
ale zpoèátku asi nebude velký, proto¾e ve stejném souboru chyb je vidìt, ¾e
koøen podstromu pod interpunkcí je stejnì nìjaký nesmysl, který koøenem být
nemá, tak¾e zavì¹ením celého podstromu jinam se chyba neodstraní. Asi je
nejvy¹¹í èas vrátit Viterbiho.



9.2.2002

Intermezzo - pokusy doma na men¹ích trénovacích i testovacích datech! Ke
trénování pou¾ity soubory zaèínající na "c1", k testování pouze soubor "l02.a".
Testujeme algoritmus Viterbiho, tak¾e nám zmizelo prùbì¾né sledování, co by se
stalo, kdybychom vynechávali závislosti s nulovou èetností. (Stejnì u¾ se to
del¹í dobu moc neli¹í.) Nicménì zatím testujeme jen funkènost, tak¾e ¹íøka
Viterbiho je nastavena na 1. Výsledek by tedy mìl být stejný jako døíve, co¾
je¹tì pro jistotu ovìøíme pozdìji na fakultì. POZOR (do pøedná¹ky)! Viterbi
vy¾aduje alespoò primitivní vyhlazení, nuly ho doká¾ou úplnì znièit!

G 629 - B 383 - P 62,2 - T 0:20 s



10.2.2002

Ale toté¾ starým programem dává jiné výsledky!

G 590 - B 334 - P 63,9 - T 0:16 s
G 569 - B 301 - P 65,4 - R 61,6

U Viterbiho vychází celkem 1012 závislostí, v pùvodní proceduøe 924 (co¾ je
èíslo, se kterým se setkávám u¾ dlouho, tak¾e mu vìøím spí¹).

Pøestávám porovnávat koøen (to jsou samé chyby), stejnì ale nedostávám souèet,
jaký má být. Úspì¹nost je ov¹em teï zas lep¹í ne¾ pùvodnì.

G 629 - B 335 - P 65,2

Objevena dal¹í chyba - zavì¹ení koncové interpunkce se zapoèítávalo dvakrát.
Nyní u¾ výsledky Viterbi(1) vypadají stejnì jako výsledky pùvodní procedury:

G 590 - B 334 - P 63,9

Viterbi(2)

G 563 - B 361 - P 60,9

Viterbi(2) se zapoèítáním obou nejlep¹ích stromù:

G 1091 - B 694 - P 61,1

Objevena dal¹í chyba - koøen nemìl znaèku #, nýbr¾ prázdný øetìzec. Oprava ale
výsledky vylep¹it nedokázala.

G 590 - B 334 - P 63,9

Objevena dal¹í chyba - hrany se dìlily podle smìru i u koøene, pøesto¾e tam je
smìr v¾dy doprava a místo smìru se mìlo sledovat, zda vìta obsahuje sloveso.

G 595 - B 329 - P 64,4
G 594 - B 325 - P 64,6 - R 64,3

Toté¾ s viterbim(2), zapoèítávají se oba nejlep¹í stromy:

G 826 - B 501 - P 62,2

A teï se asi definitivnì vrátíme k analýze bez Viterbiho (resp. k Viterbimu
s paprskem ¹íøky 1). Nicménì budeme nadále pracovat s programem, který
Viterbiho na po¾ádání umo¾òuje. Starý program od této chvíle pøestávám
aktualizovat.

G 595 - B 329 - P 64,4

U znaèkového modelu nyní k pøedlo¾kám místo pádu dávám pøímo pøedlo¾ku samu.
Bráním se tím zbyteèným chybám zpùsobeným mylným výstupem Honzova taggeru.

G 596 - B 328 - P 64,5

Do vzdálenosti pøidán tøetí stav. Kromì B (blízko, tj. sousedi) a D (daleko,
tj. nesousedi) je¹tì zvlá¹tní druh D, oznaèený èárkou (",") a znamenající, ¾e
mezi dotyènými se vyskytla èárka. První výsledky jsem poøídil omylem - model
byl u¾ natrénován se tøemi stavy, ale pou¾it stále jen se dvìma. Jsem zvìdavý,
jestli po opravì dojde k dal¹ímu zlep¹ení, nebo naopak ke zhor¹ení...

G 611 - B 313 - P 66,1

Po opravì skuteènì trochu ztrácím, na¹tìstí ne a¾ na pùvodní úroveò:

G 607 - B 317 - P 65,7

Model vzdálenosti je¹tì roz¹íøen, nyní je evidován i poèet èárek, které se mezi
uzly vmìstnaly. Tím by se mohly spravit víceèlenné koordinace.

G 612 - B 312 - P 66,2



11.2.2002

Pøeneseno zpátky na fakultu. Natrénováno opìt na 83000 vìt, testováno
na 7319 vìtách. Jinak vnitønì shodné. Výsledky jsou mírným zlep¹ením
oproti stavu na fakultì v pátek veèer, ale zhor¹ením oproti stavu
vèera veèer doma.

G 82312 - B 43818 - P 65,3 - T 5:28

Pro jistotu zkusíme je¹tì jednou Viterbiho. ®ádné pøekvapení se
bohu¾el nekoná :-(

G 93253 - B 51820 - P 64,3 - T 25:32

Pokusil jsem se, aby se stejnì jako u analýzy ani u tréninku u¾
nevynechávala poslední vìta. Proto¾e jsem v¹ak pøidal podmínku, ¾e se
zpracovávají jen neprázdné vìty, celkový poèet ve skuteènosti klesl, a
to o dost: na 73088. Trénování trvalo nìco pøes 2:49 minuty. Poèet
testovacích vìt zùstává 7319.

G 82312 - B 43818 - P 65,3

Do znaèky pro podstatné jméno jsem pøidal údaj, zda jde o køestní
jméno osoby (s dvojicí køestní jméno - pøíjmení se zachází jinak ne¾ s
jinou podobnou dvojicí podstatných jmen a bývají v tom chyby - snad
tato evidence pomù¾e)...

G 82948 - B 43257 - P 65,7

Malá statistika navíc:
34717 pøípadù rozhodoval pouze znaèkový model (slovní p=0).
      To je 27,5 % ze 126205 celkem rozhodovaných slov.
      Tyto pøípady dopadly G 20681 - B 14036 - P 59,6.
100 % správných vìt bylo 867, tj. asi 11,8 %.
      Nejdel¹í z nich mìla 18 (!) slov.
      Prùmìrnì takové vìty mìly 4 slova.
      Prùmìrná délka testovací vìty je pøitom 17 slov.
      Mo¾ná by bylo zajímavé odvodit statistiku, která by kromì
      úspì¹nosti na závislostech také mìøila, jak tì¾ké bylo této
      úspì¹nosti dosáhnout - na vìtách o 1 slovu to bylo jednoduché,
      na vìtách o 100 slovech je i 50 % velký úspìch - mo¾ná vìt¹í,
      ne¾ odpovídá 50 zavì¹eným slovùm?



První pokus s modelem závislostí hesel. Samostatnì testujeme model
"hesla*znacky", tj. pravdìpodobnost, ¾e se souèasnì vyskytla daná
závislost mezi hesly a daná závislost mezi znaèkami. (To není toté¾
jako pravdìpodobnost, ¾e se vyskytla závislost, její¾ øídící uzel má
souèasnì dané heslo1 a znaèku1 a závislý uzel má souèasnì dané heslo2
a znaèku2. Tato druhá mo¾nost je témìø ekvivalentní modelu závislostí
slov, zatímco první mo¾nost je ménì specificky parametrizována.

"slova"
A 126030 - G 54684 - B 71346 - P 43,4 (vse)
A  40496 - G 22634 - B 17862 - P 55,9 (>=5)
A  29997 - G 15635 - B 14362 - P 52,1 (>=1)
A  55537 - G 16415 - B 39122 - P 29,6 (==0)

"hesla"
A 126030 - G 46360 - B 79670 - P 36,8 (vse)
A  44601 - G 20362 - B 24239 - P 45,7 (>=5)
A  21059 - G  8002 - B 13057 - P 38,0 (>=1)
A  60370 - G 17996 - B 42374 - P 29,8 (==0)

"znacky"
A 126030 - G 85215 - B 40815 - P 67,6 (vse) <== NEJLEPSI!!!
A 119222 - G 78586 - B 40636 - P 65,9 (>=5)
A    210 - G    79 - B   131 - P 37,6 (>=1)
A   6598 - G  6550 - B    48 - P 99,3 (==0) - ze by tohle byly Z.K?

"0.5*slova+0.5*znacky" (resp. "$ls*slova+$lz*znacky")
A 126030 - G 84264 - B 41766 - P 66,9 (vse)
A 111976 - G 74632 - B 37344 - P 66,6 (>=5)
A   7444 - G  3081 - B  4363 - P 41,4 (>=1)
A   6610 - G  6551 - B    59 - P 99,1 (==0)

pro >=5 "slova", jinak "0.5*slova+0.5*znacky"
A 126030 - G 82487 - B 43543 - P 65,5 (vse)
A 111734 - G 72799 - B 38935 - P 65,2 (>=5)
A   7680 - G  3135 - B  4545 - P 40,8 (>=1)
A   6616 - G  6553 - B    63 - P 99,0 (==0)

pro >=15 "slova", jinak "0.5*slova+0.5*znacky"
A 126030 - G 84089 - B 41941 - P 66,7 (vse)
A 119175 - G 77448 - B 41727 - P 65,0 (>=5)
A    244 - G    89 - B   155 - P 36,5 (>=1)
A   6611 - G  6552 - B    59 - P 99,1 (==0)

"hesla*znacky"
A 126030 - G 47558 - B 78472 - P 37,7 (vse)
A  63766 - G 29378 - B 34388 - P 46,1 (>=5)
A   1289 - G    39 - B  1250 - P  3,0 (>=1)
A  60975 - G 18141 - B 42834 - P 29,8 (==0)

"slovo-znacka"
A 126030 - G 46213 - B 79817 - P 36,7 (vse)
A 109476 - G 37433 - B 72043 - P 34,2 (>=5)
A   8915 - G  2083 - B  6832 - P 23,4 (>=1)
A   7639 - G  6697 - B   942 - P 87,7 (==0)

"heslo-znacka"
A 126030 - G 44212 - B 81818 - P 35,1 (vse)
A 111258 - G 36476 - B 74782 - P 32,8 (>=5)
A   7092 - G  1044 - B  6048 - P 14,7 (>=1)
A   7680 - G  6692 - B   988 - P 87,1 (==0)

"(heslo-znacka)*znacky"
A 126030 - G 54773 - B 71257 - P 43,5 (vse)
A  21132 - G 14391 - B  6741 - P 68,1 (>=5)
A  97168 - G 33680 - B 63488 - P 34,7 (>=1)
A   7730 - G  6702 - B  1028 - P 86,7 (==0)

pro >=5 "(heslo-znacka)*znacky", jinak "znacky"
A 126030 - G 85101 - B 40929 - P 67,5 (vse)
A 119222 - G 78472 - B 40750 - P 65,8 (>=5)
A    210 - G    79 - B   131 - P 37,6 (>=1)
A   6598 - G  6550 - B    48 - P 99,3 (==0)



12.2.2002

Hledáme nejlep¹í vyvá¾ení modelù "slova" a "znaèky".
"ls*slova+lz*znacky"

ls=0
A 126030 - G 85215 - B 40815 - P 67,6 (vse)
A 119222 - G 78586 - B 40636 - P 65,9 (>=5)
A    210 - G    79 - B   131 - P 37,6 (>=1)
A   6598 - G  6550 - B    48 - P 99,3 (==0)

ls=0,25
A 126030 - G 85150 - B 40880 - P 67,6 (vse)
A 119151 - G 78493 - B 40658 - P 65,9 (>=5)
A    281 - G   107 - B   174 - P 38,1 (>=1)
A   6598 - G  6550 - B    48 - P 99,3 (==0)

ls=0,5
A 126030 - G 85262 - B 40768 - P 67,7 (vse)
A 119052 - G 78569 - B 40483 - P 66,0 (>=5)
A    376 - G   143 - B   233 - P 38,0 (>=1)
A   6602 - G  6550 - B    52 - P 99,2 (==0)

ls=0,5625
A 126030 - G 85265 - B 40765 - P 67,7 (vse)
A 118953 - G 78540 - B 40413 - P 66,0 (>=5)
A    475 - G   175 - B   300 - P 36,8 (>=1)
A   6602 - G  6550 - B    52 - P 99,2 (==0)

ls=0,625
A 126030 - G 85292 - B 40738 - P 67,7 (vse)
A 118863 - G 78536 - B 40327 - P 66,1 (>=5)
A    564 - G   206 - B   358 - P 36,5 (>=1)
A   6603 - G  6550 - B    53 - P 99,2 (==0)

ls=0,6875
A 126030 - G 85304 - B 40726 - P 67,7 (vse)
A 118807 - G 78520 - B 40287 - P 66,1 (>=5)
A    620 - G   234 - B   386 - P 37,7 (>=1)
A   6603 - G  6550 - B    53 - P 99,2 (==0)

ls=0,71875
A 126030 - G 85339 - B 40691 - P 67,7 (vse)
A 118755 - G 78537 - B 40218 - P 66,1 (>=5)
A    672 - G   252 - B   420 - P 37,5 (>=1)
A   6603 - G  6550 - B    53 - P 99,2 (==0)

ls=0,734375
A 126030 - G 85355 - B 40675 - P 67,7 (vse) <== NEJLEP©Í!
A 118699 - G 78542 - B 40157 - P 66,2 (>=5)
A    728 - G   263 - B   465 - P 36,1 (>=1)
A   6603 - G  6550 - B    53 - P 99,2 (==0)

ls=0,7421875
A 126030 - G 85205 - B 40825 - P 67,6 (vse)
A 118675 - G 78383 - B 40292 - P 66,0 (>=5)
A    752 - G   272 - B   480 - P 36,2 (>=1)
A   6603 - G  6550 - B    53 - P 99,2 (==0)

ls=0,75
A 126030 - G 85222 - B 40808 - P 67,6 (vse)
A 118666 - G 78399 - B 40267 - P 66,1 (>=5)
A    759 - G   273 - B   486 - P 36,0 (>=1)
A   6605 - G  6550 - B    55 - P 99,2 (==0)

ls=1
A 126030 - G 54684 - B 71346 - P 43,4 (vse)
A  40496 - G 22634 - B 17862 - P 55,9 (>=5)
A  29997 - G 15635 - B 14362 - P 52,1 (>=1)
A  55537 - G 16415 - B 39122 - P 29,6 (==0)

První pøiblí¾ení k pou¾ití valence a souèasnì k pou¾ití
trigramù. Pravdìpodobnost závislosti novì parametrizována otázkou, zda
u¾ ekvivalentní závislý uzel pod tímté¾ øídícím uzlem
visí. Ekvivalentní je takový uzel, který má stejnou morfologickou
znaèku (resp. ty dva znaky, které nám z ní zbyly).

G 84960 - B 41070 - P 67,4

Zhor¹ení. Zkusíme zjemnit definici ekvivalentních sourozencù. Pokud
mají oba pád, musejí ho mít stejný; jinak musejí mít stejné první
písmeno znaèky.



12.2.2002 veèer doma

Opakování posledního testu, ale na domácích trénovacích a testovacích datech.

G 623 - B 301 - P 67,4

Pokus: z testovacích dat vynechány vìty, které obsahují alespoò jednu závislost
typu ExD. Pokus je inspirován Carrollem et al. (1998), který do testování
experimentu se subkategorizaèními pravdìpodobnostmi pøi parsingu zahrnul pouze
vìty pokryté svou gramatikou (tj. vìty, ke kterým gramatika najde alespoò jednu
analýzu) s odùvodnìním, ¾e zbytek stejnì obsahuje eliptické jmenné vìty,
fragmenty dialogù a podobné podivnosti, které se stejnì nesna¾í pokrýt.

G 449 - B 215 - P 67,6

Dota¾ení pokusu do konce: dotyèné vìty byly vynechány i pøi tréninku. Místo asi
1900 vìt se trénovací mno¾ina scvrkla jen na 1246 vìt.

G 446 - B 218 - P 67,2

Od diskriminace vìt s ExD tedy zase ustupuji. Ustupuji také od parametrizace
pravdìpodobností podle dvojèat, proto¾e to úspì¹nost nezvedlo a chyby, kterými
to bylo motivováno, se vyskytují vesele dál. Máme tedy opìt 1983 trénovacích
vìt a 924 testovacích závislostí.

G 608 - B 316 - P 65,8

Pozor! Tak¾e úspì¹nost na domácích datech je výraznì hor¹í! V tomto svìtle
pøestává být úplnì jisté, ¾e od vìcí, od kterých jsem právì ustoupil, jsem
opravdu ustupovat mìl. I kdy¾ jistý není ani opak, statistická prùkaznost
domácích dat je pøece jenom nízká.

Opraveno poèítání úspì¹nosti pro závislosti vybrané náhodou (ve statistice mìly
èetnost 0). Chyba spoèívala v tom, ¾e se mezi tyto hrany pøipletly závislosti
koncové interpunkce na koøeni, které se pøiøazují bez statistiky, tj. èetnost u
nich nebyla uvedena, ale mìly skoro stoprocentní úspì¹nost.

A 924 - G 608 - B 316 - P 65,8 (v¹e)
A 749 - G 529 - B 220 - P 70,6 (>=5)
A 157 - G  71 - B  86 - P 45,2 (>=1)
A  18 - G   8 - B  10 - P 44,4 (==0)

Pokus: Vynechat z tréninku a testu vìty, které obsahují koordinaci nebo
apozici. Z 1983 trénovacích vìt zbylo 900. Z testovacích vìt zbylo 21 (tj. 257
slov).

A 257 - G 187 - B 70 - P 72,8 (v¹e)
A 140 - G 119 - B 21 - P 85,0 (>=5)
A 111 - G  65 - B 46 - P 58,6 (>=1)
A   6 - G   3 - B  3 - P 50,0 (==0)



13.2.2002

Zopakován experiment s vynecháním koordinací a apozic. V trénovacích
datech zbylo 36200 vìt, v testovacích 3496 vìt.

A 41598 - G 31367 - B 10231 - P 75,4 (v¹e)
A 40805 - G 31050 - B  9755 - P 76,1 (>=5)
A   756 - G   303 - B   453 - P 40,1 (>=1)
A    37 - G    14 - B    23 - P 37,8 (==0)

Zopakován experiment s vynecháním ExD (koordinace a apozice
vráceny). V trénovacích datech zbylo 53500 vìt, v testovacích 5522
vìt.

A 99092 - G 68494 - B 30598 - P 69,1 (v¹e)
A 98253 - G 68200 - B 30053 - P 69,4 (>=5)
A   762 - G   283 - B   479 - P 37,1 (>=1)
A    77 - G    11 - B    66 - P 14,3 (==0)

Spojeny poslední dva pokusy. Vynechány jsou vìty obsahující ExD,
koordinaci nebo apozici. V trénovacích datech zbylo 25900 vìt,
v testovacích 2658.

A 36114 - G 27430 - B 8684 - P 76,0 (v¹e)
A 35300 - G 27076 - B 8224 - P 76,7 (>=5)
A   746 - G   340 - B  406 - P 45,6 (>=1)
A    68 - G    14 - B   54 - P 20,6 (==0)

Prùzkum je hotov. Zkusím nicménì tento stav vìcí nìjakou dobu
ponechat. Jednak se tím zrychluje výpoèet a jednak se mù¾u lépe
soustøedit na druhy chyb, které s koordinacemi nesouvisejí.

Pokus: pøestaneme do délky závislosti zahrnovat poèet èárek, proto¾e
tím se mo¾ná statistika pøíli¹ drobí. Ponecháme v¹ak informaci, zda se
na trase aspoò jedna èárka vyskytla, èi nikoliv.

G 27435 - B 8679 - P 76,0

Zlep¹ení je minimální, ale alespoò se to nezhor¹ilo, tak¾e to tak
necháme.

Valence - úvodní prùzkum. Do výsledkù jsou nyní zahrnuty pouze
závislosti typu Sb, Obj, Adv, Pnom. Typ se urèí podle vzorové vìty,
pokud byl závislý uzel zavì¹en jinam, je to chyba. Analyzuje se ov¹em
celá vìta.

G 8848 - B 2569 - P 77,5

Tvary slovesa "být" zkopírovány do znaèek. Slibuji si od toho, ¾e
konstrukce "bude dìlat" ("dìlat" má být øídící) se u¾ nebude plést
s "mù¾e dìlat" ("mù¾e" má být øídící).

G 9014 - B 2403 - P 79,0

Znova rozli¹eny znaèky pro zvratná zájmena "se", "si" od ostatních
zájmen. Dùvod: tato dvì zájmena hrají øádovì vìt¹í roli pøi valenci
ne¾ v¹echna ostatní zájmena, tak¾e by mìlo pomoct, kdy¾ si je nebudeme
plést. Poznámka: mezi funkcemi, které se mají kvùli valencím sledovat,
jsem zapomnìl uvést AuxT. V nejbli¾¹ím pokusu ho tedy je¹tì také
vynechám, pak se k nìmu vrátím.

G 9019 - B 2398 - P 79,0

Nepatrné zlep¹ení. A teï jak to vyjde pøi pøidání kontroly AuxT?
(První výsledky jsou opakováním baseline, druhé opakováním pokusu s
pøidaným "být", tøetí opakováním pokusu s pøidaným "se/si".)

G 9254 - B 2677 - P 77,6
G 9445 - B 2486 - P 79,2
G 9456 - B 2475 - P 79,3

Je¹tì vylep¹ení "být". Je-li záporné, odstranit pøedponu "ne-". Je-li
v pøíèestí minulém, odstranit koncovku rodu a èísla. U infinitivu se
zastaralou koncovkou "-ti" odstranit koncové "-i".

G 9489 - B 2442 - P 79,5

Nejprimitivnìj¹í valence. Zkusit pøidat heslo ka¾dého slovesa do
znaèky (pøi zachování prvních dvou písmen znaèky). Pravdìpodobnì to
spí¹ u¹kodí, proto¾e data pøíli¹ zøídnou bez nále¾itého vyhlazení, ale
za zkou¹ku to stojí.

G 6522 - B 5409 - P 54,7

Tak snad ani za zkou¹ku to nestálo. Je¹tì malý diletantský pokus
(diletantský, proto¾e se pøíli¹ nezatì¾uje dodr¾ením zákonù
pravdìpodobnosti): u závislostí, jejich¾ øídícím uzlem je sloveso,
udìlat dva záznamy do té¾e tabulky: jeden bude mít v øídícím uzlu jen
morfologickou znaèku, druhý ji bude mít obohacenu o heslo jako v
pøedchozím pokusu. V závislém uzlu bude za v¹ech okolností znaèka. Pøi
analýze se pak vytáhnou oba záznamy a èetnosti se seètou. Tím se
jednak trochu vyhladí øídkost dat, jednak se celkovì zvýhodní
závislosti øízené slovesem oproti jiným, tj. slovesné vazby se snad
budou øe¹it o nìco pøednostnìji.

G 9537 - B 2394 - P 79,9

Jednoduchá valence. Na zaèátku ka¾dé analýzy si najít v¹echna slovesa
ve vìtì, ke ka¾dému z nich v¹echny známé rámce, ty rozsekat na èleny,
najít potenciální instance èlenù ve vìtì a v¹echny takto vzniklé
závislosti si zapamatovat jako valenèní. Zatím se neptáme ani po tom,
zda je nìkterá vazba povinná (vyskytuje se ve v¹ech rámcích), ani zda
dvì rùzné valenèní závislosti na tomté¾ slovese jsou ze stejného rámce
tohoto slovesa, ani zda jedna valence není uspokojována opakovanì, ani
zda valenèní závislost pøeskakuje jiné sloveso, které má stejnou
neuspokojenou valenci. Na zaèátku ka¾dého kola pak hledáme nejdøíve
valenèní závislosti a teprve v pøípadì, ¾e ¾ádná z nich není povolená,
hledáme mezi ostatními.

G 8660 - B 3271 - P 72,6

Zdá se, ¾e tam, kde jedno sloveso má více variant rámcù, zbyteènì
vyhrávají ty ménì pravdìpodobné. Utøiïme tedy valenèní závislosti
sestupnì podle pravdìpodobnosti.

G 8835 - B 3096 - P 74,1

A dále: valenèní závislosti dostanou pøednost pouze v pøípadì, ¾e u¾
je povolena ta nejlep¹í z nich. Jinak se postupuje normálním
zpùsobem. I tak samozøejmì mù¾e vyhrát valenèní závislost, která není
nejlep¹í z valenèních.

G 9416 - B 2515 - P 78,9

Opravena chyba: nezvratná zájmena s pádem nebyla zapoèítána jako
jmenné argumenty (jde zejména o vzta¾ná a ukazovací zájmena - "to",
"který" apod.).

G 9426 - B 2505 - P 79,0

Zkusíme je¹tì jako druhé kritérium øazení valenèních závislostí pøidat
délku závislosti (èím krat¹í, tím lep¹í).

G 9407 - B 2524 - P 78,8

Nezlep¹uje se to. Ne¾ vrátíme náhodnou, zkusíme tedy, zda pomù¾e
pøístup "èím del¹í, tím lep¹í".

G 9445 - B 2486 - P 79,2

Kupodivu je tu mírné zlep¹ení! Tak¾e to tak necháme.

Zásobník valenèních závislostí se mù¾e zaseknout, pokud na jeho èele
vìzí závislost, která u¾ nikdy nebude povolena. V takovém pøípadì je
nutné závislost ze zásobníku odstranit. Takový pøípad se pozná podle
toho, ¾e nastala jedna z následujících podmínek: 1) závislý uzel u¾ je
pøipojen jinde; 2) nad závislým uzlem vede závislost, která nevede nad
øídícím nebo obrácenì.

G 9401 - B 2530 - P 78,8

Nepomohlo to a je to dost divoké, tak to vrátím do pùvodního
stavu. Nìkdy bych mohl ladìním vyzkoumat, co se tam vlastnì dìje a ve
kterých pøípadech k tomu do¹lo, ale teï na to není èas.

G 9445 - B 2486 - P 79,2

Zkusím z testu vynechat Adv (vìt¹inou nejsou souèástí valence).

G 5903 - B 1668 - P 78,0

Vrátíme Adv, vynecháme Sb (nejsou podchyceny valenèními rámci).

G 6962 - B 1953 - P 78,1

Vrátíme obojí.

G 9445 - B 2486 - P 79,2

Vynecháme z valence sloveso "být", proto¾e samo u¾ je bez valence
podchyceno celkem dobøe a naopak se mnohokrát vyskytuje jako pomocné,
nebo s mnoha rùznými rámci, tak¾e valence by ho mohla spí¹ poplést.

G 9455 - B 2476 - P 79,2

Zvýhodníme zavì¹ování tìch vedlej¹ích vìt, které jdou snadno poznat,
ale dosavadní model na to nemá nástroj. Jakmile pod sloveso pøipojíme
zleva heslo "který", koukneme se, zda je pøed ním èárka, pøipojíme ji
také a potom hledáme nejbli¾¹í pøedcházející podstatné jméno nebo
zájmeno (mìlo by se shodovat v rodì a èísle, ale to souèasné znaèky
neumo¾òují, tak to odlo¾íme - stejnì nepùjde o pøedmìt ani podobnou
závislost, tak¾e jde spí¹e o uklizení vedlej¹í vìty ne¾ o její správné
zavì¹ení).

G 9507 - B 2424 - P 79,7

Zkombinovat "diletantskou pseudovalenci", kterou jsme nahoøe dosáhli
79,9 %, s tím, co jsme pou¾ili v posledním pokusu. Dùvod: teï sice
lépe ne¾ u pseudovalence preferuju valenèní závislosti pøed
nevalenèními, ale pro rozli¹ení valenèních mezi sebou zase potøebuju
urèitý stupeò lexikalizace, a ten byl v pseudovalenci obsa¾en.

G 9564 - B 2367 - P 80,2

Zvratná zájmena "se" a "si" jsou u nìkterých sloves také zahrnuta pod
valencemi N4, resp. N3. Povolíme tedy obojí.

G 9560 - B 2371 - P 80,1

Malé zhor¹ení. Nové valence na sebe spí¹e nabalily rùzné dal¹í
kraviny. Vý¹e uvedené druhy "se" a "si" je nutné nìjak øe¹it, ale
takhle to nejde, tak¾e beru zpìt.

MUSIM ALE ZKONTROLOVAT seznam vazeb, který pou¾ívám! Poslednì
provádìný pokus jsem dìlal, proto¾e v seznamu vùbec nebylo "obrátit
se" (bylo tam pouze "obrátit N4"), pøitom na webu je jasnì vidìt, ¾e
existuje rámec "obrátit se na".



14.2.2002

Pokus: spojky "¾e", "aby" a ("zda" nebo "zdali") se pøilepí ke
znaèce.

G 9635 - B 2296 - P 80,8

Ale zapomnìl jsem upravit znaèky ve valencích, mo¾ná to bude je¹tì
lep¹í.

G 9619 - B 2312 - P 80,6

Ou nou! Jakto¾e je to zase hor¹í? Musím to ale asi nechat takhle, je
to správnìj¹í.



21.2.2002

Pokus o poøádné zmìøení nìkterých výsledkù uvádìných ve èlánku do
Taibei. Musím se dokázat vrátit k pùvodní verzi programu, v pátek pøed
odesláním èlánku jsem to dìlal narychlo zbrkle a nepovedlo se mi to.

První krok: nyní lze v konfiguraci nastavit, zda se mají testovat
pouze hrany, které mají ve vzorových datech urèitou analytickou
funkci, nebo v¹echny hrany. První výsledek je pro hrany s afuny Sb,
Obj, Adv, Pnom a AuxT (tedy stejné jako ve v¹ech pokusech posledních
dnù), druhý je pro v¹echny hrany (afun .*).

G  9491 - B 2440 - P 79,5
G 27318 - B 8796 - P 75,6

Druhý krok: specifikaci afunù, které se nesmí ve vìtì vyskytnout, aby
vìta nebyla vynechána, u¾ konfigurace umo¾òuje. Nyní se zkusíme vrátit
na neomezená data. První výsledek je se zakázanými afuny ExD, Coord a
Apos (tak to bylo posledních nìkolik dnù), druhý je pro povolené
v¹echny afuny pøi testu (av¹ak natrénováno je poøád na omezených
datech), tøetí pou¾ívá neomezená data pøi testu i pøi tréninku. Ve
v¹ech pokusech u¾ je ponecháno testování libovolných afunù (ve vìtách,
které nebyly vynechány).

G 27318 - B  8796 - P 75,6
G 84026 - B 42004 - P 66,7
G 83540 - B 42490 - P 66,3

Ni¾¹í úspì¹nost tøetího pokusu vzhledem k druhému je
pøekvapující. Kromì toho jsme klesli i pod pùvodní
úspì¹nost. Oèekáváno:

G 85355 - B 40675 - P 67,7

Pøi zbrklém páteèním pokusu o návrat byly ov¹em vyøazeny ve¹keré
machinace s morfologickými znaèkami, tak¾e mimo jiné zmizel také
rozdíl mezi uzly závisejícími na koøeni, kdy¾ ve vìtì bylo sloveso, a
kdy¾ tam nebylo. Nyní naopak ve¹keré machinace vracím a budu je pak
vyøazovat postupnì, s vìt¹ím rozmyslem. Nejdøíve ale prùbì¾né
pøetrénování a pøetestování:

G 87589 - B 38441 - P 69,5

Nyní odstraníme tzv. selektivní lexikalizaci znaèek, tj. ve¹keré
machinace se znaèkami vèetnì pøidávání lemmatu do znaèky pro
interpunkci. Výjimkou je pouze úprava znaèek pro køestní jméno, kde se
ale nepøidává lemma, nýbr¾ celá lexikální kategorie; kromì toho to
nesouvisí s valencí. Interpunkce s valencí taky moc nesouvisí, tak¾e
ji v pøí¹tím kroku je¹tì také vrátím. Teï ale prùbì¾né výsledky:

G 84314 - B 41716 - P 66,9

Vrácena lexikalizace znaèek pro interpunkci a pøedlo¾ky. (Pøedlo¾ky
byly lexikalizovány u¾ 10.2.2002, interpunkce je¹tì døíve.)

G 85997 - B 40033 - P 68,2

Úspì¹nost je poøád vy¹¹í ne¾ pøed pokusy s valencí. Mohlo by to být
tím, ¾e teï v délce závislosti eviduji výskyt èárky, tenkrát jsem
evidoval i poèet èárek. Je¹tì tedy zkusím vrátit poèet èárek. Je¹tì
jsem také nalezl násilnou úpravu vedlej¹ích vìt zaèínajících zájmenem
"který", a vypnul jsem ji.

G 85350 - B 40680 - P 67,7

Koneènì jsem se trefil více ménì do pøedvalenèního výsledku (jsem
jenom o pìt závislostí hor¹í). Teï tedy opìt pøestanu evidovat poèet
èárek mezi øídícím a závislým a místo nìj budu evidovat pouze
existenci èárky.

G 85360 - B 40670 - P 67,7

Vypínám lexikalizaci pøedlo¾ek, ta se stane souèástí balíku
"selektivní lexikalizace", a nemù¾e se tedy zapoèítávat do baseline
pøed valenèními pokusy. Pøi selektivní lexikalizaci u¾ navíc nebudu
pracovat s pou¾itým tvarem pøedlo¾ky, ale s jejím lemmatem.

G 85139 - B 40891 - P 67,6

Pøí¹tì je potøeba se nìjak postavit k násilnému øe¹ení vedlej¹ích vìt
zaèínajících zájmenem "který". Je tøeba pokrýt i dal¹í vzta¾ná
zájmena, kterých se to týká. Je tøeba zjistit, jak moc pomáhá povinné
pøipojování takových vìt k nejbli¾¹ímu pøedcházejícímu podstatnému
jménu a kolikrát pøímo toto pøipojení bylo ¹patnì èi správnì. Je tøeba
se zamyslet, zda nebude lep¹í nìjaký volnìj¹í a statistiètìj¹í model,
který napø. bude podmiòovat obyèejnou pravdìpodobnost podmínkami,
které pøi násilném øe¹ení vedou pøímo k pøipojení vedlej¹í vìty. A
celá tato funkce by asi mìla být volitelná v konfiguraci. Pokud se
rozhodnu mít ji pro valenèní pokusy zapnutou, mìla by být souèástí
baseline.



22.2.2002

Pokus s povinným pøipojováním vzta¾ných vedlej¹ích vìt k nejbli¾¹í
jmenné frázi nalevo od èárky. Zatím vrátím to, co u¾ tam jednou bylo,
tedy vìty se zájmenem "který" v rùzných rodech. Udìlám to jako
volitelnou funkci, ale pro nejbli¾¹í pokus bude zapnuta. Zvlá¹» také
zmìøím úspì¹nost tìchto závislostí, proto¾e jedna vìc je, kolikrát
byly úspì¹né ony samy, a jiná, kolik chyb odstranily nebo naopak
zpùsobily jinde ve stromì.

Vzta¾né vìty budeme testovat na malém vzorku 445 vìt (soubory
lu0?.a). Tady je jeho poèáteèní úspì¹nost:

G 5424 - B 2477 - P 68,6

První øádek je v¾dy celková úspì¹nost, druhý jen vzta¾né vìty.

G 5487 - B 2414 - P 69,4
G   30 - B   16 - P 65,2

To je pozoruhodné! Jak je vidìt, samotné zavì¹ení vzta¾ných vìt je
natolik chybné, ¾e celkovou úspì¹nost kazí, av¹ak i tak pomáhá
umravnit jiné závislosti, díky èemu¾ celková úspì¹nost naopak
vzrostla! Mo¾ná ale, ¾e zavì¹ení vzta¾ných vìt bylo chybné i pøedtím,
akorát chyby smìøovaly jinam, tak¾e celkovì i tohle je zlep¹ení (nemám
toti¾ mo¾nost jednodu¹e zmìøit úspì¹nost zavì¹ení vzta¾ných vìt, kdy¾
není pou¾ito zvlá¹tní zacházení). To skoro stojí za zmínku v nìjaké
publikaci. A teï musíme zjistit, kde k chybám dochází a zda se s nimi
dá nìco dìlat.

Chyby lze rozdìlit do následujících skupin:
1) Jmenná fráze nebo sloveso ve vedlej¹í vìtì jsou èleny nìjaké
koordinace nebo apozice. To zatím neumím opravit, proto¾e zatím neumím
zacházet s koordinacemi a apozicemi.
2) Správná jmenná fráze rozvita zprava jinými jmennými frázemi v
genitivu nebo pøedlo¾kovými frázemi. Zatím obecnì neumím opravit a
øe¹ení bude velmi obtí¾né, øízené leckdy sémanticky nebo dokonce ani
èlovìkem nerozhodnutelné. Mo¾ná by nicménì stálo za prùzkum, zda není
naopak èastìj¹í zavì¹ení na nejvy¹¹ího èlena takového øetízku, místo
na nejni¾¹ího, který je souèasnì nejblí¾e k vedlej¹í vìtì.
3) Jako pøedchozí skupina, av¹ak ¹patná jmenná fráze se se vzta¾ným
zájmenem neshoduje v rodì a èísle. To umím opravit.

Zakázáno vì¹ení, kde není shoda (nevì¹ím pak ale nikam, ani na
nejbli¾¹í shodnou jmennou frázi, je to zas necháno na statistice).

G 5477 - B 2424 - P 69,3
G   29 - B    7 - P 80,6

Celkové úspì¹nosti to sice nepomohlo, ale nemù¾u dìlat vìdomì chyby,
abych zabránil jiným, musím radìji hledat jiný zpùsob odstranìní tìch
jiných. Nyní zkusím navíc najít shodnou jmennou frázi, na kterou by
vedlej¹í vìta ¹la zavìsit.

G 5486 - B 2415 - P 69,4
G   33 - B   11 - P 75,0

Místo zájmena "který" nyní vyzkou¹íme zájmeno "jaký".

G 5422 - B 2479 - P 68,6
Vzta¾ná vìta uvedená zájmenem "jaký" se neobjevila ani jednou!

Vracíme zájmeno "který", zájmeno "jaký" vypou¹tíme. Vracíme se k
velkým testovacím datùm.

G 85830 - B 40200 - P 68,1
G   390 - B   128 - P 75,3

Roz¹íøíme pravidlo na výskyty zájmena "který" v pøedlo¾kových frázích
(napø. "Mu¾, na kterého byla podána ¾aloba..."). Budeme také poèítat,
kolikrát se zájmeno "který" vyskytlo v testovacích datech celkem, aby
se poznalo, jak velkou èást problému jsme vùbec schopni uchopit.

G 85844 - B 40186 - P 68,1
G   400 - B   133 - P 75,0
výskyty zájmena "který" = 124064

Tak to je tedy k smíchu, v¾dy» 533 zachycených výskytù "který" tvoøí z
celkového poètu pouhá 4 promile! To se divím, ¾e zásah mìl vùbec
alespoò takový vliv, jaký mìl. Na vinì je samozøejmì pøísný výbìr
okolností, a nìkterým okolnostem by se snad dalo pomoci bez nebezpeèí
ztrát - napøíklad se po¾aduje, abych v daném okam¾iku mìl u¾ zájmeno i
èárku pøipojené. Nemám-li, tøeba to pro¹vihnu. Nebudu ale teï u¾ tento
smìr sledovat dál, proto¾e v nìm stejnì není ¾ádná statistika. Radìji
se vrátím ke sledování valence a sbìru podkladù pro koneènou verzi
èlánku do Taibei.

Vyhodnocení baseline (úplnì nelexikalizovaného parseru) paralelnì pro
v¹echny závislosti a pro valenènì dùle¾ité závislosti.

G 85889 - B 40141 - P 68,1 (v¹e)
G 25459 - B  7936 - P 76,2 (valence)

Lexikalizace s ls=0,734375

G 85844 - B 40186 - P 68,1 (v¹e)
G 25446 - B  7949 - P 76,2 (valence)

Tak teï u¾ tohle ani není optimální ls, proto¾e kdy¾ jsem ho
stanovoval, byl celý model tro¹ièku odli¹ný. Na¹tìstí rozdíly jsou tak
nepatrné, ¾e na desetinách procenta se zhor¹ení neprojeví a bude to
vypadat, ¾e se nic nehnulo ani nahoru, ani dolù.

Úplná obyèejná lexikalizace, tj. ls=1, následuje:

G 54844 - B 71186 - P 43,5 (v¹e)
G 14426 - B 18969 - P 43,2 (valence)

Obyèejná lexikalizace vrácena na 0,734375, pøidána selektivní
lexikalizace (sloveso "být", pøedlo¾ky, podøadící spojky a zvratná
zájmena).

G 87615 - B 38415 - P 69,5 (v¹e)
G 25098 - B  8297 - P 75,2 (valence)

Pøidána "pseudovalence" (závislostem obsahujícím slovesa se sèítá
jejich pravdìpodobnost podle znaèek s pravdìpodobností, kde znaèka
slovesa je lexikalizovaná heslem).

G 87735 - B 38295 - P 69,6 (v¹e)
G 25299 - B  8096 - P 75,8 (valence)

A nakonec pøidána opravdová valence v rozsahu, ke kterému jsem se pøi
pøípravì èlánku zatím dostal (preference valenèních závislostí). V¹e
vý¹e uvedené zùstává také zapnuto.

G 87645 - B 38385 - P 69,5 (v¹e)
G 25259 - B  8136 - P 75,6 (valence)

A teï budeme postupovat zase zpátky, ale v¹echno budeme mìøit pøi
vynechaných vìtách obsahujících ExD, Coord nebo Apos.

G 28592 - B 7522 - P 79,2 (v¹e)
G  9629 - B 2302 - P 80,7 (valence)

Nyní vypnu valenci.

G 28644 - B 7470 - P 79,3 (v¹e)
G  9652 - B 2279 - P 80,9 (valence)

Nyní vypnu i pseudovalenci.

G 28643 - B 7471 - P 79,3 (v¹e)
G  9608 - B 2323 - P 80,5 (valence)

Nyní vypnu i selektivní lexikalizaci.

G 27556 - B 8558 - P 76,3 (v¹e)
G  9544 - B 2387 - P 80,0 (valence)

Nyní zmìním ls na 1 (úplná obyèejná lexikalizace).

G 17557 - B 18557 - P 48,6 (v¹e)
G  4984 - B  6947 - P 41,8 (valence)

Nyní zmìním ls na 0 (¾ádná lexikalizace).

G 27496 - B 8618 - P 76,1 (v¹e)
G  9520 - B 2411 - P 79,8 (valence)

Pokus: do selektivní lexikalizace pøidat pøíslovce neodvozená z
pøídavných jmen (uzavøená skupina, znaèka Db).

G 28554 - B 7560 - P 79,1 (v¹e)
G  9561 - B 2370 - P 80,1 (valence)

Proti dosud nejlep¹ím výsledkùm s valencí je to drobné
zhor¹ení. Pøidáme k nim je¹tì pøíslovce se znaèkou Dg, ale heslem
"hodnì" nebo "málo-3" (jde nám hlavnì o druhé stupnì "více ne¾" a
"ménì ne¾").

G 28558 - B 7556 - P 79,1 (v¹e)
G  9570 - B 2361 - P 80,2 (valence)

Pøíslovce typu Db ru¹ím, pøíslovce "hodnì" a "málo" ponechávám a do
znaèky nedávám jejich heslo, ale slovo.

G 28587 - B 7527 - P 79,2 (v¹e)
G  9632 - B 2299 - P 80,7 (valence)

Ru¹ím i pøíslovce "hodnì" a "málo".

G 28592 - B 7522 - P 79,2 (v¹e)
G  9629 - B 2302 - P 80,7 (valence)



26.2.2002

Zakázáno, aby více ne¾ jedna závislost vedla dovnitø úseku
ohranièeného èárkami.

G 28703 - B 7411 - P 79,5 (v¹e)
G  9930 - B 2001 - P 83,2 (valence)

Opraveno: koncová interpunkce je nyní samostatným úsekem. Toté¾ platí
o koøeni.

G 29149 - B 6965 - P 80,7 (v¹e)
G 10009 - B 1922 - P 83,9 (valence)

To je hezké, teï ale hoøím zvìdavostí, jak to bude vypadat, kdy¾
nebudu vynechávat koordinace a spol.!

G 91142 - B 34888 - P 72,3 (v¹e)
G 27256 - B  6139 - P 81,6 (valence)

Teï se zase jednou podíváme, jak by nám pomohl Melk. Má to ale
háèek. Musíme pou¾ít nezávislé testování a to nám nebude dìlat
transformace koordinací. Jinými slovy, na koordinacích hodnì ztratíme,
proto¾e dokonce ani nebudeme zkou¹et pøeskládat je ve stromì, který
jsme vymysleli. Nezávislý test bez melku tedy dopadá takto:

G 83159 - B 42871 - P 66,0

Pád je mo¾ná je¹tì výraznìj¹í, ne¾ by se èekalo, a to proto, ¾e ve
vìtách s koordinací neplatí pravidlo o uzavøenosti mezièárkových
úsekù! Napø. ve vìtì "Vidìl Martina, Lucku a Janu." se musí nejdøíve
pøes èárku spojit Martin s Luckou a Janou, teprve potom se to celé
spojí s "vidìl" a "vidìl" - opìt pøes èárku, by» pomyslnou a na druhou
stranu - se spojí s koøenem.

Pøi postsubstituci melku (v nìjakém stavu z loòského léta, tj. bez
vylep¹ení, která jsem k nìmu je¹tì vymý¹lel na podzim):

G 83577 - B 42453 - P 66,3

Jasný úkol nejbli¾¹ích dní tedy je: VYØE©IT KOORDINACE A APOZICE!!!
Vìzí v nich pøíli¹ mnoho, urèitì alespoò 10% úspì¹nosti.



27.2.2002

Zahajuji frontální útok na koordinace. Nebudou se konat ¾ádné podvodné
transformace vzorových analýz pøi testování, místo toho se rovnou
vybuduje správná (tj. definicí PDT po¾adovaná) struktura koordinace.

Krok 1: Vypnout pøi tréninku i testu transformace koordinací. Nutnì
musí nastat dal¹í pád úspì¹nosti.

G 86994 - B 39036 - P 69,0

Kupodivu se úspì¹nost naopak trochu vrátila nahoru. Snad tedy pøece
jenom mìl dostateènou sílu fakt, ¾e trénujeme a testujeme stejným
zpùsobem. V kroku 2 ov¹em tento fakt opìt trochu naru¹íme.

Krok 2: Pøi tréninku vynechat závislosti, jejich¾ øídícím nebo
závislým uzlem je koordinaèní spojka. Test zatím ponechat beze zmìny,
adekvátní úprava testu bude provedena v nìkterém z pozdìj¹ích krokù.

G 84078 - B 41952 - P 66,7

Teï se pochopitelnì projevila naprostá neznalost koordinací pøi
testu. Nevadí, ty se toti¾ budeme uèit zvlá¹».

Krok 3: Pøi testu se v ka¾dém kole dívám, zda jsou mezi povolenými
závislostmi obì pùlky dvouèlenné koordinace: závislost èehokoli na
souøadící spojce a závislost druhého èlena stejného druhu (co do
morfologické znaèky) na té samé spojce z druhé strany. Pokud je taková
dvojice závislostí povolená, dostane pøednost. To je sice dost hrubý
zásah do statistického pøediva, ale posléze bude metoda hrubé síly i
zde nahrazena modelem.

G 87276 - B 38754 - P 69,3

Krok 3b: Oprava. Jednou pou¾itá koordinaèní spojka je zablokovaná pro
dal¹í potenciální koordinace. K zablokování se navíc pou¾ije pøepsání
její znaèky znaèkou posledního koordinovaného èlenu, tak¾e se také
usnadní zavì¹ování koordinace nahoru nebo nabalování slov
rozvíjejících celou koordinaci.

G 87928 - B 38102 - P 69,8

Krok 3c: Drobné vylep¹ení. Slovesa mají jen dvì tøídy: Vf (infinitiv) a
V (v¹echno ostatní, tj. urèité tvary slovesa). Pøedpokládám, ¾e
pozdìji bude tento zásah nahrazen jemnìj¹í statistikou o tom, jaké
kategorie se jak èasto spojují do koordinací, ale zatím, v prostøedí
hrubé síly, je lep¹í tohle ne¾ nic.

G 88265 - B 37765 - P 70,0

Krok 4: Roz¹íøit na víceèetné koordinace! Pokud je povolena závislost
èárky na bývalé koordinaèní spojce (bývalé proto, ¾e u¾ byla zapojena
do koordinace a nyní je pøepsána jedním ze èlenù) a pokud nejbli¾¹í
nezavì¹ené slovo nalevo od této èárky je stejného druhu jako èlenové
koordinace, pøipojit èárku pod koordinaèní spojku a naøídit pøipojení
onoho slova tamté¾ v pøí¹tím kole.

G 88561 - B 37469 - P 70,3

Krok 4b: Opravit slovesné tøídy i u víceèetných koordinací.

G 88594 - B 37436 - P 70,3

Krok 5: První pokus o pøidání statistik. Koordinace se souøadícími
spojkami (J^) se dìlají nadále natvrdo, pøibyla v¹ak mo¾nost
dvouèlenných koordinací s jinými spojkami (èárky, jiné slovní
druhy...). Pokud kolem takové spojky existují dva volné uzly,
pravdìpodobností koordinace je relativní èetnost jejich výskytu jako
èlenù v té¾e koordinaci. Tato pravdìpodobnost soutì¾í s
pravdìpodobnostmi obyèejných závislostí. Pokud vyhraje, má druhý èlen
koordinace pøidání do stromu jisté.

G 86448 - B 39582 - P 68,6

Krok 5b: Oprava. Tak jako v 3b i tady zablokováno, aby po pou¾ití
spojky v koordinaci byla ta samá spojka pou¾ita pro jinou koordinaci
vzdálenìj¹ích èlenù. Tentokrát u¾ neblokujeme zmìnou morfologické
znaèky - bylo by to neúèinné, proto¾e spojka se nepoznává podle
znaèky, ale podle hesla. Místo toho vyplníme jednièku do prvku pole
$coord s indexem odpovídajícím indexu spojky ve vìtì.

G 87846 - B 38184 - P 69,7

Krok 5c: Na statistiku nají¾dí i souøadící spojky (J^).

G 83291 - B 42739 - P 66,1

Krok 5d: Oprava. Pole $coord se nyní po analýze ka¾dé vìty vymazává.

G 85295 - B 40735 - P 67,7

Krok 5e: Oprava. Øada koordinací se zablokovala pøedèasnì, jen proto,
¾e u¾ se o nich nìkdy uva¾ovalo.

G 85247 - B 40783 - P 67,6

Krok 5f: Oprava. Není sice vùbec jisté, ¾e relativní èetnosti
koordinaèních ekvivalencí jsou porovnatelné s relativními èetnostmi
závislostí, ale pokud by tomu tak mìlo být, museli bychom relativní
èetnosti koordinací zmen¹it (1-$ls)-krát, proto¾e jsou postaveny na
znaèkách a pravdìpodobnosti závislostí se skládají z modelù znaèek a
slov. Proto nyní násobím koordinaèní relativní èetnosti uvedeným
faktorem.

G 86235 - B 39795 - P 68,4

Krok 5g: Oprava. Tak jako ve 3b, opìt se kopíruje znaèka jednoho ze
èlenù koordinace do znaèky koordinaèní spojky. Tentokrát ov¹em
výsledek mù¾e být hor¹í, proto¾e nìkdy se zkoordinují vìci rozdílných
typù a pak se mù¾e stát, ¾e bude vybrán ten ménì reprezentativní typ.

G 86812 - B 39218 - P 68,9

Krok 5h: Lep¹í pravdìpodobnostní model (pøetrénováno). Nyní u¾ se
nesleduje, jak èasto daná spojka øídila právì koordinaci daného druhu,
proto¾e jsem to stejnì nevyu¾íval. Zato se zji¹»uje, jak èasto dané
heslo bylo koordinaèní spojkou vzhledem ke v¹em svým výskytùm, a tímto
èíslem se násobí celková pravdìpodobnost koordinace. Tak¾e koordinaci
u¾ nemagnetizuje kdejaký hejhula v èele s èárkami - ¹ance vyhrát
reálnì u¾ zùstává opìt pøedev¹ím souøadícím spojkám.

G 87268 - B 38762 - P 69,2



28.2.2002

Krok 5i: Oprava. Pøi trénování nesledovat heslo, ale slovní tvar
spojky. Heslo v tomto pøípadì paradoxnì poskytuje èastìji více
mo¾ností, a to proto, ¾e mnohé spojky patøí k heslùm s rozli¹enými
významy (plus-1, plus-2) a lematizátor je ne v¾dy trefí.

G 87242 - B 38788 - P 69,2

Do¹lo dokonce k nepatrnému zhor¹ení, i kdy¾ procentuální úspì¹nost se
fakticky nezmìnila. Pro pøí¹tì by ale mìlo být bezpeènìj¹í pou¾ití
slov místo hesel, tak¾e to tak nechám.

Krok 6: Teï je potøeba pøidat víceèetné koordinace. Pøi tréninku novì
sledujeme, které spojky jsou schopny øídit i víceèetné koordinace
(nejsou to v¹echny, napøíklad u pomlèky nebo dvojteèky to
neoèekávám).

G 87385 - B 38645 - P 69,3

Krok 6b: Oprava. Do koøene koordinace se nesmí kopírovat typ
koordinace, pokud u¾ tam je (tj. pokud roz¹iøuju existující
koordinaci).

G 87450 - B 38580 - P 69,4

Krok 6c: Oprava. Pøi tréninku rozebrat slo¾ené koordinace, aby se
nestalo, ¾e podstatné jméno bude koordinaènì ekvivalentní se souøadící
spojkou. Ani teï to ale nedìlám poøádnì, proto¾e pouze pøeplácnu
koordinaci, která u¾ byla zpracována, ale nemám jistotu, ¾e je¹tì pøed
jejím zpracováním nenarazím na koordinaci, do které je vlo¾ena, nebo
na závislost, která na ní visí nebo kterou ona sama visí na nìkom.

G 87164 - B 38866 - P 69,2

Krok 7: Je potøeba pøijít na to, kdy se má dávat pøednost koordinacím
a kdy ne. Radikální krok: k nenulovým pravdìpodobnostem koordinací,
pøièíst 1. Tím se zajistí, ¾e pokud by to mohla být koordinace, pak
dostane pøednost.

G 74126 - B 51904 - P 58,8

To ale dostávají pøednost i koordinace se spojkami, které v 99 % svých
výskytù nemají s koordinacemi nic spoleèného, a koordinace èlenù,
které se na jedné koordinaci podílely jen omylem. Mohli bychom tedy
zkusit jiný podvod. Koordinace dostane pøednost, pokud je alespoò 50 %
pravdìpodobnost, ¾e je to opravdu koordinace, neboli ¾e domnìlá spojka
je opravdu koordinaèní spojkou a ¾e domnìlé èleny opravdu mohou být
pohromadì v jedné koordinaci. Pro první pravdìpodobnost u¾ máme
statistiku. Pro druhou bychom poèet výskytù znaèky v koordinaci s
konkrétní jinou znaèkou potøebovali dìlit celkovým poètem výskytù
první znaèky v koordinacích, a ten zatím neznáme. Zatím tedy budeme
po¾adovat, aby obì znaèky byly shodné.
(Krok 7b.)

G 87772 - B 38258 - P 69,6

Krok 7c: Oprava. Pokud dvojice znaèek nebyla pøi tréninku vidìt v
¾ádné koordinaci, ale znaèky jsou toto¾né, pravdìpodobnost jejich
koordinaèní ekvivalence direktivnì nastavit na 1.

G 87844 - B 38186 - P 69,7

Krok 7d: Koordinace s mnoha èárkami a ¾ádnou jasnou spojkou se spojují
hierarchicky, a to proto, ¾e nejdøíve se spojí první dva èleny pod
èárkou mezi nimi a pak u¾ není úniku. Odteï mezi stejnými koordinacemi
preferovat ty, jejich¾ spojka le¾í více vpravo.

G 87847 - B 38183 - P 69,7

©patná zpráva od Petra Pajase: "atd" a podobné zkratky jsou zavì¹ovány
poka¾dé jinak, achich achich! Pokud lze zavìsit na nìco jiného
(napø. èárku), udìlá se to a "atd" je potom (obvykle) jedním ze èlenù
koordinace. Samotné "atd" øídí koordinaci pouze pokud jiný kandidát
není, tedy napø. ve vìtì "Pøi¹el Tonda atd." V manuálu k analytické
rovinì je to napsáno trochu jinak, ale prý ¹patnì. V datech to také
není v¾dy správnì, napø. vìta na zaèátku testovacích dat s obøí
koordinací má v koøeni koordinace atd., pøesto¾e pøed ním jsou spousty
èárek.

Krok 7e: Zru¹eno zkreslování pravdìpodobností koordinací na základì
jejich poøadí ve vìtì - i tak je tam toho zkreslování dost. Je potøeba
odstranit i absolutní preferenci koordinací jako takových, ale kde
najít vhodné vyvá¾ení se závislostmi? Nìkdy je potøeba nejdøíve
pøipojit pøídavné jméno k podstatnému a pak teprve spojit podstatná
jména do koordinace, jindy je nutné nejdøíve spojit koordinaci
pøídavných jmen a pak teprve výsledek pøipojit závislostí k
podstatnému jménu.



1.3.2002

Pokus: pokud lze pøídavné jméno buï zavìsit na podstatné jméno
doprava, nebo koordinovat s jiným pøídavným jménem vlevo, dostane
pøednost koordinace. V ostatních pøípadech rozhoduje statistika. Pokud
pokus vyjde, pokusím se ho také podchytit statisticky.

G 87855 - B 38175 - P 69,7

Krok 8: První pokus s èásteèným podmínìním výbìru zavì¹ení kontextem
ostatních mo¾ností výbìru. Ve stejnou chvíli byla vypnuta valence (ne
pseudovalence ani selex), proto¾e v souèasné podobì spí¹e mírnì
¹kodí. Pøesto úspì¹nost zatím mírnì klesla, ale jsem optimista, a¾ to
dodìlám, bude to snad lep¹í!

G 87454 - B 38576 - P 69,4

Krok 8b: K souboji s konkurenty vlevo pøidán souboj s konkurenty
vpravo. Dal¹í zhor¹ení :-(

G 87172 - B 38858 - P 69,2
Doplòková statistika:
Levý konkurent 946 x pomohl, 985 x ublí¾il, zbytek ¹patný i bez nìj.
Pravý konkurent 1080 x pomohl, 1454 x ublí¾il, zbytek ¹patný i bez nìj.

Krok 8c: Zkusíme zvý¹it pøesnost na úkor úplnosti. Konkurentùm
dovolíme zvítìzit pouze s poètem výskytù 10 nebo vìt¹ím.

G 87864 - B 38166 - P 69,7
lkl 806:761 lkp 784:648

Krok 8d: OK, navíc je¹tì budeme po¾adovat, aby pøevaha konkurenta nad
pùvodním kandidátem byla alespoò dvoutøetinová.

G 88210 - B 37820 - P 70,0
lkl 634:381 lkp 606:479

No sláva, aspoò ¾e tak! Uvidíme se pøí¹tí týden...



4.3.2002

Krok 8e: Soutì¾í o vítìze lokálních konfliktù se zatím vùbec
neúèastnily koordinace (pøesto¾e potøebné statistiky byly pøi tréninku
získány). Nyní tedy pøidávám i koordinace.

8e1: Øe¹ení lokálních konfliktù muselo být kvùli koordinacím
pøebudováno. V zájmu dobrého odladìní tedy nejdøíve zkusíme zopakovat
výsledky, kde se LK øe¹í pouze pro závislosti.

G 87546 - B 38484 - P 69,5
lkl 644:756 lkp 622:503

Zhor¹ení o 664 závislostí. Nìkde je chyba.
8e2: Pokusíme se tedy zopakovat výsledek bez øe¹ení LK.

G 87920 - B 38110 - P 69,8

Výsledek je o 65 závislostí lep¹í ne¾ poslední výsledek pøed krokem 8,
ale to bude tím, ¾e na zaèátku kroku 8 jsme také vypnuli valence, a ty
zùstaly vypnuté i teï.

Rozdíl mezi 8e1 a 8d mù¾e být je¹tì v poøadí testování
závislostí. Jakmile se najde první konkurenèní závislost, která je
"dostateènì lep¹í" ne¾ pùvodní kandidát, pou¾ije se tato závislost a
lep¹í u¾ se nehledá. Poøadí procházení konkurentù tedy hraje
roli. Neumím sice asi dokonale zopakovat poøadí z kroku 8d, ale mù¾u
pøed procházením konkurentù uspoøádat konkurenty podle vzdálenosti od
závislého uzlu.

G 87546 - B 38484 - P 69,5

8e3: Zji¹»uju, ¾e pøece jenom nejsou vypnuty koordinace. Tak teï u¾ je
vypínám doopravdy.

G 88209 - B 37821 - P 70,0

Tak jsme koneènì skoro pøesnì (a¾ na jednu závislost, dùvod neznám)
tam, co v pátek veèer. ©patná zpráva ov¹em je, ¾e pøidáním koordinací
se model zjevnì opìt zhor¹í. (Výsledek viz 8e1.)

8f: Opravena chyba. Za koordinaèní spojku se poèítalo kde co vèetnì
napø. pøedlo¾ky "z". Nyní se síla koordinace jako konkurenta násobí
pravdìpodobností, ¾e pou¾itá koordinaèní spojka je skuteènì
koordinaèní spojka.

G 88000 - B 38030 - P 69,8
lkl 636:519 lkp 609:480

Tak teï u¾ je to snad technicky bez chyb, ale ten model... Nechápu,
jak je napøíklad mo¾né, ¾e "A1 L C N1 P N1" (pøídavné jméno mohlo být
spojeno doleva koordinací s podstatným jménem, nebo rozvíjet jiné
podstatné jméno napravo) vyhrála koordinace 30:0!

Tak je to proto, ¾e tagger oznaèil první pøídavné jméno chybnì jako
podstatné (napø. ve vìtì "Dobré i ¹patné výsledky se vyskytují u v¹ech
pou¾ívaných systémù.") Pokud chceme pøi analýze pou¾ívat výstup
taggeru, tak asi nemù¾eme pøi tréninku jeho názory opravovat. Mìli
bychom je v¹ak pøebít. Nedìje se tak mo¾ná proto, ¾e zatím pøi sbírání
pora¾ených konkurentù bereme v úvahu jen opravdové koordinace, ale pøi
analýze zkoumáme v¹echny potenciálnì mo¾né koordinace. Musíme tedy i
pøi tréninku zkoumat, zda by nìco mohlo být koordinaèní spojkou, a
pokud ano, musíme odhadnout, kteøí z jeho sousedù na druhé stranì by
pøi analýze mohli figurovat jako koordinovaní sourozenci. Tohle je
obtí¾ná èást. Asi by se opìt mìla procházet v¹echna slova za spojkou,
která nejsou svázána s nìjakým slovem na na¹í stranì spojky.



6.3.2002

8g: Opraveno trénování tak, jak je uvedeno vý¹e. Nastalo mírné
zlep¹ení.

G 88243 - B 37787 - P 70,0
lkl 661:409 lkp 608:482

8h: Ze skuteèných koordinací pøi trénování vynechány slo¾ené (abych se
neuèil koordinaci se spojkou), ale podle oèekávání se na výsledku nic
nezmìnilo.

G 88243 - B 37787 - P 70,0
lkl 661:409 lkp 608:482

8i: Pøi souboji s konkurenty nevyhraje první konkurent, který je
lep¹í, ale ten nejlep¹í z lep¹ích konkurentù. Na výsledcích to skoro
nic nemìní (zlep¹ení v¹eho v¹udy o dvì hrany). Pøi bli¾¹ím pohledu na
statistiku lokálních konfliktù je v¹ak vidìt vìt¹í pohyb: pøibylo
¹»astných, ale i ne¹»astných zásahù.

G 88245 - B 37785 - P 70,0
lkl 687:455 lkp 620:505

8j: Souboj s konkurenty nyní probíhá tak, ¾e se projdou v¹echny
dvojice levý kandidát - pravý kandidát, které pro zavì¹ení daného uzlu
pøicházejí v úvahu. Na rozdíl od dosavadních pokusù se tedy mù¾e stát,
¾e konkurs na øídící uzel vyhraje nìkdo na stejné stranì jako pùvodní
kandidát, ale nebude to pùvodní kandidát.

G 76707 - B 49323 - P 60,9
LKG 4164 - LKB 13726

8j1: Vítìz musí mít alespoò 10 hlasù, jinak se pou¾ije kandidát podle
nekontextové pravdìpodobnosti.

G 78190 - B 47840 - P 62,0
LKG 3019 - LKB 11544

8j2: Vítìz musí být alespoò dvakrát lep¹í ne¾ druhý nejlep¹í, jinak se
pou¾ije kandidát podle nekontextové pravdìpodobnosti.

G 87296 - B 38734 - P 69,3
LKG 2185 - LKB 2809

8j3: Vítìz nesmí mít nekontextovou pravdìpodobnost nulovou (co¾ mù¾e
nastat i kvùli kontrole mezièárkových úsekù).

G 87496 - B 38534 - P 69,4
LKG 1867 - LKB 2158

Pozastavuji vývoj tímto smìrem a vracím se k první generaci lokálních
soubojù, kterou se pokusím rozvíjet jinak.

G 88245 - B 37785 - P 70,0
LKG 1307 - LKB 960

Krok 9: Pøipravuji mo¾nost zmìnit poøadí, ve kterém se pøidávají nové
hrany do stromu. Dosud se v¾dy bere hrana s nejvy¹¹í nekontextovou
pravdìpodobností a pouze lokální souboje na tom mù¾ou nìco zmìnit. V
první èásti kroku 9 je¹tì toto pravidlo zachovám, ale pøepí¹u parser
tak, aby nejdøíve hledal závislý uzel a potom vybíral z kandidátù na
jeho øídící uzel. V dal¹ích podkrocích pak bude snadné nahradit
pravidlo pro výbìr závislého uzlu jiným.

9a: Vybírá se závislý uzel z nejlep¹í závislosti, ale ne z nejlep¹í
koordinace.

G 87033 - B 38997 - P 69,1
LKG 1334 - LKB 976

9b: Vybírá se závislý uzel z nejlep¹í závislosti nebo
koordinace. Výsledky by mìly být rovny dosavadnímu maximu (70%).

G 88245 - B 37785 - P 70,0
LKG 1317 - LKB 962 (??? - odkud ten rozdíl?)

9c: Vybírá se závislý uzel, jeho¾ øídící uzel vyhraje s nejvìt¹í
absolutní silou (tj. poèet výher pøi tréninku, nikoli pomìr poètu
výher k poètu proher).

G 75694 - B 50336 - P 60,1

9d: Vybírá se závislý uzel, jeho¾ øídící uzel vyhraje lokální konkurz
s nejvìt¹í relativní silou (tj. pomìr poètu výher a poètu proher).

G 76179 - B 49851 - P 60,4

9e: Vybírá se závislý uzel, který má nejvíce kandidátù na øídícího.

G 47869 - B 78161 - P 38,0

9f: Vybírá se závislý uzel, který má nejménì kandidátù na øídícího.

G 47869 - B 78161 - P 38,0 (??? proè je to stejné jako 9e?)

To je taky pìkná blbost. Na zaèátku se vybere poslední slovo vìty,
proto¾e má jen jednu mo¾nost, to ov¹em vùbec nemusí být ta pravá. A
pak se podobnì vybírá momentálnì poslední volné slovo a¾ kdoví do
kdy.

9g: Je¹tì mám nápad, ¾e by se mohly upøednostòovat závislé uzly, které
jsou obvykle blí¾e k listùm stromu, proto¾e je samozøejmì ¾ádoucí,
abych zavì¹oval uzel a¾ ve chvíli, kdy je jeho podstrom (a také
podstromy jeho sourozencù) kompletnì postavený. Teï u¾ ale nemám chu»
to implementovat, tak¾e pro dne¹ek se vracím k výbìru závislého uzlu
podle toho, zda figuruje v hranì s nejvìt¹í èetností.

G 88242 - B 37788 - P 70,0
LKG 1317 - LKB 963



24.5.2002

Zase na èas opou¹tím koordinace a vracím se k subkategorizaci (kvùli
dokonèení èlánku na Coling 2002 do Taibei). Proto¾e uplynulo 2,5
mìsíce a spoustu jsem toho zapomnìl, pro zaèátek jen nové
pøetrénování, otestování a porovnání s výsledky zaznamenanými
vý¹e. ®ádné vìty nejsou vylouèeny, ale v závorce je uvedena úspì¹nost
pouze na Sb|Obj|AuxT|Pnom|Adv. Skuteèná valence pøi tomto pokusu není
zapnuta (valenèní závislosti nejsou upøednostòovány). Selektivní
lexikalizace zapnuta je.

G 88273 - B 37757 - P 70,0 (78,6)

Podobný pokus, ale trénovací a testovací data se omezují na vìty bez
ExD, Coord a Apos.

G 28869 - B 7245 - P 79,9 (82,7)



15.6.2002

Je¹tì hloubìji do minulosti: je vypnuta i selektivní
lexikalizace. První øádek obsahuje vìty bez ExD, Coord a Apos, druhý
øádek vìty bez ExD, tøetí øádek v¹echny vìty.

G 28230 - B  7884 - P 77,5 (80,1)
G 66862 - B 32230 - P 67,5 (77,7)
G 83782 - B 42248 - P 66,5 (77,1)
--------------------------------- toté¾ pro lambda = 0
G 28145 - B  7969 - P 77,3 (79,9)
G 67800 - B 31292 - P 68,4 (77,7)
G 82382 - B 43648 - P 65,4 (77,0)
--------------------------------- toté¾ pro lambda = 1
G 23170 - B 12944 - P 46,7 (40,7)
G 44815 - B 54277 - P 45,2 (42,5)
G 57086 - B 68944 - P 45,3 (42,4)

Nadále bude napevno lambda = 0,734375. Opìt pro v¹echny tøi mno¾iny
dat, tentokrát zapneme selektivní lexikalizaci.

G 28828 - B  7286 - P 79,8 (82,0) bez ExD, Coord a Apos
G 69394 - B 29698 - P 70,0 (79,2) bez ExD
G 85695 - B 40335 - P 68,0 (78,5) v¹e

Selektivní lexikalizace zùstane zapnuta, navíc zapneme pseudovalenci.

G 28801 - B  7313 - P 79,8 (82,1) bez ExD, Coord a Apos
G 69409 - B 29683 - P 70,0 (79,3) bez ExD
G 85730 - B 40300 - P 68,0 (78,7) v¹e



16.7.2002

Porovnání mého a Charniakova parseru (které chyby, které dìlá on,
nedìlám já a obrácenì). Kvùli tomu je potøeba se vrátit k nastavení,
se kterým mùj parser dosáhl nejvy¹¹í úspì¹nosti (70 %). Zapínám øe¹ení
lokálních konfliktù.

17.7.2002

Porovnání i s Collinsovým parserem. Výsledky jsou následující (èíslo
znamená poèet závislostí, zkratky vedle uvádìjí, které parsery mìly
právì tyto závislosti urèené dobøe):

77995 ec+mc+dz
18508 ec+mc
 3951 ec+dz
 3801 mc+dz
 5765 ec
 3662 mc
 2525 dz
 9821 -



19.7.2002

Zpøísnìná kontrola závislostí vedoucích pøes èárku. Nyní nesmí ¾ádná
závislost pøekroèit èárku nejen kdy¾ úsek, do nìj¾ nále¾í závislý
uzel, není hotový, ale ani kdy¾ kterýkoli jiný mezièárkový úsek je¹tì
není hotový. Jinými slovy: nejdøív pospojovat úseky mezi èárkami,
potom teprve úseky mezi sebou navzájem.

G 86527 - B 39503 - P 68,7 (78,8) v¹e

Do¹lo ke zhor¹ení, proto zase toto opatøení ru¹ím.

Jiný problém: Nìkdy se pøíli¹ brzy zavìsí èlen koordinace na uzel, na
kterém by pozdìji mìla viset koordinace celá (napøíklad "je
absolventem elektrotechnické fakulty èvut a postgraduálního studia" -
pøíli¹ pozdì se spojí "fakulty èvut", tak¾e "fakulty" nevidí svého
koordinovaného sourozence "studia" a spojí se tedy (pøíli¹ brzy)
"absolventem fakulty").

Návrh obecného øe¹ení: Ve chvíli, kdy se pod øídící uzel zavìsí nový
závislý uzel, získává øídící uzel nové sousedy. V tu chvíli musí znova
pøezkoumat své vlastní zavì¹ení, pokud u¾ nìjaké má. I nyní se bude
omezovat na své sousedy, proto nemù¾e zavléct do stromu
neprojektivitu.

25.7.2002

Koneènì mám odladìnou první verzi vý¹e uvedeného, ale výsledek je
zklamáním (dosavadní maximum je zopakováno ve druhém øádku):

G 87142 - B 38888 - P 69,1 (77,8)
G 88273 - B 37757 - P 70,0 (78,6)
ve skuteènosti namìøeno po vypnutí posledního výmyslu
G 88234 - B 37796 - P 70,0 (78,6)
tj. je¹tì o 39 závislostí hùøe, ale to mù¾e být v dùsledku chybky
nejen teï, ale i pøedtím

Opravy ji¾ zavì¹ených uzlù opìt zapnuty, ale povinnì se ihned po
zru¹ení závislosti znova zavì¹uje odpojený uzel. Velmi nepatrné
zlep¹ení.

G 87204 - B 38826 - P 69,2 (77,7)

Z dodateèných oprav jsou vylouèeny uzly zavì¹ené v koordinacích. Zatím
jen velmi nahrubo, pokud je øídícím uzlem "a" a jeho znaèka nezaèíná
na "J".

G 87587 - B 38443 - P 69,5 (77,7)

Poøádná implementace tého¾: s vyu¾itím globálního pole @coord.

G 87768 - B 38262 - P 69,6 (77,4)



26.7.2002

Ale bude to chtít detailní srovnání analýzy s dodateènými opravami a
bez nich a porovnání chyb: které zmizely a které pøibyly. Zatím poèty:

A 15060 ... poèet pøíle¾itostí, kdy to vùbec ¹lo zkusit
B  5205 ... poèet pøíle¾itostí k opravì (do té chvíle to bylo ¹patnì)
            Kdyby se v¹echny tyto pøíle¾itosti vyu¾ily, byl by
        výsledek analýzy G 93439 - B 32591 - P 74,1. Bohu¾el se
        vyu¾il jen zlomek z nich a naopak se v øadì pøípadù
        podaøilo ji¾ dobrou analýzu pokazit.

POZOR! Ne v¹e, èemu vý¹e øíkám "pøíle¾itost k opravì", musela být
opravdu pøíle¾itost. Netestoval jsem, zda správné zavì¹ení u¾ bylo v
tu chvíli k dispozici. Také není správnì odhadnuta úspì¹nost, které by
mohlo být dosa¾eno, proto¾e poèítám pokusy o opravu, ale u nìkterých
uzlù mohlo dojít postupnì k nìkolika pokusùm.

S  4783 ... bylo a zùstalo ¹patnì
L   422 ... podaøilo se opravit
D  8506 ... bylo a zùstalo dobøe
H  1349 ... podaøilo se zkazit

Oprava: dosud pøi opravì ¹patnì fungovalo omezení povolených
závislostí na opravovaný uzel.

G 87783 - B 38247 - P 69,7 (77,4)
D 8789 - S 4823 - L 460 - H 1051

Spoèítány opravdové ¹ance nìco opravit, tj. nejenom ¾e v okam¾iku
pokusu o opravu byl daný uzel ¹patnì zavì¹en, ale ¾e také bylo k
dispozici jeho správné zavì¹ení. Výsledek:

1497 ¹ancí celkem
1434 uzlù, které ¹anci dostali aspoò jednou
=> kdyby se v¹echny ¹ance vyu¾ily a nic nezkazilo, analýza by skonèila
takto:
G 89668 - B 36362 - P 71,1 :-( to je málo...

Závìr: Opravy uzlù tímto zpùsobem mohou analýzu vylep¹it jen o 1,1 %,
co¾ je v této dobì je¹tì dost málo. Ka¾dé procento je sice dobré, ale
my neumíme zajistit, aby se v prùbìhu oprav souèasnì nepokazilo nìco,
co u¾ bylo dobøe. Proto od oprav odstupuji, pøinejmen¹ím prozatím.

G 88235 - B 37795 - P 70,0 (78,6)



Pokus: pravdìpodobnost závislostí (ne koordinací) násobit doplòkem
pravdìpodobnosti, ¾e øídící uzel je koordinaèní spojkou (zamìøeno
hlavnì proti pøehnanému vì¹ení uzlù na spojku "a" je¹tì døíve, ne¾ je
k dispozici druhý koordinaèní èlen). Taky nepomáhá:

G 87884 - B 38146 - P 69,7 (79,3)



29.7.2002

Kontrola úsekù mezi èárkami pøepracována s pomocí pole zakázaných
závislostí. Pravdìpodobnost nekoordinaènosti zùstává
zapnuta. Pochopitelnì to znamená útlum úspì¹nosti. Uvidíme, zda se
pozdìji podaøí s novou implementací èárkových úsekù dostat zpìt na
pùvodní úspì¹nost.

G 86807 - B 39223 - P 68,9 (80,1)

Vypnuta pravdìpodobnost nekoordinaènosti.

G 87078 - B 38952 - P 69,1 (79,7)

Mezièárkové úseky: opìt je pøekroèení èárky povoleno ihned, jakmile se
dokonèí závislý úsek (viz té¾ pokus 19.7.2002). Tentokrát to ov¹em
nepomohlo.

G 86116 - B 39914 - P 68,3 (78,3)

Pøekroèení èárky je povoleno a¾ po sestavení v¹ech úsekù, bohu¾el se
nyní musím spokojit s úspì¹ností 69,1 % :-(

G 87078 - B 38952 - P 69,1 (79,7)



Pokus: nelze pøeskoèit pøedlo¾ku závislostí vedoucí zleva doprava,
dokud tato pøedlo¾ka nemá dítì. Opìt se pou¾ívá èerná listina $zakaz.

31.7.2002

Výsledky pokusu jsou ¹patné. Výpoèet je tøikrát pomalej¹í (trvá nyní
23:50 minut) a úspì¹nost klesla o 1,3 %. (Po návratu k pùvodnímu stavu
program trvá 10:37 minut (døíve to bylo kolem osmi?) a úspì¹nost je
opìt 69,1 %.)

G 85486 - B 40544 - P 67,8 (74,2)

Poznámka: po pøepsání pokusu s pøedlo¾kami program bì¾el skoro stejnì
dlouho (23:47 minut, co¾ mì pøekvapuje, proto¾e nová implementace by
mìla být efektivnìj¹í) a výsledek se nepatrnì li¹í (k lep¹ímu).

G 85504 - B 40526 - P 67,8 (74,3)

Objevena chyba v pøehodnocování zákazù pøeskakování pøedlo¾ek. Po
jejím odstranìní se program zrychlil na 15:47 minut a zvedla se i
úspì¹nost:

G 87512 - B 38518 - P 69,4 (80,5)

Jak analyzovat vliv nového omezení?
1) Spustit parser bez nového omezení a výstup si schovat.
parse.pl
cp analyza.csts vystupy/omezeni-0.csts
2) Spustit parser s novým omezením a výstup si schovat.
parse.pl
cp analyza.csts vystupy/omezeni-1.csts
3) Spustit program pro porovnání výstupù nìkolika rùzných
parserù. Tento program mj. ulo¾í nový soubor, kde jsou slity výsledky
v¹ech analýz.

2.8.2002

Vyèlenìny vìty, ve kterých zákaz pøeskakování pøedlo¾ek zhor¹il
alespoò jednu závislost. Je jich celkem 417. Výsledky, kdy¾ je
pøeskakování pøedlo¾ek zakázáno:

G 6142 - B 3665 - P 62,6 (72,9)

Zazálohoval jsem ladící soubory analyza-debug.csts a analyza.log a
pou¹tím test s vypnutým zákazem pøeskakování pøedlo¾ek.

G 6279 - B 3528 - P 64,0 (74,4)

5.8.2002

Objevena chyba v urèování délky hrany, konkrétnì zda se mezi uzly
nachází èi nenachází èárka. Bez pøetrénování do¹lo ke zhor¹ení
úspì¹nosti (zákaz pøeskakování pøedlo¾ek je zapnut). Snad to bude
lep¹í po pøetrénování.

G 87512 - B 38518 - P 69,4 (80,5) pøed opravou
G 87124 - B 38906 - P 69,1 (80,5) po opravì

Po pøetrénování - sláva! -:

G 89639 - B 36391 - P 71,1 (82,5) po pøetrénování

Teï je¹tì zbývá zjistit, jestli to bez zákazu pøeskakování pøedlo¾ek
není je¹tì lep¹í :-|

6.8.2002

Vypnutím zákazu pøeskakování bezdìtných pøedlo¾ek se nyní úspì¹nost
skuteènì zhor¹í, i kdy¾ pochopitelnì ne na úroveò pøed odstranìním
chyby.

G 89323 - B 36707 - P 70,9 (81,9)



Vzhledem k objevené chybì se je¹tì jednou pokusím vyzkou¹et násobení
pravdìpodobnosti závislosti pravdìpodobností toho, ¾e øídící uzel není
koordinaèní spojkou. Zákaz pøeskakování pøedlo¾ek je aktivní.

G 89453 - B 36577 - P 71,0 (82,9) # prst. nekoordinaènosti aktivní
G 89639 - B 36391 - P 71,1 (82,5) # neaktivní

Kupodivu jsem výsledky neaktivní verze nedokázal zreprodukovat a vy¹ly
o trochu lep¹í!

G 89684 - B 36346 - P 71,2 (82,5)

Analýza:
88395 správnì pøed i po
 1289 správnì pouze pøed
 1058 správnì pouze po
35288 ¹patnì pøed i po
Kdyby se podaøilo získat v¹echna "správnì" najednou, bylo by
P = 72,0 %.
Pøechodem z a0 na a1 se zhor¹ilo 860 vìt. Z toho mj. vyplývá, ¾e
prùmìrná délka zhor¹ené vìty je 26 slov, co¾ je o 10 víc ne¾ prùmìr!
Úspì¹nost tìchto vìt:

G 13934 - B 8179 - P 63,0 (80,4) - a1 (aktivní)
G 14799 - B 7314 - P 66,9 (80,7) - a0 (neaktivní)



8.8.2002

Nový pokus s podmiòováním pravdìpodobnosti závislosti èetností
závislého uzlu. Platí i u koordinací, pøesto¾e koordinace pak má rùzné
pravdìpodobnosti, podle toho, od kterého uzlu se díváme. Nemìlo by to
ale vadit, proto¾e ve stejnou chvíli by mìly být povoleny pohledy od
obou uzlù, tak¾e prostì vyhraje jen jeden z nich.

G 14206 - B 7907 - P 64,2 (80,3) - a1 aktivní

Vzhledem k mírnému zlep¹ení zkusíme toté¾ i pro celá testovací data.

G 89562 - B 36468 - P 71,1 (a1)

Zlep¹ení je opravdu nepatrné. Zkusíme je¹tì pro a0 (neaktivní). A pak
zkusíme souèty v¹ech událostí, které se dané hrany týkají.



27.9.2002

Podmínìné pravdìpodobnosti závislostí, a0 (neaktivní).

G 89103 - B 36927 - P 70,7 (a0)

Opìt zapínám a1, tj. nekoordinaèní závislosti se podmiòují
neschopností øídícího uzlu být koordinaèní spojkou.

G 89562 - B 36468 - P 71,1 (a1, podm. p.)



!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
MOMENTALNE BOHUZEL MUSIM DELAT POKUSY S NECIM JINYM, ABYCH MOHL NAPSAT
CLANEK DO PBML. PAK SE ALE MUSIM K PRACI Z 8.8. VRATIT, PROTOZE NENI
DOKONCENA!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!



27.9.2002

Hlavní my¹lenka èlánku do PBML: chyby v morfologickém znaèkování
zvy¹ují poèet chyb syntaktické analýzy. Zjistit, jak velký tento vliv
je, a navrhnout a odzkou¹et øe¹ení. Mo¾ná øe¹ení: 1) na vstup parsingu
posílat úplnou morfologickou analýzu; 2) opravovat znaèkování bìhem
parsingu (tím, ¾e se rozhodnu pro nìjakou variantu syntaktické stavby,
vyluèuji nìkteré varianty znaèkování); 3) dìlat si celé znaèkování
sám; 4) jako 2 nebo 3, ale vytipovat nejzáva¾nìj¹í chyby (pády
podstatných jmen).

Èlánek by mohl být také o cizích slovech (Bank of America) a o jiných
ru¹ivých vlivech na parsing (zpracování èíslovek, atd. v koordinacích
atd.)



11.10.2002

Nová série pokusù s parsingem na rùzných zdrojích morfologie (úplná
analýza, automatické zjednoznaènìní (HMM, maxent), ruèní
zjednoznaènìní). Pøedcházející taková série probìhla v roce 1998 v
Baltimoru na neredukovaných pozièních znaèkách, PDT 0.5 nehotový,
zhruba 13000 trénovacích a 3500 testovacích vìt. Nyní vezmu analytická
trénovací data z PDT 1.0 (pøes 70000 vìt), z nich oddìlím asi 5000
testovacích vìt (nevezmu je z èásti PDT oznaèené jako testovací,
proto¾e potøebuju mít k dispozici i ruèní morfologické anotace) a
zbytek ponechám pro trénování.

Pùvodní trénovací data obsahují 1583 souborù ze v¹ech 4 zdrojù. Nyní
je právì ka¾dý desátý z tìchto souborù zkopírován do mtest dat (158
souborù), zbytek do mtrain (1425 souborù). Zastoupení zdrojù by tedy
mìlo zùstat zhruba ve stejných proporcích.

Ze v¹eho nejdøív musíme zopakovat dosavadní pokus na znaèkách z
taggeru, proto¾e máme jinou mno¾inu dat, a tedy se asi budou mírnì
li¹it i výsledky.

Nová trénovací data mají 65847 vìt a 1133509 slov. Trénování trvalo
8:38 minut. Nová testovací data mají 7241 vìt a 122081 slov. Testování
trvalo 16:30 minut.

G 85968 - B 36113 - P 70,4 (d-d)

Trénování podle ruèní morfologie trvalo jen 4:38 minut a soubor se
statistikou má 47 MB místo 63 MB!

G 76697 - B 45384 - P 62,8 (h-h blbì)

To je dost podezøelé! Urèitì je tam nìjaká chyba! Ano, u redukovaných
znaèek zmizel druhý znak (pád nebo poddruh). Znova: trénování trvalo
5:37 minut a statistika má 54 MB. Jen¾e je¹tì chybí selektivní
lexikalizace znaèek pro pøedlo¾ky! Napotøetí trvalo trénování 7:26
minut, statistika má 63 MB a na první pohled je v poøádku. Testování
trvalo 15:55 minut. Výsledky:

G 87795 - B 34286 - P 71,9 (h-h)

Nezjednoznaènìná morfologie, varianty znaèek se slepí do jednoho
øetìzce, pøípadné duplikáty se odstraní. Trénování trvalo 12:33 minut,
statistika má skoro 90 MB. Testování trvalo 12:17 minut.

G 82498 - B 39583 - P 67,6 (m-m søetìzenì)



18.10.2002

Trénování s nezjednoznaènìnou morfologií, ale výskyt nejednoznaènì
oznaèkovaného slova se pova¾uje za nìkolik necelých výskytù
jednoznaènì oznaèkovaných slov. Trénování trvalo 19:58 minut a
výsledný soubor má 63 MB. Testování trvalo 37:31 minut.

G 87634 - B 34447 - P 71,8 (m-m rozlo¾enì)

Asi byla chyba ve ètení znaèek, tak¾e to budu muset zopakovat. Teï se
ale zase musím vìnovat nìèemu jinému.



25.10.2002

Návrat k úplným trénovacím a testovacím datùm. Výsledky jsou bohu¾el o
nìco hor¹í, ne¾ byly naposledy s touto konfigurací, a nevím proè :-(
Tenkrát bylo P = 71,1 %.

G 89343 - B 36687 - P 70,9

Potøebuji zjistit, jak je to s úspì¹ností na èíslovkách.
Úspì¹nost zavì¹ování èíslovek, èíslovek s pádem a èíslovek bez pádù:

G 2646 - B 789 - P 77,0
G 1184 - B 220 - P 84,3
G 2030 - B 569 - P 72,0

Úspì¹nost slov, která mìla záviset na èíslovkách, na èíslovkách
s pádem a na èíslovkách bez pádù:

G 1070 - B 542 - P 66,4
G  298 - B 231 - P 56,3
G  771 - B 310 - P 71,3

Nyní pøetrénujeme a pøi ètení pøekroutíme v¹echny èíslovky, aby visely
pod svým podstatným jménem. V dokumentaci musím zdùraznit, ¾e zatím
nijak neøe¹ím to, ¾e se mi teï do koøene negenitivní fráze mù¾e dostat
slovo v genitivu (pozdìji to budu muset øe¹it jako u koordinací
propagací pádu nahoru).

G 89311 - B 36719 - P 70,9

Dokonce mírné zhor¹ení! Budu se muset podívat, jestli není v programu
nìjaká chyba, ale asi to bude tím, ¾e nyní mají negenitivní fráze
genitivní hlavy. Napsat do èlánku, ¾e to vy¾aduje hlub¹í analýzu
rozdílù v chybách s a bez pøekroucení.



1.11.2002

Upravuji parser, aby nebyl tak nároèný na pamì» a mohl bì¾et i
doma. Základní my¹lenka: pøi trénování se statistika rozdìlí na men¹í
kusy, které se natrénují a ulo¾í samostatnì. Analýza pak bude mít dvì
fáze. V té první se postupnì vezmou v¹echny dílèí natrénované
statistiky, projdou se s nimi analyzovaná data a ke ka¾dému slovu se
ulo¾í výpis ze statistiky pro v¹echny jeho potenciální rodièe. Poté se
data projdou je¹tì jednou, pøeètou se ulo¾ené hodnoty u jednotlivých
slov a navrhnou se stromy.



14.11.2002

Dota¾ena do konce první verze rozdìleného parseru. Skript train.pl se
zmìnil jen trochu, zastaví trénink v¾dy po tolika událostech, kolik
udává promìnná $konfig{split}, ulo¾í natrénovaný díl statistiky,
vyprázdní statistiku v pamìti a zaène od dal¹ího trénovacího souboru
nanovo. Skript parse.pl byl v¹ak rozdìlen na markparse.pl, který
projde testovací data postupnì se v¹emi díly statistik a zapí¹e pøímo
do dat statistiky zji¹tìné o dotyèné vìtì, a skript parsemark.pl,
který je¹tì naposledy projde testovací data, pøeète si v ka¾dé vìtì
ulo¾ená èísla a na jejich základì vybuduje nejlep¹í mo¾ný strom.

Kvùli rychlosti testuju zatím dìlený parsing pouze na jednom
testovacím souboru, lu01.a. Z parsemark jsem vyházel ve¹keré nadstavby
typu koordinace èi lokální konflikty, tak¾e úspì¹nost musela
klesnout. Výsledky ukazují v prvním øádku dìlený parsing, ve druhém
pùvodní parse.pl (s vyu¾itím celé statistiky najednou):

G 286 - B 295 - P 49,2
G 618 - B 301 - P 67,2

Zatím je v programu nìjaká chyba, která zpùsobuje, ¾e se ani nepøiøadí
v¹echny závislosti. Budu muset zase rychle zavést ladící záznamy.



15.11.2002

Po opravení chyby u¾ se zpracují v¹echny vìty (a v¹echna slova)
vstupu. Úspì¹nost to nepatrnì zlep¹ilo. Spodní øádek opakuje pro
srovnání úspì¹nost nedìleného parseru na stejných datech.

A 919 - G 466 - B 453 - P 50,7
A 919 - G 618 - B 301 - P 67,2

Pøedìlal jsem markparse tak, aby se ukládaly rùzné události vèetnì
koordinací. Parsemark ale teï na chvíli vyu¾ívá pouze OZZ (bez
lexikalizace) a úspì¹nost kupodivu poskoèila o hodnì.

G 575 - B 344 - P 62,6
G 618 - B 301 - P 67,2

Kombinace OSS a OZZ 1:1.

G 570 - B 349 - P 62,0
G 618 - B 301 - P 67,2

Kombinace OSS a OZZ v pomìru $ls:(1-$ls) (0.734375:0.265625).

G 575 - B 344 - P 62,6
G 618 - B 301 - P 67,2

Jednoduché pøidání koordinací, zatím bez øady akcí dìlaných døíve
(propagace znaèky èlenù do koordinaèní spojky, kontrola povolenosti
partnera, násobení pravdìpodobnosti koordinace pravdìpodobností, ¾e
slovo v koøeni je koordinaèní spojkou...)

G 569 - B 350 - P 61,9
G 618 - B 301 - P 67,2

Pøidán test, ¾e druhá vìtev zva¾ované koordinace je povolena.

G 591 - B 328 - P 64,3
G 618 - B 301 - P 67,2

Pøidáno násobení pravdìpodobnosti koordinace pravdìpodobností
koordinaèní spojky.

G 585 - B 334 - P 63,7
G 618 - B 301 - P 67,2

Opravena chyba: ztrácela se informace o povinném pøipojení druhé pùlky
koordinace v pøí¹tím kole.

G 612 - B 307 - P 66,6
G 618 - B 301 - P 67,2

Pøidáno kopírování znaèky èlena koordinace do znaèky koordinaèní
spojky. S úspì¹ností to nehnulo.

G 612 - B 307 - P 66,6
G 618 - B 301 - P 67,2

Pøidána kontrola, ¾e jedna koordinaèní spojka nemù¾e øídit dvì
koordinace, z nich¾ jedna stojí "obkroèmo" kolem druhé.



21.11.2002

Viz minule, koordinace se hledaly jen pro spojky, které u¾ pro nìjakou
koordinaci nebyly vyu¾ity. První výsledek je s chybou - pou¾ití spojky
se oznaèovalo jako $afun = "Coord", jen¾e $afun se plní u¾ pøi ètení
vzorového souboru a v¹echny správné spojky tak byly pøedem
zablokovány. Druhý výsledek je po úpravì, díky které se pou¾ití spojky
oznaèuje jako $afun = "CoordX". Tøetí výsledek je jako obvykle z
nerozdìleného parseru.

G 581 - B 338 - P 63,2
G 616 - B 303 - P 67,0
G 618 - B 301 - P 67,2



12.12.2002

Sna¾ím se posbírat dochované verze perlového parseru a spojit je pod
CVS (Concurrent Versions System). Motivací je zejména snaha najít
verzi pøed pøestavbou, která umìla 71,7 %, ale sbírám i jiné.

Verze z 1.2.2002, nalezená v zipu v záloze dat doma na
Amazonce. Záznamy z 1.2.2002 potvrzují, ¾e tenkrát bylo 60 % nejlep¹í
dosa¾ený výsledek.
G 75578 - B 50450 - P 60,0

Verze z 11.10.2002 se trénuje jen na 65847 vìtách. Podle záznamù z
11.10.2002 ¹lo o nezjednoznaènìnou morfologii søetìzenou do dlouhých znaèek.
G 82498 - B 39583 - P 67,6
Po pøesmìrování dat se ov¹em výsledky zhor¹í, proto¾e parser.ini z té
doby je¹tì neumo¾òoval pøepínat také zdroj morfologie, tj. ètení MMt v
nìm bylo nastaveno natvrdo v kódu, ale v "hlavních" datech taková
anotace není. Tak¾e se rozhodovalo náhodnì.
G 43983 - B 82047 - P 34,9
Nadìji skýtá fakt, ¾e parse.pl v této verzi je¹tì neobsahuje proceduru
ud(). Zkou¹ím tedy v parslib.pl pøepnout mzdroj z "MM" na "MD", tøeba
se úspì¹nost je¹tì vrátí.

13.12.2002

Verze z 11.10.2002 pøetrénována a pøetestována na znaèkách MDt a.
G 89562 - B 36468 - P 71,1
Podaøilo se mi tedy najít verzi, která je¹tì dosahovala zatím nejvy¹¹í
úspì¹nosti z 27.9.2002 (kdy jsem musel pøeru¹it vývoj a zaèít se
vìnovat èlánku do PBML). Pøedtím se taková úspì¹nost objevila u¾
8.8.2002 pøi posledním pokusu pøed odjezdem na Tchaj-wan. Tenkrát ¹lo
o malé zhor¹ení, co¾ v¹ak zùstalo bez pov¹imnutí, proto¾e jsem
pøecházel od malých dat k velkým. U¾ 6.8. jsem toti¾ dosáhl výsledku G
89684 - B 36346 - P 71,2, co¾ bylo pro zmìnu nevysvìtlené zlep¹ení
oproti výsledku z 5.8. (G 89639 - B 36391 - P 71,1). Ze záznamù
vyplývá, ¾e z 5. na 6. srpna jsem zkou¹el zapnout pøenásobování
pravdìpodobnosti závislosti pravdìpodobností nekoordinaènosti øídícího
èlenu. Tento pokus úspì¹nost zhor¹il, ale po jeho opìtovném vypnutí
vzrostla o nìco vý¹e ne¾ na pùvodní úroveò! Výsledek z 5. srpna - svým
zpùsobem poslední stabilní - byl dosa¾en po zákazu pøeskakování dosud
bezdìtných pøedlo¾ek a po odstranìní nìjaké chyby v urèování
vzdálenosti uzlù (délky závislosti).

Nyní zkusím na objevenou verzi s úspì¹ností G 89562 dát commit a poté
ovìøit, zda s jiným nastavením nezlep¹íme úspì¹nost je¹tì na úroveò
6., nebo aspoò 5. srpna.

Po zapnutí absolutních pravdìpodobností (pabs=1):
G 89397 - B 36633 - P 70,9

Po vypnutí pravdìpodobnosti nekoordinaènosti (nekoord=0, pabs=1):
G 89537 - B 36493 - P 71,0

Po vypnutí obojího (nekoord=0, pabs=0):
G 89106 - B 36924 - P 70,7

Tak¾e návrat k (nekoord=1, pabs=0):
G 89562 - B 36468 - P 71,1



Pro jistotu je¹tì jeden cvs commit, potom se pøesuneme k novìj¹í
verzi. Ta pochází z 25.10.2002 a mìla by být tedy po pøestavbì
umo¾òující pou¾ívat slovníkovou morfologii (a pøepínat zdroj
morfologie v parser.ini místo pøímo ve zdrojáku).

Úspì¹nost verze z 25.10.2002 u¾ je opravdu ni¾¹í, tj. pøestavbou se
nìco ztratilo (mzdroj je MD/a, tak¾e správnì by výsledek mìl být
stejný jako 11.10.2002):
G 89311 - B 36719 - P 70,9

Ztratilo se 251 závislostí. Zkusíme je najít pomocí rozdílù v
analýzách. Nejdøív ale commitnout - zaevidovat verzi z 25.10., by»
znamená zhor¹ení.

Verze k 8.8.2002 (11.10.2002) s MDt a nejlep¹í dochovanou úspì¹ností
(71,1 %) byla v CVS otagována jako "rel-1". A¾ najdu chybu a opravím
ji ve verzi z 25.10.2002, nebo a¾ hledání chyby vzdám, mohly by
souèasné verze souborù z 25.10.2002 dostat tag "rel-2" a revizní èíslo
2.0. Soubory *.stat a *.csts by se mo¾ná mohly vyhodit z repository,
pokud to je¹tì jde.

Zkoumám, kde se ztratilo tìch 251 závislostí. Ukazuje se, ¾e se li¹í
natrénované statistiky v obou verzích, problém je tedy u¾ pøi
tréninku. Diffem na zdrojáky obou verzí zji¹»uju, ¾e pravdìpodobnì jde
o chybu pøi zmìnách v parslib.pl. Jednoduchou výmìnou podezøelého
regulárního výrazu se sice nic nezmìnilo, ale po výmìnì celého
parslib.pl chyba zmizela (statistiky jsou toto¾né a úspì¹nost je také
na pùvodní úrovni, tj. 71,1 %).

Budu postupovat od star¹í verze parslib.pl k novìj¹í a v prùbìhu budu
kontrolovat trénink na jednom trénovacím souboru.



2.1.2003

Nalezena a opravena chyba v parslib.pl z 25.10.2002. Dosa¾ena
úspì¹nost z 8.8.2002-11.10.2002:

G 89562 - B 36468 - P 71,1



3.1.2003

V¹echny verze zachované do 11.12.2002 jsou nyní ji¾ pøevedeny pod
CVS. I verze po 25.10.2002 pou¾ívají opravený parslib.pl. Zkusím nyní,
zda si úplnì poslední verze NEdìleného parseru (která ov¹em u¾
existuje paralelnì s dìleným a sdílí s ním trénovací skript train.pl,
který se o pøípadném dìlení dozví pouze z parser.ini) zachovává
úspì¹nost 71,1 %.

Oprava parslib.pl: v obnovené verzi chybìla funkce cas() pou¾ívaná
v dìleném parseru, doplnìno. Oprava train.pl: èetl z parser.ini
velikost blokù pro dìlení, ale nevìdìl, ¾e velikost 0 znamená zákaz
dìlení. Oprava parse.pl: neumìl èíst statistiku z pracovní slo¾ky;
ztratila se mu procedura vymazat_vetu() (zøejmì byla v chybném
parslib.pl). Také neumìl do této slo¾ky zapisovat své výstupy
(analyza.csts, analyza-debug.csts, analyza.log).

G 89562 - B 36468 - P 71,1

Heuréka! Nedìlený parser tedy pøe¾il ve své nejlep¹í verzi a dìlený je
mo¾né vyvíjet paralelnì, kdy¾ na nìj zrovna bude èas. Potvrzuji stav
CVS.



14.1.2003 Nové Hutì

Doèasnì nemù¾u pou¾ít celá trénovací data, omezuju se na soubory
z Èeskomoravského Profitu (c*). Testovací data jsem zatím pou¾il
celá, i kdy¾ kvùli rychlosti je posléze taky omezím. Testování na
celých datech trvalo nìco málo pøes 1 hodinu.

G 86730 - B 39300 - P 68,8

Men¹í data: pouze soubory lu*, 2294 vìt, 39539 slov. Testování trvá
19:54 minut.

G 27845 - B 11694 - P 70,4



16.1.2003

Test na pouze jednom souboru: lu01.a.

G 632 - B 287 - P 68,8

Kdy¾ se za pravdìpodobnost pova¾uje èetnost (slovní èetnost
kombinovaná se znaèkovou èetností vahami danými konfigurací, ale
nepøevedená na pravdìpodobnost).

G 625 - B 294 - P 68,0

Zhor¹ení by mìlo odpovídat zapnuté absolutní pravdìpodobnosti
(konfig{pabs}), kterou v tomto pøípadì nelze vypnout. Hned to
vyzkou¹íme: vrátíme se k pùvodní proceduøe, ale zapneme pabs.
Jen¾e ve skuteènosti do¹lo ke zlep¹ení. Hm, to nechápu.

G 642 - B 277 - P 69,9

Pouze seèíst slovní a znaèkovou èetnost, ale nevyva¾ovat je. (Odpovídá
vahám 0,5:0,5.)

G 617 - B 302 - P 67,1

Pøidat èetnosti slovo-znaèka a znaèka-slovo.

G 609 - B 310 - P 66,3

Pøidat èetnosti neberoucí v úvahu vzdálenost a smìr.

G 578 - B 341 - P 62,9



30.1.2003 Praha

Návrat k úplným datùm. CVS commit, výsledky stále stejné jako loni v
srpnu, pro osvì¾ení:

G 89562 - B 36468 - P 71,1

Pokus se zásobníkem stavù (zatím se jen buduje, ale nepou¾ívá). Nìkde
bude asi bug, proto¾e nejen ¾e to trvá 1:04 hodiny, ale je¹tì ke v¹emu
to nedává stejné výsledky.

G 89295 - B 36735 - P 70,9

Po vypnutí ukládání stavu se úspì¹nost vrátila a výpoèet trval jen 18
minut.

Kdy¾ jsem nechal ukládání stavu vypnuté, ale zapnul jsem kolem nìj
pokusné pøidání a opìtovné ubrání závislosti ze stromu, úspì¹nost
klesla na 70,9 % - pridat_zavislost() a ubrat_zavislost() tedy
nevracejí parser do pùvodního stavu! Analýza trvala 37 minut.

Naopak kdy¾ jsem toto pøidávání zatrhnul, ale dovolil jsem ukládání
stavù (stále stejných, to není pro hash tak nároèné), analýza trvala
21 minut a úspì¹nost byla 71,1 %. Dalo by se tedy obejít funkce
pridat_zavislost() a ubrat_zavislost() (napø. tak, ¾e bych pro
ukládání pouze pøidal ruènì do ukládaného seznamu jedno èíslo), to asi
nakonec udìlám kvùli efektivitì, nicménì chybu v obou funkcích je
nutné najít a opravit.



31.1.2003

Chyba ve funkcích pridat_zavislost() a zrusit_zavislost() opravena
tak, ¾e byla vytvoøena tøetí funkce zjistit_povol(). Bohu¾el se
ukazuje, ¾e správnì vytvoøený seznam povolených závislostí byl ten,
který vedl na ni¾¹í úspì¹nost. Výsledky je¹tì nejsou definitivní,
proto¾e na novou funkci se je¹tì nepøe¹lo v celém programu. Seznam
povolených se teï nebude prùbì¾nì udr¾ovat, nýbr¾ poèítat a¾ pøed
hledáním nové závislosti. Je to pomalej¹í jen o málo: celá analýza
trvala necelých 20 minut, oproti vèerej¹ím 18 minutám starou metodou.

G 89296 - B 36734 - P 70,9 %

Po úplném odstranìní $povol úspì¹nost je¹tì klesla. Asi jsem dosud
náhodou nepovoloval nìjaké závislosti, které nebyly dobøe. Funkce
zjistit_povol() se teï volá na dvou místech, ale pùjde to sní¾it na
jedno. Analýza trvá 23 minut.

G 89196 - B 36834 - P 70,8 %

Odstranil jsem druhé volání zjistit_povol() ze
zjistit_moznosti_zaveseni(), místo toho se seznam povolených pøedává
shora z generovat_stavy() pøes lokalni_konflikty(). Taky jsem úplnì
odstranil promìnné @rspan, @lspan a $soused, ale ty u¾ se v tu chvíli
nikde nepou¾ívaly. Pøesto se pokazilo 9 závislostí. OPRAVIT!

G 89187 - B 36843 - P 70,8 %



3.2.2003

Opìt pøidáno druhé zjistit_povol(). Chyba zmizela, tak¾e problém nebyl
v @lspan, ale tady!

G 89196 - B 36834 - P 70,8 %

Problém odstranìn, zjistit_povol() se volá jen jednou bìhem pøidávání
jedné závislosti, analýza trvá 22 minut na poèítaèi loki. Úspì¹nost
zùstává 70,8 %.

Pokusil jsem se pøejít na slovníkovou morfologii. Podle pokusù na
náhradních testovacích datech vyèlenìných z trénovacích dat (a ov¹em
nepou¾itých v daném pokusu pro trénink) mìla vyjít dokonce lépe ne¾
ruèní morfologie, a zøetelnì lépe ne¾ morfologie z taggeru. Tady to
v¹ak tak ani trochu nevypadá. Buï jsem udìlal chybu tehdy, nebo teï.

G 82258 - B 43772 - P 65,3



4.2.2003

Vracím se k morfologii z taggeru.
Bìhem dne dìlám rùzné pokusy s vìtami o délce 5, s pøedlo¾kami a s
pøeskakováním sourozencù. Nic z toho zatím není dota¾eno, nicménì mám
výsledky pro tento pokus: N2 nesmí pøeskakovat svého sourozence
vlevo. Pokud by to chtìla udìlat, tj. pokud mezi ní a zamý¹leným
øídícím uzlem le¾í jiný uzel, který pøímo nebo nepøímo nezávisí na ní,
nýbr¾ na øídícím uzlu, dostane taková závislost pravdìpodobnost
0. Výsledek ukazuje, ¾e to mírné zlep¹ení pøiná¹í, a ¾e bych se tedy
pøeskakováním mìl dále zabývat.

G 89448 - B 36582 - P 71,0

Je¹tì drobnost. Do manipulace s morfologickými znaèkami pøidána
transformace øadových èíslovek na pøídavná jména. Zlep¹ení u tøech
slov :-)

G 89451 - B 36579 - P 71,0



5.2.2003

Zji¹»uju plodnost koøene. První pokus: po vybudování stromu se zjistí,
kolik dìtí má koøen. Pokud jich má více ne¾ 2, vybere se koncová
interpunkce a nejpravdìpodobnìj¹í dal¹í dítì, ostatní se odpojí a
pøipojí jinam. Nevýhody: tento pøístup zatím neumo¾òuje nahradit jedno
sloveso koordinací sloves a obecnì nedovoluje ostatním uzlùm na zmìnu
reagovat. Pøesto do¹lo k celkem viditelnému zlep¹ení. Zhor¹ila se
ov¹em èasová nároènost (analýza trvala 32 minut), a to proto, ¾e do
koordinací bylo nutné pøidat kontrolu povolenosti druhé hrany. Mìlo by
to jít alespoò èásteènì opravit, proto¾e seznam povolených závislostí
si lze pamatovat a dodat jako parametr.

G 89765 - B 36265 - P 71,2

Druhý pokus: zakázat zavì¹ení na koøen a na koncovou interpunkci a¾ do
konce. Bohu¾el se zdá, ¾e tento pøístup pøinesl víc ¹kody ne¾ u¾itku.

G 89509 - B 36521 - P 71,0

Prozatím tedy návrat zpìt:

G 89765 - B 36265 - P 71,2

Pøidán ji¾ vèera vyzkou¹ený pokus s vìtami délky 5 (zatím se
rozpoznává pouze vzorec "Praha (p¹t) -").

G 89978 - B 36052 - P 71,4



6.2.2002

Pokusy s èárkami a závislostmi na nich. První pøiblí¾ení: na èárce
nesmí nic viset, proto¾e pak by to musela být koordinace nebo apozice,
a ta se øe¹í jinde.

G 90992 - B 35038 - P 72,2

Jupí!!!



13.2.2003

Po nìjakém vrtání poklesla úspì¹nost. Blbé je, ¾e u¾ si nepamatuju, co
to bylo za pokus. Myslím ale, ¾e ¹lo o vypnutí lokálních konfliktù,
proto¾e jejich statistika je tentokrát prázdná. Vypnuty byly pøi
tréninku, pøi testu ne, ale výsledek je stejný. Byly vypnuty kvùli
nìjaké chybì (cyklilo se to), doufal jsem, ¾e tøeba úspì¹nost spí¹
kazí, jejich statistika tomu napovídala. Ov¹em ony asi vylep¹ují
úspì¹nost ostatních závislostí...

G 90610 - B 35420 - P 71,9

Lokální konflikty znovuzprovoznìny, ale úspì¹nost stále není na
pùvodní úrovni. Budu si muset nechat zjistit rozdíly mezi verzí
parseru ze 6.2. a tou dne¹ní.

G 90833 - B 35197 - P 72,1

Ohledání rozdílù.
parslib.pl ... nìco se dìje s koordinacemi a s apozicemi (dìdìní
znaèek) - s apozicemi se døíve nedìlalo nic. Je ov¹em otázka, odkud se
tahle funkce volá.
train.pl ... li¹í se, ale zatím se zdá, ¾e v nepodstatných vìcech
(pøesunutí mechanické práce kolem otvírání a procházení souborù do
knihovny parslib.pl, pøesunutí mazání vìty po jejím zpracování tamté¾)

Závìr: nena¹el jsem rozdíl, který by mohl zpùsobovat rozdíl v
úspì¹nosti. Zkusím tedy pustit parser ze 6.2., aby se vidìlo, zda
vùbec má úspì¹nost, kvùli které jsem ho zálohoval. A na výsledek se
pøijdu podívat a¾ zítra :-)



14.2.2003

Parser z 6.2.2003 má opravdu úspì¹nost 72,2 % (G 90992 - B
35038). Na¹el jsem chybu, kvùli které pøestaly fungovat tøetí a dal¹í
èleny koordinací (bylo nevhodnì po¾adováno povolení pøidání budoucí
hrany v okam¾iku, kdy pøidání nemohlo být povoleno). Po jejím
odstranìní se obnovila úspì¹nost z 6.2.2003:

G 90992 - B 35038 - P 72,2

Provádím cvs commit a ma¾u vybalenou verzi z 6.2.2003.
Vylep¹ena efektivita zji¹»ování povolených hran v proceduøe
zjistit_pravdepodobnost_koordinace(). Bohu¾el bìhem testování naèas
vypadl jeden z diskù, tak¾e nelze øíct, o kolik se vylep¹í èas na
analýzu. Teï kvùli výpadku trvala 40 minut. Ovìøil jsem v¹ak alespoò,
¾e oprava nezpùsobila nìjaké nové chyby, po kterých by poklesla
úspì¹nost.

G 90992 - B 35038 - P 72,2



17.2.2003

Koneènì dopsán prototyp knihovních funkcí pro dìdìní morfologických
znaèek u koordinací a apozic. Otestováno trénování i analýza, zda
nebyly zavleèeny chyby a zejména zda to nepadá. Zatím se ov¹em znaèky
dìdí, ale ty zdìdìné se k nièemu nepou¾ívají, tak¾e opravdová zkou¹ka
ohnìm teprve bude. Trénování trvalo 9:31 minut, analýza trvala 26:40
minut.

G 90992 - B 35038 - P 72,2

Pokus s pou¾itím dìdìných znaèek pøi tréninku na události OZZ, OSZ,
OZS, ZZZ, ZSZ, ZZS a ZPV (pseudovalence), ne na koordinaci (KZZ,
UZZ). A vùbec ne pøi parsingu. Zatím to pøineslo zhor¹ení, co¾ pøi
omezenosti pou¾ití není a¾ tak divné. Událostí po tréninku je teï
3354115 (víc, døíve pod 3300000), trénování trvá 13:19 minut
(!). Analýza trvá 26 minut.

G 89791 - B 36239 - P 71,2 :-(

Musím zjistit, zda hlavní potí¾ není v tom, ¾e kvùli chybnému
znaèkování koordinace leckdy sdru¾ují èleny s nekompatibilními
znaèkami, a ty pak chybnì ovlivòují znaèku celé koordinace i její
vztahy. Zjistit, zda by pomohlo, kdyby se alespoò v koøeni ponechaly
duplikáty znaèek (tj. nejèastìj¹í znaèka by mìla také nejvìt¹í
váhu). To se toti¾ nyní nedìlá, proto¾e mechanismus pro zpracování
seznamu znaèek poèítá se znaèkami z morfologické analýzy.

Teï se tak dívám... Taky je to mo¾ná tím, ¾e se pøi tréninku
alternativy ve znaèkách vùbec nerozsekaly! Tam se toti¾ testuje,
jestli je zdroj morfologie "MM", a to není!



18.2.2003

Vypínám dìdìné znaèky, vrátím se k nim za pár týdnù. Teï musím nutnì
vytvoøit nìco, o èem pùjde napsat na ACL, a to dìdìné znaèky
nejsou. Mìla by to být subkategorizace - tentokrát pou¾itá jako
výstupní filtr.

Filtr se bude sna¾it zabránit tomu, aby více ne¾ jedno doplnìní
stejného druhu rozvíjelo toté¾ sloveso, pokud toto sloveso nemá rámec,
který opakování pøipou¹tí. Netýká se volných doplnìní (zejména
pøísloveèné urèení èasu a místa "kde"). Naopak se to týká podmìtu
(lépe: podstatného jména v 1. pádì), i kdy¾ podmìty v rámcích
neevidujeme.

Obecnìji: pokud na slovesu visí nìco, co vypadá jako vnitøní doplnìní,
ale sloveso to nemá v rámci, vyvolat poplach. Mo¾ná, ¾e jiné sloveso
si to rádo vezme.

Na druhé stranì: pokud to vypadá, ¾e slovesu nìco chybí, poohlédnout
se, jestli to v okolí nepøebývá (tj. je to tam a nikdo jiný na tom
nesedí ze subkategorizaèních pohnutek). Pokud ano, vyvolat také
poplach. Zjistit, ¾e slovesu nìco chybí, není úplnì triviální. Znamená
to, ¾e musíme projít v¹echny jeho rámce a najít takový, kde toho chybí
nejménì. Z prohledávání jsou více ménì vylouèeny rámce, které zavrhují
nìco, co naopak na slovesu visí (ale ne absolutnì: mù¾e to tam toti¾
viset omylem).

Seznam rámcù by mohl být nový, poøízený novým perlovým kódem, hlavnì
v¹ak z nové verze treebanku, a asi nejen pro slovesa, ale pro v¹echny
slovní druhy, u kterých se nìjaké preference vysledují.



Ov¹em po shlédnutí souboru se statistikou usuzuji, ¾e nejdøív by se
mohla vylep¹it pseudovalence. Ze slovesné znaèky by se k heslu mìlo
pøipojit pouze poèáteèní "V", ale nikoli znak za ním, urèující èas a
zpùsob. A vùbec by se nemìl brát ohled na smìr a délku závislosti.

V trénovacích datech zaznamenáno 3149779 událostí. Trénování trvalo
11:44 minut.

Úprava pseudovalence: Bohu¾el jsou výsledky je¹tì hor¹í :-(

G 88442 - B 37588 - P 70,2

Poddruh ze znaèky asi nebyl nedùle¾itý, proto¾e rozli¹oval èinný rod
od trpného, a ty mají rùzné rámce. Taky infinitiv a rozkazovací zpùsob
jsou dùle¾ité, proto¾e nemají podmìt. Mo¾ná by se nemuselo rozli¹ovat
mezi nimi navzájem, stejnì jako mezi pøítomnì-budoucím a minulým
èasem, ale to u¾ jsou asi jen drobnosti.

Zkusím tedy vrátit znaèku, ale zatím nevrátit smìr a délku
závislosti.

Událostí je teï 3178791. Trénování trvalo 9 minut.

G 90613 - B 35417 - P 71,9

Vracím i smìr a délku. Opìt 3225713 událostí, trénování trvalo 9:40
minut.

G 90992 - B 35038 - P 72,2

Dal¹ím pøedbì¾ným pokusem by mohl být zákaz pøeskakování významového
slovesa kvùli nadøazenému modálnímu slovesu vnitøními doplnìními (tedy
pro tyto úèely dejme tomu èímkoliv s výjimkou R6 a D). Je to obdoba
ji¾ vyzkou¹eného zákazu pøeskakování N2 jiným N2.

G 90774 - B 35256 - P 72,0

Ru¹ím zákaz, ani¾ bych v tuto chvíli podrobnìji zkoumal, proè to
nefunguje.

G 90992 - B 35038 - P 72,2



19.2.2003

Pokus s valencí. Jestli¾e na slovesu u¾ visí N1, zakázat zavì¹ení
druhého N1 na toté¾ sloveso.

G 90437 - B 35593 - P 71,8

Pokraèování pokusu: vý¹e uvedený zákaz se netýká slovesa "být"
(pøísudek jmenný se sponou).



5.3.2003

Deadline ACL Sapporo jsem pro¹vihnul, tak¾e se mù¾u vrátit k výzkumu
:-) Pro zaèátek zkontrolujeme, ¾e máme parser ve zdravém stavu, tj. ¾e
dosahuje dosud nejlep¹í dosa¾ené úspì¹nosti 72,2 %.

G 90992 - B 35038 - P 72,2

Dále se podíváme na stav, v jakém bylo zanecháno zpracování koordinací
a apozic. Opustili jsme ho 18.2., naposledy se s ním nìco dìlo
17.2. Bylo rozchozeno dìdìní morfologických znaèek, ale jeho vyu¾ití
pøi syntaktické analýze je¹tì nebylo bezchybné a také zhor¹ovalo
úspì¹nost analýzy.



13.3.2003

Odstranìny nìjaké chyby v dìdìní znaèek a jeho vyu¾ití pøi
tréninku. Úspì¹nost se ov¹em stále zhor¹uje, ale asi mi nezbyde, ne¾
to pova¾ovat za nezbytnou drobnost na cestì ke koneènému
vítìzství. Je¹tì nemám prozkoumané detaily, ale èíselné výsledky jsou
následující:

G 90465 - B 35565 - P 71,8

Jako obvykle je skuteèný pøíbytek chyb vìt¹í, ne¾ tìch 527 závislostí,
proto¾e na nìkterých místech se analýza na oplátku
zlep¹ila. Konkrétnì:

Poèet rozdílných názorù pøedcházejícího a souèasného parseru: 5814.
Z tohoto poètu mìl starý parser dobøe 1570, nový 1043. Nový parser
tedy pøinesl 1570 zhor¹ení a 1043 zlep¹ení. V názoru na ostatní
závislosti z uvedených 5814 se parsery sice li¹ily, ale oba ho mìly
¹patný.



14.3.2003

Práce na notebooku (Intel Celeron 800 MHz, 250 MB pamìti, z toho,
zdá se, asi 100 MB vyu¾ijí Windows ME). Trénink v plné ¹íøi by se
sem neve¹el, ale analýza ano, pokud ze statistiky odstraníme v¹echny
události, které nebyly vidìny více ne¾ jednou. Velikost souboru se
statistikou klesne ze 67 na 18 MB. Úspì¹nost klesne pouze nepatrnì:

G 90759 - B 35271 - P 72,0

Pøesto asi budu v praxi pro testy pou¾ívat jen malou èást dat,
proto¾e analýza celé mno¾iny trvá dvakrát déle ne¾ na lokim: 1:28 h.
Omezíme se na soubory lu* (48 souborù). Jejich analýza trvá 26 min,
co¾ odpovídá dobì potøebné na lokim k analýze v¹ech dat.

G 29205 - B 10334 - P 73,9

Stejný pokus na stejném poèítaèi, ale pod Linuxem, je jednak del¹í
(43 minut), jednak má ni¾¹í úspì¹nost!!! Jediné vysvìtlení, které mì
napadá, je, ¾e tento Linux ji¾ místo ISO Latin 2 pou¾ívá Unicode
UTF-8, tak¾e nefungovaly lexikalizované statistiky.

G 28184 - B 11355 - P 71,3

Objevil jsem pravdìpodobnou pøíèinu, proè klesla úspì¹nost po
natrénování na zdìdìných znaèkách. Zmìnil se toti¾ poèet závislostí
N1-N1: døíve vítìzil smìr zleva doprava, nyní zprava doleva. To
znamená, ¾e zdìdìná znaèka se dostala do závislosti s tím, kdo ji
zdìdil. Napøíklad by k tomu mohlo dojít u apozic, proto¾e koordinace
jsou v tréninku u¾ z døívìj¹ka podchyceny, ale apozice ne.

Dále: slova a hesla by se mìla dìdit stejnì jako znaèky.

Dále: na rozdíl od døívìj¹ího dìdìní koordinací nyní dìdíme celou
skupinu znaèek (podobnì jako u morfologie ze slovníku). Pøi evidenci
závislostí u¾ se to vyu¾ije, ale mìlo by se to vyu¾ít i pøi evidenci
koordinací a apozic. Nyní by se zaevidovala koordinace v¾dy, kdy¾
øídící uzel má s-znaèku Coord nebo Apos, a to mezi znaèkou závislého
uzlu a v¹emi ostatními znaèkami v seznamu ve zdìdìné znaèce øídícího.



28.3.2003

Návrat na poèítaè loki (Intel Pentium 4, 1.8 GHz, pamì» 1.5 GB).
Kontrola, ¾e parser je ve stavu, v jakém si myslím, ¾e jsem ho
zanechal.

G 90465 - B 35565 - P 71,8

OK, je to stejné jako 13. bøezna pøed odstìhováním na
notebooka. Analýza trvala 30 minut.

Opraveno: pøi dìdìní znaèek se za èlena koordinace neoznaèila
pøedlo¾ka, ale podstatné jméno pod ní. Nyní u¾ se oznaèuje
pøedlo¾ka. Pøetrénování trvalo 15 minut, zaznamenáno 3301150
událostí.

G 90588 - B 35442 - P 71,9

Opraven zpùsob, jakým se pøi trénování oddìlovaly závislosti od
koordinací. Dosud se nìkteré koordinace omylem zapoèítaly i do
závislostí, naopak závislosti celých koordinací na nìèem se
vynechávaly apod. Nyní pøi dìdìní znaèek souèasnì buduju pro ka¾dý
uzel pøíznak, zda je èlenem nìjaké koordinace, tak¾e by to mìlo
fungovat správnì (pøinejmen¹ím tak správnì, jak funguje dìdìní znaèek)
a navíc by to novì mìlo zahrnovat i apozice. Pøetrénování trvalo 18
minut, statistika obsahuje 3222068 událostí (to dává smysl, byl
odstranìn ¹um chybných událostí).

G 90893 - B 35137 - P 72,1

Nyní jediná dal¹í zmìna: v train.pl se za koordinaci pova¾ují nejen
konstrukce øízené uzlem s s-znaèkou Coord, ale také Apos. Trénování
trvalo 13:30 minut, zji¹tìno 3225577 událostí.

G 90634 - B 35396 - P 71,9 :-(



31.3.2003

Sna¾ím se vyu¾ít existenci alternativ u znaèek
v koordinacích. Opravuji chybu - regulární výraz se nedoká¾e smíøit
se znaèkou "Z(". Zji¹tìno 3242983 událostí. Trénování trvalo 11
minut.

G 90465 - B 35565 - P 71,8 ;-((

Je to ale nìjaké divné, proto¾e nejèetnìj¹í koordinace jsou ty, které
neobsahují partnera. Opravena chyba. Zji¹tìno 3009050
událostí. Trénování trvalo necelých 11 minut.

G 90420 - B 35610 - P 71,7



3.4.2003

Zahajuji pøestavbu parse.pl, která mi umo¾ní paralelnì parsovat podle
dvou rùzných modelù a porovnávat jejich úspì¹nost. Souèasnì je to
výteèná pøíle¾itost vyèistit po mìsíce nabalovaný kód. Dnes u¾ to ale
nestihnu. Zatím jen paralelnì bì¾el pokus s nedìdìnými znaèkami. Mìl
by dopadnout stejnì jako 5.3.2003, ale jedna závislost se nìkde
ztratila, èert ji vem.

G 90991 - B 35039 - P 72,2



16.4.2003

Dokonèení pøestavby odlo¾eno na neurèito. Teï udìlám jen jednu vìc,
budu u ka¾dého uzlu vypisovat seznam závislostí, které byly povolené v
okam¾iku, kdy byl uzel zavì¹en. S pomocí takového výpisu bych mìl být
schopen najít chyby zpùsobené poslední zmìnou parseru.

Zatím ale musím opravovat parser, aby byl opìt provozuschopný, ten
pokus o pøestavbu pøed dvìma týdny ho zjevnì dostal do nekorektního
stavu. Test pou¹tím na oøezané statistice (pouze události, které se
staly více ne¾ jednou), tak¾e úspì¹nost nebude standardní.

G 90074 - B 35956 - P 71,5
Pou¹tím tedy je¹tì toté¾ na úplné statistice.
G 90252 - B 35778 - P 71,6



9.5.2003

Potvrzen vý¹e uvedený poslední výsledek, ani¾ bych si ov¹em pamatoval,
jakými zmìnami parametrù k nìmu do¹lo (u¾ toti¾ pamatuju i
lep¹í). Analýza na lokim trvala 32 minut. Zkou¹ím ji je¹tì pustit na
shrekovi s lokální kopií dat, ale zrychlení není na pohled nijak
impozantní, trvá to teï 28 minut.

Zkusím se vrátit k verzi pøed hrátkami s apozicemi. Situaci mi
komplikuje zmizení slo¾ky CVSROOT na ÚFALu, ale na¹tìstí mám nìjakou
zálohu z 13.3.2003 na notebooku, tak uvidíme.

Výsledky na souèasných datech (ov¹em tìch "normálních", nezískaných na
zdìdìných znaèkách), jsou skuteènì ty správné.

G 90992 - B 35038 - P 72,2



12.5.2003

Musíme pøijít na to, kde je v novém parse.pl chyba, ¾e jeho úspì¹nost
je pøi pou¾ití tého¾ modelu hor¹í. Omezíme test na men¹í data.

starý: G 672 - B 247 - P 73,1
nový:  G 665 - B 254 - P 72,4

Rozdíly mezi parse.pl a parse1.pl jsou pøíli¹ rozsáhlé. Zkusíme
nejdøíve zjistit, zda chyba není v parslib.pl. Necháme starý parse.pl,
aby pou¾íval nový parslib1.pl.

G 672 - B 247 - P 73,1

Chyba je tedy pøímo v parse1.pl. Budu se postupnì pøesouvat od
parse.pl k parse1.pl. První krok: pøidám proceduru rozebrat_vetu(),
ani¾ bych ji pou¾il.

G 672 - B 247 - P 73,1



13.5.2003

Star¹í kód nahrazen knihovní (parslib.pl) funkcí
projit_data(). Výsledky zùstávají v poøádku.

G 672 - B 247 - P 73,1



14.5.2003

Zvlá¹tní zpracování vìt o pìti slovech posunuto v kódu vý¹. Úspì¹nost
se sní¾ila. Je to asi tím, ¾e na konci z podmínky vypadly nìjaké vìci,
které se mají dìlat i pro pìtislovní vìty.

G 667 - B 247 - P 73,0

Opraveno.

G 672 - B 247 - P 73,1

Kámen úrazu je spojování koøene s koncovou interpunkcí. Po jeho
pøesunutí do funkce generovat_stavy() se zjevnì parser zaèal chovat
jinak (a hùøe).

G 665 - B 254 - P 72,4

Opraveno.

G 672 - B 247 - P 73,1

Nakonec pøepínám na funkci rozebrat_vetu(). Krátký vzorek zùstává
funkèní. Teï tedy pro jistotu otestujeme celá testovací data. Je to v
poøádku, stejnì jako výsledky z 5. bøezna!

G 90992 - B 35038 - P 72,2

Pøechod ze star¹ího na novìj¹í parse.pl dokonèen. Úspì¹nost zùstává
nesní¾ená.

Teï zpìt k úspì¹nosti koordinací a zdìdìných znaèek. Vezme-li se
statistika natrénovaná na zdìdìných znaèkách, úspì¹nost na lu01
výraznì klesne:

G 660 - B 259 - P 71,8

Teï je je¹tì potøeba dát do poøádku train.pl. V souèasném stavu na
73088 vìtách zjistí 2998340 událostí. Bohu¾el, tohle není to "správné"
trénování z pohledu testu na lu01.

G 662 - B 257 - P 72,0

V train.pl na øádcích 181 a 182 vymìòuji zdìdìné znaèky za
vlastní. Na¹lo se 2979202 událostí. Úspì¹nost na lu01 vzrostla, ale
poøád je¹tì není train.pl v pùvodní kondici.

G 670 - B 249 - P 72,9



15.5.2003

Pokou¹ím se pøepnout do star¹í verze train.pl, ale asi není dost
stará, proto¾e se v ní také pou¾ívají zdìdìné znaèky. Statistika
obsahuje 2351310 událostí. Výsledek je dost dìsivý.

G 506 - B 413 - P 55,1

Ze stejné verze jsem odstranil pou¾ívání zdìdìných znaèek. Statistika
obsahuje 3225713 událostí.

G 672 - B 247 - P 73,1
G 90991 - B 35039 - P 72,2

Ve velkém testu se ztratila jedna závislost. Zkou¹ím train.pl vyta¾ený
z mezitím opraveného CVS. Statistika obsahuje 3225713 událostí a
zøejmì je toto¾ná se statistikou získanou o pokus døíve. Kdy¾ v¹ak
tento train.pl pustím v pùvodním kontextu, tedy zejména s pùvodním
parslib.pl a na pùvodních datech (neobsahují nezjednoznaènìnou
morfologickou analýzu), dostanu sice také 3225713 událostí, ale
velikost souboru se statistikou se asi o 10000 bajtù li¹í.

G 90992 - B 35038 - P 72,2

Pou¹tím tento starý train.pl se starým parslib.pl, ale s morfologicky
analyzovanými daty (nemìlo by to vadit <MMt> se stejnì nepou¾ijí,
pou¾ijí se <MDt>). Výsledná statistika je pravdìpodobnì shodná s
vítìznou (dosahující G 90992).

Pou¹tím tedy toté¾, ale s novým parslib.pl. Statistika obsahuje
3910869 událostí, co¾ je dost divné. Zbytek musím odlo¾it na zítøek.



16.5.2003

V novém parslib.pl se starým parser.ini se nezapnula redukce znaèek.



21.5.2003

Pokraèuju v testování starého train.pl a hledání optimální
konfigurace. V parser.ini, pou¾ívaném starým train.pl, u¾ pøibyl
parametr upravovat_mzn = 1, který si pøeète nový parslib.pl. Pou¹tím
starý train.pl s novým parslib.pl a s parser.ini upraveným vý¹e
uvedeným zpùsobem. Výstupem bude statistika-md.stat s datem 21.5.2003
a èasem nìco po 12:28. Statistika obsahuje 3225713 událostí. Velikost
souboru je 68527045, to je ta ¹patná. Chyba se tedy asi skrývá v
parslib.pl.



22.5.2003

Práce na notebooku. Omezuji trénovací i testovací data na
Èeskomoravský profit (soubory zaèínající na "c"). Nalezeno 252
trénovacích souborù. Zpracováno 11300 vìt. Nejdel¹í vìta obsahuje
132 slov. Trénování bì¾elo 4:56 minut (dal¹í mìøení: 4:20, 4:18,
4:34). Prùmìrná doba 272 vteøin, prùmìrná rychlost 42 vìt / s.
Na Amazonce, ale s daty tahanými po síti z Conga, to trvalo 6:20.
Kdy¾ se netahají data po síti, trvá to 6:19 (musel jsem nicménì
vyu¾ít sí»ové slu¾by a pøipojit si lokální disk jako sí»ový, ale
hlavní zpomalení stejnì nejspí¹ tkví v procesoru a pamìti).
Prùmìrná rychlost ve Windows 2000 na Amazonce èiní 30 vìt / s.
Statistika obsahuje 607328 událostí a má 12849 kB.

S pou¾itím starého parslib.pl trvá trénování 5:12 minut. Statistika
obsahuje 607328 událostí a má 12847 kB.

Upravený starý parslib o rozdíl è. 3 (kontrola úspìchu RE na <g> a
<A>). 6:47 minut, 12847 kB. Tento rozdíl tedy roli nehraje.

Starý parslib upraven o rozdíl è. 2 (volitelnost "upravovat_mzn").
7:23 minut, 12847 kB. Tento rozdíl také nehraje roli.

Starý parslib upraven o rozdíl è. 1 (budování $anot[$ord]{mznlist}).
4:51 minut, 12847 kB. Tento rozdíl také nehraje roli. Rozdíl, který
hledáme, není ve funkci zpracovat_slovo(), proto¾e ta u¾ je teï
v obou verzích stejná.

Vyprázdnìna funkce transformovat_koordinace().
5:46 minut, 12847 kB. Tento rozdíl také nehraje roli.

Zru¹ena funkce transformovat_slozene_predlozky().
5:29 minut, 12847 kB. Tento rozdíl také nehraje roli.

Vymìnìny vnitønosti funkce projit_data().
4:58 minut, 12849 kB. Tady nìkde je ten rozdíl!

Vnitønosti vráceny, pouze pøidána úprava znaèek koncové interpunkce.
4:49 minut, 12849 kB. To je ono!



23.5.2003

Chyba byla v tom, ¾e se koncová interpunkce oznaèovala dvakrát pøes
sebe, jednou v parslib.pl a podruhé v train.pl. Po odstranìní
druhého oznaèování z train.pl a ponechání prvního v parslib.pl má
výsledná statistika opìt jen 12847 kB. Trénování trvalo 4:52 minut.
Po spojení takto opraveného train.pl s novým parslib.pl zùstává
12847 kB.

Nový train.pl obsahuje jednak svùj nový kód, jednak volitelnì
kompletní starý kód. Starý po opravì oznaèování koncové interpunkce
produkuje 12847 kB, nový v¹ak stále nemá ani správný poèet událostí
(561619 místo 607328).

øádek 141: netestovat Apos, ale jenom Coord
øádek 174: pou¾ití $anot[$i]{coordmember}
øádky 183 a 184: pou¾ití zdìdìných znaèek v závislostních událostech
øádky 206 a¾ 257: podivný else-blok, týká se asi koordinací

Do domácích testovacích dat zaøazuji soubory zaèínající na "lu0".
Celkem 9 souborù, 445 vìt, 7901 slov. Testování trvá 6:36 minut.
G 5689 - B 2212 - P 72,0

Pokus s úpravou trénování. Místo na pøímé testování, zda já nebo mùj
rodiè máme funkci Coord, se spoléháme na anotaci coordmember, zji¹-
»ovanou pøi ètení vstupu. Tato anotace ale zahrnuje i apozice a
neptá se na mého rodièe.
Trénování trvalo 5:09 minut, statistika obsahuje 557955 událostí a
má 11885 kB. Výsledky testu:
G 5697 - B 2204 - P 72,1

V train.pl zavedeny dva rozskoky:
$alt[0] = 0 ... coordmember je dítì koøene koordinace, i kdyby nebylo
                jejím èlenem
$alt[0] = 1 ... coordmember je èlen koordinace, i kdyby nebyl dítìtem
                koøene, ale jeho vzdálenìj¹ím potomkem (tøeba pøes
                pøedlo¾ku)
$alt[1] = 0 ... pouze Coord
$alt[1] = 1 ... i Apos se zpracovává jako koordinace

Konfigurace 00 odpovídá starému (a zatím nejúspì¹nìj¹ímu) train.pl:
5:10 minut, 607328 událostí, 12847 kB.
G 5689 - B 2212 - P 72,0

Konfigurace 01 (pøidat Apos, ale nekomplikovat si ¾ivot vnoøeními):
4:50 minut, 597991 událostí, 12672 kB.
G 5680 - B 2221 - P 71,9

Konfigurace 10 (hlídat vnoøené, ale o apozice se nestarat):
4:52 minut, 557955 událostí, 11885 kB.
G 5697 - B 2204 - P 72,1

Konfigurace 11 (hlídat vnoøené vèetnì apozic):
5:06 minut, 555919 událostí, 11845 kB.
G 5700 - B 2201 - P 72,1

$alt[2] = 0 ... vlastní morfologické znaèky
$alt[2] = 1 ... zdìdìné morfologické znaèky

Konfigurace 111 (navíc zdìdìné znaèky; nemìlo by smysl, kdyby vlastnost
è. 0 (první) byla 0, proto¾e pak by se místa, kde jde o dìdìné znaèky,
vynechávala):
5:35 minut, 560668 událostí, 12042 kB.
G 5682 - B 2219 - P 71,9

Konfigurace 1100 (kontrolní; ètvrtá vlastnost pokrývá zatím celý
else blok týkající se koordinací):
5:33 minut, 556348 událostí, 11864 kB.
G 5723 - B 2178 - P 72,4
To je pøekvapivì dobré. Na druhou stranu a¾ teï se dostaly ke slovu
nìkteré èásti, které se mají starat o koordinace, v¹ak jsem se divil,
¾e nejsou v provozu. Èásteènì o koordinace pøece bylo postaráno u¾
dávno. Jen mi nejde do hlavy, ¾e verze 00, která tyto èásti také
vypíná, by podle mých pokusù mìla být ekvivalentní s verzí, která
byla na velkých datech dosud hodnocena jako nejúspì¹nìj¹í!

Intermezzo: Testuji tentý¾ train.pl v té¾e konfiguraci (1100) na
loki s velkými daty. 73088 vìt, 2956228 událostí. Trénování trvalo
16:51 minut. Analýza trvala 31:24 minut. Výsledky:
G 90765 - B 35265 - P 72,0



27.5.2003

Pozor, koordinaèní události se zpracovávají na dvou rùzných místech:
postaru pøed závislostmi, novì po závislostech. Souèasná verze tedy
nìkteré události eviduje dvakrát. Teï jsem celý druhý koordinaèní
blok zakomentoval a pokou¹ím se zopakovat výsledky pro konfiguraci
0000. Povedlo se. 4:59 minut, 607328 událostí, 12847 kB.

Jednoduchý krùèek, koordinaèní blok jsem pøesunul dozadu k tomu
zakomentovanému (je ale o úroveò vý¹ ve vlastní smyèce, to jsem
zachoval). Nemìlo by se nic zmìnit, ale zmìnilo se :-(. 4:20 minut,
547314 událostí, 11684 kB.

Tak jinak. Zpracování koordinací je na pùvodním místì, ale odstranil
jsem z nìj volání funkce transformovat_koordinace(). 4:31 minut,
607328 událostí, 12847 kB. Pøi¹el jsem na to, proè asi hraje roli,
jestli se koordinace zpracovávají pøed závislostmi, nebo po nich. Ve
starém zpracování koordinací se toti¾ mìní morfologická znaèka
v koøeni koordinace.

Koordinace pøesunuty do samostatné procedury. Kontrolní bìh train.pl.
4:43 minut, 606506 událostí (jakto?!), 12836 kB. Opravena chyba
v odkazech. 4:54 minut, 607328 událostí, 12847 kB. Zru¹ena procedura
evidovat_udalosti() (¹lo jen o kopii staré trénovací procedury, u¾
nepou¾ívanou). 4:50 minut, 607328 událostí, 12847 kB. Dokonèeno
napojování koordinací na volitelné rozskoky pro dìdìné znaèky. 5:01
minut, 607328 událostí, 12847 kB.

Dal¹í testování, ¾e se zachovala nejen velikost statistiky, ale i
úspì¹nost analýzy.
Konfigurace 0000, parse.pl pro v¹echny pokusy nezmìnìn.
5:01 minut - 607328 událostí - 12847 kB (neli¹í se)
6:30 minut - G 5689 - B 2212 - P 72,0 (neli¹í se)

Konfigurace 1000 (nový zpùsob rozpoznání èlena koordinace):
5:09 minut - 558561 událostí - 11904 kB (li¹í se od 10 zkou¹. minule)
6:05 minut - G 5695 - B 2206 - P 72,1 (o 2 hor¹í ne¾ 10 minule)

Konfigurace 0100 (apozice, ale rozpoznání èlena postaru):
5:01 minut - 606744 událostí - 12882 kB (li¹í se)
6:25 minut - G 5675 - B 2226 - P 71,8 (hor¹í o 5)

Konfigurace 1100 (nové rozpoznání èlena + apozice):
5:00 minut - 558997 událostí - 11958 kB (li¹í se)
6:15 minut - G 5674 - B 2227 - P 71,8 (hor¹í o 26)

Konfigurace 1001 (nové rozpoznání èlena + zdìdìné znaèky v koord):
4:46 minut - 551019 událostí - 11784 kB
6:13 minut - G 5726 - B 2175 - P 72,5 (zatím nejlep¹í výsledek)

Konfigurace 1010 (nové rozpoznání èlena + zdìdìné znaèky v závisl):
4:55 minut - 563541 událostí - 12115 kB
6:22 minut - G 5683 - B 2218 - P 71,9

Konfigurace 1011 (nové rozpoznání èlena + zdìdìné v¹ude):
5:16 minut - 552908 událostí - 11872 kB
6:27 minut - G 5683 - B 2218 - P 71,9 (zvlá¹tní: shodný výsledek s 1010, i kdy¾ statistika je jiná)

Konfigurace 1101 (nové rozpoznání èlena + apozice + zdìï v koord):
5:16 minut - 551473 událostí - 11851 kB
6:19 minut - G 5717 - B 2184 - P 72,4

Konfigurace 1110 (nové rozpoznání èlena + apozice + zdìï v závis):
4:55 minut - 564657 událostí - 12180 kB
6:14 minut - G 5667 - B 2234 - P 71,7

Konfigurace 1111 (úplný pøechod na apozice a zdìdìné znaèky):
4:56 minut - 552929 událostí - 11910 kB
6:15 minut - G 5673 - B 2228 - P 71,8

Závìr: obecnì se zdá, ¾e zahrnutí apozic nepomáhá. Ani jejich
vypnutí v¹ak samo o sobì nevede k nejvy¹¹í úspì¹nosti, pøesto¾e
konfigurace 1011 by mi pøi¹la z tìch bez apozic je¹tì jako nejèist¹í
øe¹ení.



5.6.2003

Opìt na lokim s velkými daty. I tady vyzkou¹íme nìkolik konfigurací,
ale asi u¾ ne v¹echny. Konfigurace 1111.
13:45 minut - 2927372 událostí - 63160948 B
31:24 minut - G 90811 - B 35219 - P 72,1



11.6.2003

Konfigurace 0000 (podle posledních zku¹eností s velkými daty by to
mìla být ta nejlep¹í).
16:44 minut - 3225713 událostí - 68517516 B
31:46 minut - G 90992 - B 35038 - P 72,2

Konfigurace 1001 (byla nejlep¹í na malých datech).
12:03 minut - 2928036 událostí - 62868492 B
31:16 minut - G 91256 - B 34774 - P 72,4

NOVÝ NEJLEP©Í VÝSLEDEK!
Uklízím rozvrtané verze a potvrdím CVS. Alternativy v train.pl
zùstanou pøepínatelné, ale pøepínání nepùjde ovládat z konfiguraèního
souboru (bude se muset provádìt pøímo ve zdrojáku) a defaultnì zùstane
zapnutá konfigurace 1001, co¾ znamená:
- rozpoznání èlena koordinace novým zpùsobem (poradí si s èlenem,
  který není bezprostøedním dítìtem koordinaèního koøene, nýbr¾ je
  zavì¹en napø. pøes pøedlo¾ku)
- apozice se nepova¾uje za koordinaci a nijak zvlá¹» se nezpracovává
- pøi trénování závislostí se nepou¾ívají zdìdìné znaèky
- pøi trénování koordinací se naopak zdìdìné znaèky pou¾ívají
Poslední dva body znamenají:

Pøi zaznamenávání události KZZ (koordinace dvou znaèek) zji¹»ujeme
seznam znaèek mých partnerù ze seznamu zdìdìných znaèek koøene
koordinace. Na rozdíl od star¹ího pøístupu by tenhle mìl být odolnìj¹í
vùèi vnoøeným koordinacím a pøedlo¾kám. Døíve se procházely v¹echny
uzly ve vìtì, o ka¾dém se zjistilo, zda je to èlen koordinace, a pokud
byl, jeho znaèka (ze @znacky) se pøidala do @koortypy; zároveò se
pøidala KZZ pro nìj a v¹echny ji¾ døíve nalezené @koortypy.

Pozoruhodné je, ¾e zøejmì navlas stejné zaznamenávání události KZZ se
dìje v bloku zpracovat_vetu() i ve z nìj volaném bloku
projit_koordinace(). Musím zjistit, zda je to potøeba kvùli jiným
alternativám, nebo zda se do jedné z kopií bìh nikdy nedostane, nebo
zda se dokonce provádìjí obì kopie a ka¾dá koordinace se zaeviduje
dvakrát!

Skuteènì se volají ud(KZZ) na obou místech. Problém ale bude
komplikovanìj¹í, proto¾e poka¾dé jsou parametry KZZ jiné znaèky.



12.6.2003

Opraveno ukládání koordinací se ¹patnými znaèkami. Zatím neopraveno
dvojí ukládání koordinací. Konfigurace 1001.
13:46 minut - 2927251 událostí - 62851146 B
31:37 minut - G 91320 - B 34710 - P 72,5

Vypnuto druhé ukládání koordinací, první ponecháno.
13:40 minut - 2927054 událostí - 62848982 B
30:59 minut - G 91155 - B 34875 - P 72,3

Nový pokus o popis vítìzné konfigurace 1001:
1) Èlen koordinace se poznává novým algoritmem, zvládajícím vnoøené
koordinace a pøedlo¾ky v koordinacích.
2) Apozice se nepova¾ují za koordinace a zachází se s nimi jako s páry
obyèejných závislostí.
3) Závislostní události se sestavují z vlastních znaèek øídícího a
závislého uzlu, nikoli z tìch zdìdìných. Dokonce se zøejmì nedìlá ani
to, co se dìlalo kdysi, toti¾ ¾e koøen koordinace bude v závislostech
nìèeho na koordinaci èi koordinace na nìèem zastoupen znaèkou prvního
nebo posledního èlena koordinace. To by byla chyba! Koordinace by v
závislostech mìla být reprezentována nìèím lep¹ím ne¾ znaèkou spojky.
4) Koordinaèní události se sestavují novým algoritmem, který vychází
ze zdìdìných znaèek koøene. Mj. se tím zajistí správné zapoèítání
vnoøených koordinací. (Starý algoritmus procházel v¹echny uzly vìty,
pokud na¹el èlena dané koordinace, spároval ho obousmìrnì se v¹emi
døíve nalezenými èleny této koordinace. Nový algoritmus páruje jen
jednosmìrnì, ale zato se v¹emi èleny, tedy i s tìmi, kteøí ve vìtì
následují a¾ za právì nalezeným èlenem.)

Opravena chyba: znaèka prvního èlena koordinace se nekopírovala do
koøene koordinace za úèelem sestavování závislostních událostí, kde
nìco závisí na koordinaci nebo koordinace závisí na
nìèem. (Techniètìji: $alt[2] se nepøedávalo do a nepou¾ívalo v
proceduøe projit_koordinace().)

14:00 minut - 2964897 událostí - 63267805 B
32:29 minut - G 89598 - B 36432 - P 71,1

Ach jo. Zas jedna oprava chyby, která totálnì zkazí úspì¹nost. Zkusíme
tedy je¹tì jednou zapnout zdìdìné znaèky pro koordinace vstupující do
závislostí. Konfigurace 1011.

12:22 minut - 2932518 událostí - 63163328 B
31:01 minut - G 90852 - B 35178 - P 72,1



17.6.2003

Vzhledem k opravám minulý ètvrtek je bohu¾el na místì opìt
zkontrolovat, zda konfigurace 0000 je¹tì stále dosahuje stejné
úspì¹nosti jako kdysi (i kdy¾ tato úspì¹nost u¾ není nejlep¹í v
historii, lep¹í úspì¹nosti zatím byly dosa¾eny jen s pomocí chyby, a
tedy omylem a neodùvodnìnì).

Poznámka 19.6.2003: pøibývají dal¹í konfigurace, øadím je sestupnì
podle úspì¹nosti.

Konfigurace 0010.

13:15 minut - 2942371 událostí
29:44 minut - G 91258 - B 34772 - P 72,4

Konfigurace 0011.

13:11 minut - 2943053 událostí
30:47 minut - G 91103 - B 34927 - P 72,3

Konfigurace 0110.

13:01 minut - 2892516 událostí.
30:42 minut - G 91027 - B 35003 - P 72,2

Konfigurace 0000.

15:50 minut - 3225713 událostí
30:20 minut - G 90992 - B 35038 - P 72,2

Konfigurace 1010.

11:34 minut - 2932361 událostí
30:26 minut - G 90966 - B 35064 - P 72,2

Konfigurace 1000.

13:25 minut - 2969063 událostí
31:14 minut - G 90881 - B 35149 - P 72,1

Konfigurace 0100.

12:42 minut - 3216376 událostí
31:43 minut - G 90733 - B 35297 - P 72,0

Konfigurace 1111.

13:12 minut - 2926483 událostí
31:01 minut - G 90713 - B 35317 - P 72,0

Konfigurace 0001.

12:39 minut - 3209963 událostí
30:15 minut - G 89827 - B 36203 - P 71,3

Konfigurace 1001.

13:15 minut - 2964897 událostí
31:58 minut - G 89598 - B 36432 - P 71,1



20.6.2003

Dal¹í konfigurace (zbývá jich 6) u¾ nebudu testovat. Nová nejlep¹í
konfigurace je tedy 0010 s úspì¹ností 72,4 (91258). Tato konfigurace
znamená, ¾e:
- èlenství v koordinaci se zji¹»uje postaru (tj. chybnì!)
- apozice se nepova¾ují za koordinace
- koøen koordinace jako ø. i z. èlen závislostí pou¾ívá zdìdìné znaèky
- v koordinaèních událostech se zdìdìné znaèky nepou¾ívají
Nastavím tuto konfiguraci v train.pl a provedu cvs commit, pak ale
znova zapnu i nové zji¹»ování èlenství v koordinaci a obìtuju dvì
desetiny procenta úspì¹nosti ve prospìch správného postupu. Dále se
tedy bude pokraèovat s konfigurací 1010, která má úspì¹nost 72,2
(90966, co¾ je nepatrnì ménì, ne¾ mìla dosavadní 0000).



Zkusíme ka¾dou koordinaci (událost KZZ) zapoèítat s dvojnásobkem
skuteèné èetnosti. Kdy¾ jsme nìco podobného udìlali omylem, úspì¹nost
se zvý¹ila; není akorát jisté, ¾e to bylo tímhle a ne je¹tì nìjakou
jinou chybou.

13:25 minut - 2942371 událostí
29:10 minut - G 91763 - B 34267 - P 72,8

To jsou vìci... Zkusím tedy, co se stane, kdy¾ se ka¾dá koordinace
zapoèítá tøikrát.

13:18 minut - 2942371 událostí
30:14 minut - G 91971 - B 34059 - P 73,0



26.6.2003

Trénuju konfiguraci 1010 (v pátek jsem a¾ do veèera mìl zapnuto 0010),
nechávám v¹ak zapnuto trojnásobné zvýhodnìní koordinací proti
závislostem.

12:46 minut - 2932361 událostí
29:45 minut - G 91209 - B 34821 - P 72,4

Pokus: násilná úprava funkce projit_koordinace(). Jestli¾e má
koordinace jen jednoho èlena, vyma¾e se ji¾ zaznamenaná událost KJJ,
nezaznamená se událost KZZ a místo toho se zaznamená závislostní
událost OZZ (jako zástupce; ostatní ménì dùle¾ité závislostní události
se zatím nezaznamenávají).

11:17 minut - 2861004 událostí
29:43 minut - G 90400 - B 35630 - P 71,7

Nijak slibnì to tedy nevypadá. Pokus ru¹ím a jednoèetnými koordinacemi
se v této chvíli nebudu dále zabývat.



27.6.2003

POZOR! Nový zpùsob zji¹»ování èlenství v koordinaci je sice v nìèem
správnìj¹í, ale zase ka¹le na to, zda mám nebo nemám vypnuté apozice!
Zkou¹ím je zatím natvrdo vypnout v parslib.pl.

13:38 minut - 2963729 událostí.
29:53 minut - G 91235 - B 34795 - P 72,4

Abych mohl vùbec je¹tì nìkdy nìco upravovat v train.pl, budu muset
alternativy, které jsem v posledních týdnech vytvoøil, zase nìjak
zkompaktnit a vùbec to celé formálnì upravit. Bylo by dobré, kdyby i
tak zùstala mo¾nost alternativy pøepínat, ale hlavnì je nutné, abych
si nezkazil souèasnou nejlep¹í úspì¹nost.

Kontrola úspì¹nosti:
11:51 minut - 2963729 událostí.
30:07 minut - G 91235 - B 34795 - P 72,4



30.6.2003

Nový druh události KMM udává, ¾e uzel s jistou morfologickou znaèkou
byl èlenem koordinace. Po vydìlení pøíslu¹ným poètem událostí UZZ by
mìla vzniknout pravdìpodobnost zapojení uzlu do koordinace.

Podle oèekávání z toho ¾ádný zázrak nevypadl.

G 89526 - B 36504 - P 71,0



1.7.2003

Valence. Návrat k tomu, o èem jsem psal do Taibei. Naposled jsem se
tím zabýval zhruba pøed rokem, kdy¾ jsem odevzdával koneènou verzi
èlánku. Proto¾e tehdy nebylo jisté, zda seznam slovesných valencí z
Philadelphie byl ten nejlep¹í, ke kterému jsem se v roce 1999 dostal,
pokusím se ho získat znova. Tentokrát pøímo perlovým trénovaèem,
prostøednictvím událostí nad zdìdìnými znaèkami, z celého PDT 1 a pro
v¹echna slova (nejen slovesa). Budou to události, kde na jedné stranì
bude stát heslo øídícího uzlu, na druhé stranì abecednì seøazené
zdìdìné morfologické znaèky závislých uzlù. Ze závislých uzlù se
tentokrát nebudou umìle vyhazovat podmìty (podstatná jména v prvním
pádì). U øídících sloves se za samostatné heslo budou pova¾ovat tvary
trpného pøíèestí, jinak se heslo v¾dy vezme z morfologické roviny.

18:29 minut - 3231635 událostí, z toho 267906 RAM.

Odboèka, postøeh: pøivlastòovací a ukazovací zájmena se odteï budou
pøi tréninku i pøi analýze pova¾ovat za pøídavná jména.

17:20 minut - 3224091 událostí.
30:03 minut - G 91035 - B 34995 - P 72,2

Zhor¹ení, vracím do pùvodního stavu.

18:43 minut - 3231635 událostí.
30:00 minut - G 91235 - B 34795 - P 72,4

Úspì¹nost se vrátila na dosavadní maximum.



2.7.2003

Pokus s krátkými vìtami. V¹echny vìty délky 5 slov a ménì se pøi
tréninku zaznamenají jako událost VET <vzor> <strom>, kde vzor bude
posloupnost morfologických znaèek, zaznamenaná podobnì jako rámec
(znaèky jsou oddìleny vlnovkou) a strom bude posloupnost èísel, která
pro ka¾dé slovo urèí odkazem jeho rodièe. Napø.:
VET Rk~A3~N3 0,3,1

13:22 minut - 3235652 událostí, z toho 4018 VET.
29:46 minut - G 91388 - B 34642 - P 72,5

Zkusíme roz¹íøení na vìty o ¹esti slovech.

16:54 minut - 3237584 událostí, z toho 5950 VET.
30:51 minut - G 91391 - B 34639 - P 72,5

Zlep¹ení u¾ bylo dost nepatrné a mo¾ná by se s ohledem na napáchané
¹kody mìlo radìji zùstat u vìt do délky 5, ale pøesto se zkusíme je¹tì
podívat na vìty o sedmi slovech. Tam u¾ pravdìpodobnì dojde ke
zhor¹ení, ale kdo ví...

13:54 minut - 3239777 událostí, z toho 8143 VET.
29:49 minut - G 91491 - B 34539 - P 72,6

Dobrá, zkusíme je¹tì vìty o osmi slovech.

13:42 minut - 3242203 událostí, z toho 10569 VET.
36:16 minut - G 91511 - B 34519 - P 72,6



3.7.2003

Pou¹tím se do disertace, pøípadné výstupy následujících týdnù se
mo¾ná objeví pøímo v ní.



8.8.2003

Mìl jsem povypínané zpracování koordinací, radìji zkontroluju, ¾e
poøád je¹tì umím dosáhnout té nejvy¹¹í úspì¹nosti.

17:21 minut - 3242203 událostí
31:28 minut - G 91539 - B 34491 - P 72.6



2.9.2003

Selektivnì lexikalizuji vzta¾ná zájmena (kdo, co, který, jaký, èí,
jen¾) heslem. Úspì¹nost se zvý¹ila, ale jen nepatrnì.

18:16 minut - 3262065 událostí (011)
33:12 minut - G 91550 - B 34480 - P 72,6

Podobný pokus, ale místo hesla pøidávám jen "W" (za "wh").

17:38 minut - 3252683 událostí (013)
34:45 minut - G 91531 - B 34499 - P 72,6

Vracím zpìt lexikalizaci heslem. Pokus o roz¹íøení: lexikalizuji
v¹echna zájmena, nejen vzta¾ná.

14:29 minut - 3301172 událostí (015)
33:50 minut - G 91555 - B 34475 - P 72,6

Mírnìj¹í pokus: lexikalizuji osobní, pøivlastòovací, ukazovací a
vzta¾ná (tj. nejbì¾nìj¹í uzavøené tøídy). Jde o zájmena zaèínající na
já, ty, on, my, vy, mùj, tvùj, jeho, její, ná¹, vá¹, jejich, svùj,
ten, tento, tenhle, onen, takový, tý¾, tentý¾, sám, kdo, co, kter,
jak, èí, jen¾. Nastalo sice dal¹í mírné zlep¹ení, ale v cílové verzi
parseru tuto úpravu nenechám, proto¾e je jazykovì závislá.

18:22 minut - 3293735 událostí (018)
36:23 minut - G 91561 - B 34469 - P 72,7

Vrácena selektivní lexikalizace v¹ech zájmen. Pøidána selektivní
lexikalizace podøadících spojek (dosud se lexikalizovaly pouze spojky
zaèínající na "¾e", "aby" a "zda").

21:26 minut - 3316716 událostí (020)
30:09 minut - G 91344 - B 34686 - P 72,5

Selektivní lexikalizace podøadících spojek vrácena do pùvodního stavu.
Pøidána selektivní lexikalizace vybraných pøíslovcí. Jsou vymezena výètem
pøímo ve zdrojáku, ale pøi tro¹e práce je lze vymezit jazykovì nezávisle
pro trénink i test jako taková pøíslovce (tvary, ne hesla), která se
v trénovacích datech vyskytla alespoò stokrát. Bohu¾el nejde pou¾ít
rozli¹ení znaèek Db a Dg, i kdy¾ vìt¹ina nejèastìj¹ích pøíslovcí má Db.
Napøíklad desáté nejèastìj¹í pøíslovce "více" se úèastní konstrukcí, kvùli
kterým stojí za to zkusit lexikalizaci, ale toto pøíslovce má znaèku Dg
(proto¾e je to druhý stupeò pøíslovce "hodnì").

9 nejèastìj¹ích pøíslovcí:
1. tak (2101) 2. jak (1638) 3. u¾ (1611) 4. také (1566) 5. ji¾ (1344)
6. je¹tì (1314) 7. vèera (1293) 8. tedy (990) 9. pak (952)
5 nejèastìj¹ích pøíslovcí se znaèkou Dg:
10. více (946) 26. stejnì (448) 36. zøejmì (377) 41. èasto (357)
46. ménì (335)

20:37 minut - 3439991 událostí (022)
30:18 minut - G 91944 - B 34086 - P 73,0 (!!!)



3.9.2003

Nový pokus rozchodit subkategorizaci. Pro zaèátek (èíslo pokusu 24) jsem
v parser.ini zapnul valence=1. Naèítá se starý philadelphský seznam rámcù
z /home/zeman/programy/valence/seznam_ramcu.txt.

G 91837 - B 34193 - P 72,9

Úspì¹nost se sní¾ila. Nechce se mi hned teï zkoumat, kde je problém.
Soubor 0 = /home/zeman/data/test.amm, znaèka = <g>
Soubor 1 = 023.csts, znaèka = <MDg.*?src="dz".*?>
Soubor 2 = 024.csts, znaèka = <MDg.*?src="dz".*?>
 91639   0+1+2     (oba dobøe)
 33690   0,1+2     (oba stejnì ¹patnì)
   198   0,1,2     (oba ¹patnì, ka¾dý jinak)
   305   0+1,2     (zhor¹ení)
   198   0+2,1     (zlep¹ení)



5.9.2003

Parser vrácen do stavu z 2.9.2003, pou¾it model 033.stat.

G 91944 - B 34086 - P 73,0



8.9.2003

Pøestavba. Potøebuju zachovat neredukované znaèky pro výstup, ale
souèasný parser si je nepamatuje. Po pøestavbì budou v¹echny anotace
kromì vlastního slovního tvaru ulo¾ené v poli hashù @anot. Pak se
budou nové druhy anotací pøidávat snadnìji. V prùbìhu pøestavby se
budou muset provádìt èasté kontroly alespoò na prvních 200 vìtách,
¾e to je¹tì funguje. Vzorová analýza (lu0*.csts) má následující
výsledky:

G 5889 - B 2012 - P 74,5

První etapa: $hesla[$i] nahrazena $anot[$i]{heslo}.
parse.pl OK (G 5889)
Druhá etapa: $znacky[$i] nahrazeny $anot[$i]{uznacka},
$mznacky[$i] nahrazeny $anot[$i]{znacka}. To byl trochu vìt¹í boj,
snad poslední problém je s krátkými vìtami, zøejmì se teï ve vzorci
objevuje znaèka koncové interpunkce s K (tøeba Z.K) a v natrénované
statistice to tak není. Zazáplatoval jsem to v parse.pl, ale mo¾ná
to zas nebude chodit po novém pøetrénování, to se ka¾dopádnì musí
ovìøit! Tak¾e zatím mám ovìøeno parse.pl na malých datech
(lu0*.csts). Teï pøed odchodem pou¹tím toté¾ na velkých datech a pak
také train.pl a je¹tì jednou parse.pl, aby se ovìøilo, ¾e se
nepokazil ani trénink.



9.9.2003

Vèera podle oèekávání zafungovalo upravené parse.pl nad starou statistikou,
ale nezafungovalo po pøetrénování. Dnes jsem opìt zru¹il úpravu a vzorce
krátkých vìt tedy v¾dy mají znaèku koncové interpunkce roz¹íøenou o "K".
Bohu¾el se nìkam ztratily 3 závislosti.

G 91941 (místo 91944) - B 34089 - P 73,0

Porovnávám statistiky 033 a 055 a logy 042 a 057. Ve statistikách se li¹í
pouze novìj¹í události ARG, ADJ, RAM a VET - nìkteré z nich døíve nemìly ve
znaèce koncové interpunkce na konci "K", a øada z nich døíve nemìla v hesle
koøene dvojkøí¾. Bohu¾el se tím asi nevysvìtluje pokles úspì¹nosti. Ze srovnání
logù je vidìt, ¾e události KZZ mají poka¾dé trochu jiné èetnosti. Jak k tomu
ale mohlo dojít, kdy¾ statistiky se v øádcích KZZ neli¹í?



15.9.2003

Problém byl zpùsoben tím, ¾e nìkteré pravdìpodobnosti byly závislé na promìnné
$scelkem, co¾ byl buï souèet èetností v¹ech evidovaných událostí, nebo poèet
rùzných událostí. Kdy¾ jsme pøidali do statistiky události, zmìnily se nìkteré
pravdìpodobnosti a obèas to vedlo k výbìru jiné závislosti. A to pøesto, ¾e
pøidané události nemìly s jevy, jejich¾ pravdìpodobnost se zmìnila, vùbec nic
spoleèného!

Øe¹ení: ru¹ím "absolutní pravdìpodobnosti" ($konfig{pabs} je v souèasné
konfiguraci stejnì nastaveno na 0), kvùli kterým se $scelkem hlavnì pou¾ívalo.
Tam, kde se $scelkem pou¾ívalo i pøi $konfig{pabs}==0, ¹lo o chybu. A i kdybych
se v budoucnosti chtìl ke $konfig{pabs} vrátit, muselo by se ve jmenovateli
pou¾ívat nìjaké jiné èíslo, které se nezmìní, pokud se nezmìní statistiky,
které se objevují v èitateli.

Upozornìní: úspì¹nost tím nejspí¹ je¹tì více klesne. Zkusíme ji pak pozvednout
dal¹ím umìlým zvýhodnìním koordinací (tøeba ¾e se koordinaèní události budou
pøi tréninku zaznamenávat tøikrát nebo ètyøikrát).

G 92022 - B 34008 - P 73,0

Tak kupodivu tentokrát úspì¹nost naopak mírnì pøekonala dosavadní rekord!
Udìlám tedy cvs commit a vrátím se k výzkumu ¾árlivosti (¹lo o to zjistit,
kolikrát parser zavìsil dva ¾árlivce vedle sebe, kolikrát byl jeden nebo oba
¹patnì atd.)

S èíslováním pokusù zaèínáme opìt znova od zaèátku, pøetrénujeme s jednièkou.

3439995 událostí, 20:43 minut
G 92022 - B 34008 - P 73,0



8.3.2004

Pøestavba parse.pl na parse1.pl a øadu modulù. Na souboru lu01 u¾ se
pùvodní i nový parser chovají identicky. Podle vý¹e uvedených záznamù
ze záøí to v¹ak vypadá, ¾e na celých datech jsou poøád je¹tì
rezervy. Následují výsledky nového parseru (parse1):

G 91933 - B 34097 - P 72,9

Ukazuje se ov¹em, ¾e parse.pl je na tom v souèasné dobì úplnì
stejnì. Matnì si vzpomínám, ¾e nìkdy na podzim, kdy jsem nevedl
poøádnì záznamy, jsem se rozhodl odstranit nìjakou systémovou chybu i
za cenu toho, ¾e momentálnì to lehce po¹kodí úspì¹nost.

Pøidávám nové moduly do CVS a potvrzuji stav CVS. Prozatím ponechávám
nové verzi jméno parse1 a staré parse. V pøí¹tí verzi se to asi u¾
zmìní.



10.4.2004

Dal¹í úprava parse1.pl kvùli znovurozchození subkategorizace.
Poèáteèní mìøení mi poskytne srovnání, podle kterého bych mìl
poznat, ¾e jsem zpùsobil chybu. Pou¾ívám oøezaný model 4013
(chybí události vidìné jen jednou nebo ménìkrát). Testuju na prvním
souboru lu01.

G 680 - B 239 - P 74,0

Pro zaèátek pøejdu z volání parslib.pl na pou¾ívání csts.pm.
Souèasnì zru¹ím pou¾ívání pole @slova.



11.4.2004

Po dni práce se mi podaøilo zaøídit, aby i upravený parser dával po¾adovanou
úspì¹nost.

G 680 - B 239 - P 74,0



22.4.2004

Pou¹tím parser na frekim se v¹í parádou, vèetnì n-tic. Dává o pùl procenta vy¹¹í
úspì¹nost ne¾ bylo dosud bì¾né. Odpovídá to tomu, jak si pamatuju úèinek n-tic,
ale v tomto záznamu nemù¾u najít pøíslu¹né èíslo, abych zjistil, zda to sedí pøesnì.

G 92594 - B 33436 - P 73,5 - bìh 5031

Úèelem dne¹ní seance je ovìøit vliv valence (pravdìpodobnì zanedbatelný) na úspì¹nost
v souèasných podmínkách. Musí se to toti¾ napsat do disertace. Modul valence se
kvùli tomu musí oprá¹it a znovu rozchodit.

G 92532 - B 33498 - P 73,4 - bìh 5032



23.4.2004

Pseudoval = 0, valence = 1.

G 92458 - B 33572 - P 73,4 - bìh 5033

Pseudoval = 0, valence = 0.

G 92525 - B 33505 - P 73,4 - bìh 5034

Tím bylo prozatím uèinìno zadost potøebì èísel v disertaci. Teï se vrátím k rùzným
projevùm subkategorizace sloves, konkrétnì k pøeskakování slovesa závislostí.
V bìhu 5031 (viz první vèerej¹í výsledek, G 92594) hledám v¹echny pøípady, kdy
nìjaká závislost pøeskoèila sloveso. Dìlím je na správné a chybné a hledám takové,
které jsou v drtivé vìt¹inì pøípadù (> 90 %) chybné. Dìlím je podle upravených
znaèek pøeskoèeného slovesa, øídícího a závislého uzlu. Nejèetnìj¹í chybné jsou:
(vysvìtlivky: poèet výskytù - procenta chybnì/celkem - znaèka slovesa - øídícího - závislého - 0/1 chybnì/správnì
168x (91,3%) Vf VB N4 0
120x (90,9%) Vf Vp N4 0
 98x (89,1%) Vf Vp Z, 0
 92x (82,9%) Vf VB Z, 0
 88x (40,2%) Vp #  J^ 0
 87x (92,6%) Vf VB J^ 0
Celkem souèet takových pøeskoèení, která byla chybná ve více ne¾ 90 % pøípadù: 4946.
Kdyby se 90 % z tìchto pøípadù (4451) pøidalo do správných závislostí, byla by
úspì¹nost 77 %! Jen¾e to by vy¾adovalo, abych místo zakázané závislosti na¹el v¾dy
tu správnou. A to je utopie.

Pokud se nebudu ohlí¾et na znaèku závislého uzlu, budou nejèastìj¹í opìt pøeskoèené
infinitivy:
852x (89%) Vf VB 0
667x (87%) Vf Vp 0
Celkem souèet 90- a víceprocentních: 1796.

Kromì zákazu pøeskoèení by se dala vyzkou¹et i jiná vìc. Pøi trénování bych si
u ka¾dé závislosti pamatoval, zda pøeskoèila sloveso (a popø. také jaké).

Kdy¾ se zaká¾e pøeskakování pro konkrétní znaèky, které byly vidìt aspoò jednou
a u nich¾ je pøeskok v aspoò 90 % chybný, úspì¹nost vzroste. Ale pozor, zatím to
není dvakrát korektní. Seznam zakázaných pøeskokù toti¾ zji¹»uju z testovacích
dat!

G 93559 - B 32471 - P 74,2 - freki 5048

Pou¹tím tedy na frekim test na trénovacích datech. Na výsledném CSTS zkusím vyhledat
nový seznam zakázaných pøeskokù. Bude asi zkreslený, proto¾e parser se na trénovacích
datech chová jinak ne¾ na testovacích, ale nebude to podvod. Nechce se mi vyèleòovat
zvlá¹tní data a parser pøetrénovávat na zbytku, i kdy¾ na to nìkdy tøeba také dojde.

freki 5050 ... celá trénovací data, zákaz pøeskakování vypnut
shrek 5051 ... testovací data, zákaz zapnut, seznam zákazù: nejen slovesa, vidìna aspoò 1x
Obojí spadlo, proto¾e Milan nìco dìlal a odpojil disk, na který se ukládaly výstupy.
Na novém disku pod èíslem 14 to nakonec dobìhlo (trvá to ov¹em kolem hodiny, procházení
v¹ech pøeskokù ve tøech vnoøených smyèkách je dost neefektivní).

G 93764 - B 32266 - P 74,4 - shrek 0014

Trénovací data (znova 5050, teï pod èíslem 015).

G 974093 - B 281497 - P 77,6 - 015



26.4.2004

Projdu výstup z parsingu trénovacích dat a zkusím na nìm natrénovat zákazy pøeskakování.
Získal jsem 5968 rùzných trojic znaèek, definujících zákazy (pøeskoèený, øídící, závislý).
Zahrnuty jsou pouze trojice, které se vyskytly alespoò pìtkrát. Zkusím pustit parser
s vyu¾itím tohoto seznamu zákazù. Zapínám zákaz pøeskakování, vracím cestu k testovacím
datùm.

G 93132 - B 32898 - P 73,9 - freki 016 :-(

Chtìlo by to pøece jen zjistit, jak moc se ¹idím, kdy¾ místo vyèlenìných dat pou¾ívám
analýzu trénovacích dat. Natrénovat tedy parser na mtrain datech a pustit ho na mtest
data.

017.stat je statistika natrénovaná na mtrain datech.
freki 018 je analýza mtest dat statistikou 017.
G 89121 - B 32960 - P 73,0 - freki 018

Pøi té pøíle¾itosti jsem ponìkud zcivilizoval train.pl, aby u¾ nepou¾ívalo parslib.pl,
ale csts.pm a parse.pm, a také aby plnì pøe¹lo na pole @anot a zapomnìlo na @slova,
@struktura a @afun. Nyní pøejmenuju parse1.pl na parse.pl a train1.pl na train.pl a
celé to ulo¾ím do CVS.

Aktualizoval jsem seznam zakázaných pøeskokù (pøeskoèený-øídící-závislý) podle
018.csts. Jsou tam v¹echny slovní druhy v takových pøeskocích, které se vyskytly
alespoò pìtkrát a které byly z 90 % ¹patnì. Celkem seznam pokrývá 22283 pøeskoèených
uzlù v 018.csts. Nyní otestuju tento seznam zákazù na dtest datech parserem natrénovaným
na train datech (statistika 013.stat).

G 92782 - B 33248 - P 73,6 - T 31:11 min - freki 019

Zpomalení kvùli testování zakázaných pøeskokù (slo¾itost n3) se výraznìji neprojevilo,
ale freki je zøejmì nové dìlo (4× Intel Xeon 2.8 GHz, 4 GB pamìti).

Úspì¹nost je ov¹em ni¾¹í ne¾ se seznamem z testovacích dat. Je¹tì musím otestovat
seznamy zákazù získané ze stejných dat (018.csts), ale s jiným nastavením.

vidìno alespoò pìtkrát, libovolný slovní druh ... u¾ bylo ......... 019 - G 92782 - B 33248 - P 73,6
vidìno alespoò jednou, libovolný slovní druh .... 46264 výskytù ... 020 - G 91375 - B 34655 - P 72,5
vidìno alespoò jednou, jen slovesa ..............  5043 výskytù ... 021 - G 92995 - B 33035 - P 73,8
vidìno alespoò pìtkrát, jen slovesa .............  2698 výskytù ... 022 - G 92995 - B 33035 - P 73,8



27.4.2004

Je¹tì poslední pokus. Ponecháme pøeskoky sloves, které byly vidìny alespoò pìtkrát,
akorát k nim pøidáme tøi nejèastìj¹í pøeskoky jiných uzlù. Jsou to právì ty, které
byly vidìny alespoò 200krát:
Z, Vp VB (219)
Z, VB VB (250)
Z, N1 N1 (267)

G 92942 - B 33088 - P 73,7 - freki 023

Není mi jasné, proè je to hor¹í. Tìch 736 hran sice nemusí být automaticky dobøe,
za prvé v testovacích datech nemusí být stejnì èasté, za druhé kdy¾ zaká¾u jednu
¹patnou mo¾nost, je¹tì to neznamená, ¾e poznám tu správnou. Ale kdy¾ se to nezlep¹í,
proè se to dokonce zhor¹í? Mo¾ná kvùli vedlej¹ím úèinkùm zákazù. Kdy¾ v urèitém
okam¾iku zaká¾u udìlat chybu, mo¾ná tím blokuju provedení nìèeho správného v pøí¹tím
kroku, a nìkdo tomu nìèemu správnému pak vyfoukne rybník?

Závìr: necháme ten nejmen¹í seznam, proto¾e souèasnì patøí ke dvìma nejúspì¹nìj¹ím:
pøeskakování sloves, pokud takový pøeskok byl k vidìní alespoò pìtkrát a zároveò
byl s alespoò devadesátiprocentní pravdìpodobností chybný.

Potvrzuju novou úspì¹nost 73,8 (G 92995) do CVS.

Pokraèuju v testování subkategorizace. Nyní se pokusím vyu¾ít zásobník stavù analýzy.
Na konci analýzy se zjistí, zda má nìkteré sloveso nenaplnìný rámec a zda je ve
vìtì materiál, kterým by ho ¹lo naplnit. Pokud ano, pokusíme se o to.



28.4.2004

Trochu jsem zcivilizoval ukládání stavù analýzy v modulu rozebrat.pm. Teï kontroluju,
¾e jsem nepokazil úspì¹nost.

G 92995 - B 33075 - P 73,8 - freki 026

OK, potvrzeno, ¾e jsem nic nezkazil.



29.4.2004

Dokonèím pou¾ívání zásobníku stavù v pøípadì, ¾e na konci prvního pokusu o analýzu
nemá nìkteré sloveso naplnìný svùj valenèní rámec, aèkoli by mohlo. Opravil jsem
ukládání stavù, je¹tì jednou vyzkou¹ím, ¾e se nic nepokazilo, ne¾ zaènu ulo¾ené
stavy doopravdy pou¾ívat.

G 92995 - B 33075 - P 73,8 - drak 027 - T 58:50 minut

Úspì¹nost se zapla» pánbùh nezmìnila, ov¹em ukládání stavù zvý¹ilo èasovou nároènost
skoro na dvojnásobek. Ze stejného dùvodu také vzrostla pamì»ová nároènost ze 425 MB
a¾ na 1 GB.

Teï tedy zkusíme ulo¾ené stavy opravdu vyu¾ívat. K tomu je potøeba, aby se balík
zálo¾ních stavù z hashe zmìnil na opravdový zásobník (pole). Hash se nám v¹ak také
hodil, proto¾e bylo mo¾né snadno zjistit, zda negenerujeme stav, který u¾ vygenerován
byl. Rozdìlíme tedy strukturu stavù na dvì èásti, hash vygenerovaných stavù a zásobník
nezpracovaných stavù.

generovat_stavy()

Vygeneruje v¹echny stavy, ke kterým se lze dostat z aktuálního stavu. Vezme v úvahu
seznamy povolených a zakázaných závislostí i v pøípadì, ¾e nìkterá závislost má
pøednost bez ohledu na pravdìpodobnostní model (napø. tzv. valenèní závislosti).
Nevezme je v úvahu, pouze pokud má nìkterá závislost absolutní pøednost (je to
druhý díl koordinace apod.) Nové stavy jsou stavy se v¹ím v¹udy, jako kdyby se
výpoèet opravdu mìl ubírat tímto smìrem. Nová závislost je tedy pøidána do stromu,
její váha je známá a je promítnuta do ohodnocení celého stromu. Navíc se ví, jaký
je pomìr mezi váhou této závislosti a váhou vítìzné závislosti v tomto kole (napø.
90 %, ale mù¾e to být i pøes 100 %, pokud nìjaká závislost vyhrála díky protekci,
tøeba proto¾e je valenèní). Prùchod tedy musí být dvoukolový, nejdøíve se vygenerují
v¹echny mo¾né pokraèovací stavy vèetnì vah, potom se zjistí, který stav vyhraje,
a k ostatním se dopoèítá jejich procentuální odstup.

Funkce generovat_stavy() dostane aktuální stav a vrátí v¹echny stavy, ke kterým
se z nìj dá dojít. Oznaèí také stav, který podle ní má zvítìzit v tomto kole (jak
vyplývá z pøedcházejícího odstavce, nemù¾eme se spolehnout na to, ¾e to bude stav
se 100 % pomìrem k vítìzi).

Funkce generovat_stavy() neví o celkové evidenci vygenerovaných a zpracovaných
stavù. Ani tedy nekontroluje, zda nenagenerovala nìjaký stav, který u¾ nageneroval
nìkdo jiný. To v¹echno musí zajistit nìjaká obálka - funkce, která ji volá. Mo¾ná
ale je¹tì zmìním názor a obì èinnosti nìjak spojím.

obálka

Nechat si vygenerovat nové stavy z aktuálního stavu.
Vyjmout z nich vítìze kola, ten u¾ má jisté, ¾e se stane pøí¹tím aktuálním stavem.
Z ostatních vyøadit takové, jejich¾ strom u¾ byl nìkdy vygenerován (bez ohledu na to, zda u¾ byly i zpracovány).
Zbývající stavy pøidat do pøehledu stavù. Pøehled seøadit podle pomìru stavu k vítìzi jeho kola. (Kvùli tomuto øazení
není mo¾né oznaèit pøehled ani za zásobník, ani za frontu.)
Pøehled stavù je potøeba udr¾ovat v rozumné velikosti. Oøíznout ho na n^2 stavù, kde n je poèet slov ve vìtì.



7.5.2004

Pøestavba kódu je z vìt¹í èásti dopsána, mù¾e se zaèít ladit. Nejdøív ale radìji
zkusím nechat v chodu starou funkci generovat_stavy() a pou¾ít jen nìkolik nových
nezbytných drobností. Funkce pridat_zavislost() a zrusit_zavislost() jsou pøestìhovány
do nového modulu stav a jsou do nich pøesunuty i nìkteré èásti okolního kódu, které
døíve le¾ely v rozebrat_vetu(). A zdìdìné upravené morfologické znaèky u¾ nepøepisují
pùvodní znaèky v koøenech koordinací, nýbr¾ se zapisují do stavu. Z nìj se potom
vyzvedávají a¾ v modulu model, kdy¾ se zji¹»ují pravdìpodobnosti.

Nový kód funguje jen na 53 %. Starý kupodivu taky, proto¾e se sna¾í pou¾ívat nìkteré
nové verze knihoven. Zji¹»uju, ¾e nìkteré knihovny nejsou pøidány do CVS! To se
musí napravit. Na¹tìstí se mi podaøilo sestavit verzi, která zvládá pùvodních 73,8 %
(G 92955). ©up s ní do CVS :-).



10.5.2004

Teï je potøeba zjistit, proè nová verze nefunguje.



11.5.2004

Postupnì jsem opravil rozebrat.pm, pøesunul jsem funkce pridat_zavislost() a zrusit_zavislost()
do nového modulu stav.pm, zru¹il jsem Viterbiho a celý modul rozebrat.pm jsem proèistil.
Pøi vytvoøení koordinace u¾ nemìním pùvodní $anot->[$i]{uznacka}, ale ukládám prùbì¾nì
mìnìné znaèky do $stav->{uznck}[$i]. Tím si uvolòuju ruce, abych se mohl kdykoli
vrátit k nìjakému star¹ímu stavu analýzy, ale navíc se ukázalo, ¾e model n-tic a¾
doteï dostával po¹kozené uznacky. Po opravì stoupla maximální úspì¹nost, co¾ jsem
také okam¾itì potvrdil do CVS.

G 93709 - B 32321 - P 74,4 % - T 20:50 (geri 83) => skoro 6 vìt za vteøinu

Nyní se vrátíme k pøestavbì zapoèaté 7.5.2004. Zbývá asi jen vymìnit modul genstav.pm.
Bohu¾el se mi ho nedaøí pøimìt ke stejnému výkonu jako pùvodní genstav.pm, ten
nový zvládá jen 70,0 % (G 88273). Navíc mu to trvá pøí¹ernì dlouho (52:51 minut).
Zkusím to udìlat znova a postupnì. Teï se vrátím k pùvodnímu genstav.pm a doufám,
¾e také k úspì¹nosti 74,4 %. Navíc zru¹ím adresáø staraverze a v¹e zase pøestìhuju
do pùvodní slo¾ky.

geri 111

G 93708, to je sice chyba jen o jedinou závislost, ale nelíbí se mi to. Rozbaluju
cvs checkout do slo¾ky staraverze a pou¹tím analýzu znova.

geri 112

G 93709, tak¾e CVS záloha funguje. Budu si muset pohrát s jejím slouèením s upravovanou
verzí.

geri 113 je nová verze (v horní slo¾ce), zmìnìny moduly rozebrat, genstav a stav
(pøinejmen¹ím), evidují se vidìné stromy, ale neschovávají se k nim celé stavy
a nic se s nimi nedìlá. Evidence lesù dosahuje ¹pièek mezi 1000 a 2000 prvkù a zdá
se, ¾e nijak viditelnì nezatì¾uje pamì», proto¾e zatím také ke stromu neuchováváme
¾ádná velká data.

G 93708

geri 114 je stará verze (v dolní slo¾ce), kam jsem v¹ak shora zkopíroval stav.pm.
V novém stav.pm chybìjí funkce ulozit_stavy() a odfajfkovat_stavy(), které by se
nemìly nikde pou¾ívat. Chybí tam také funkce zkopirovat_stav(), co¾ doufám také
nevadí. Naopak pøibylo poøádné a opravdu hloubkové duplikování stavù, ale ani to
se zatím nikde nevyu¾ívá.

G 93709

freki 115 se od pøedcházejícího li¹í tím, ¾e z nové verze sem byl zkopírován i
genstav.pm.

G 93709

freki 116 má navíc nový rozebrat.pm, èím¾ by mìl být kompletní (a¾ na zaznam.txt).
Uvidíme, zda dosáhne G 93709.

G 93709



12.5.2004

Na¹el jsem rozdíl v parser.ini. V tom hor¹ím bylo u¾ zapnuto valence1 = 1. Zkou¹ím
ho vypnout, jestli to pomù¾e. Mimochodem, mezi dobrou a vadnou verzí jsou celkem
3 odchylky v analýze, ale jen jedna z nich zhor¹ila úspì¹nost.

G 93708 - freki 117

Nepomohlo to. Dochází mi trpìlivost a provádím cvs checkout do horní slo¾ky. Snad
pomù¾e aspoò tohle.

G 93708 - freki 118

Poslední pokus. Zru¹eny rozdíly v povol.pm a zakaz.pm. Sláva!

G 93709 - freki 119

Sláva!

Pokou¹ím se zcela zaèlenit uèení n-tic do train.pl. Zatím zkusím pøidat model n-tic
do statistiky, ani¾ bych ho pou¾il (bude se je¹tì stále naèítat z textových souborù
le¾ících vedle), a zkusím kontrolnì pustit analýzu, zda s novou statistikou bude
stejnì úspì¹ná. Trénink se jmenuje freki 120.

Musí se dost ¹etøit pamìtí. Pokud se toti¾ kromì standardních 3 000 000 trénovacích
událostí je¹tì najednou evidují v¹echny n-tice pro n=2 a¾ 10, po¾ere train.pl neuvìøitelných
2,6 GB! V trénovacích datech je 5 308 978 n-tic, po profiltrování jich ov¹em pøe¾ije
jen 7934. Trénování na frekim (Intel Xeon 2,8 GHz) nyní trvá 32 minut.

Zkusíme, jestli se s takto natrénovanou statistikou dá analyzovat stejnì úspì¹nì
jako dosud. Nemìl by to být problém, proto¾e jediný rozdíl by mìlo být 7000 nových
øádkù, které se zatím k nièemu nepou¾ívají.



13.5.2004

freki 127 bì¾í nad statistikou 124.stat, která by se od 013.stat mìla li¹it právì
pøidanými n-ticemi. Pùvodní textové soubory je¹tì le¾í ve stejné slo¾ce, ale hned
pustím dal¹í kontrolní test, který u¾ opravdu nebude mít ¹anci je najít. freki 128
Bohu¾el, oba mají neuspokojivé výsledky. (Oba stejné.)

G 92496 - B 33534 - P 73,4 - T 23:39

Mo¾ná je ale i jiný problém, mo¾ná je nìjaká chyba v tréninku a jakákoliv novì
natrénovaná statistika dá hor¹í výsledky ne¾ 013.stat. Uvedu tedy parse.pl i ntice.pm
do pùvodního stavu, ale pustím je stejnì na 124.stat.

G 92202 - B 33828 - P 73,2 - T 22:19 - freki 129

Musím zkontrolovat, jestli je¹tì poøád dr¾í úspì¹nost alespoò na 013.stat.

freki 130

124.stat se li¹í od 013.stat. Od 013 se nezachoval záznam konfigurace, který by
bylo mo¾né porovnat se souèasnou konfigurací. 013 má datum 3.2.2004 13:22:41,
tak¾e v pøípadì nezbytnosti zkusím sáhnout do CVS.



14.5.2004

Zjistit, proè train.pl neukládá konfiguraci, se kterou byl spu¹tìn. Opraveno,
sakura 134 u¾ by si mìla zachovat ulo¾enou konfiguraci. V train.pl také opravena
událost KJ3, aby se ve statistice místo slovního tvaru neobjevoval "HASH". Pøesto
stále train.pl negeneruje stejnou statistiku jako train0.pl z 15.9.2003 (poslední
CVS train pøed vyrobením statistiky 013.stat 3.2.2004; následující verze 2.13 u¾
vznikla 8.3.2003). A dále ani train0.pl negeneruje statistiku shodnou s 013, tak¾e
u¾ "optimum" mo¾ná nikdy nezrekonstruuju.

Rekapitulace statistik:
013.stat (3.2.2004) ... optimální stav co do úspì¹nosti parsingu, chci se k nìmu
    dostat, ale nevím jak. Nezachovalo se nastavení ani zdroják trénovaèe.
132.stat (14.5.2004) ... vyrobil train0.pl z 15.9.2003. Nad 132 pu¹tìn parser
    (sakura 133), ale ani ten nemá po¾adovanou úspì¹nost. Má jen G 92499 (73,4 %).
138.stat (14.5.2004) ... nejnovìj¹í train.pl, obì vý¹e uvedené chyby opraveny.

013.stat má 70400220 B, 3186784 událostí (øádkù). Obsahuje 108933 událostí USS.
132.stat má 76127819 B, 3439995 událostí (øádkù). Obsahuje 115479 událostí USS.
138.stat má 75947290 B, 3418684 událostí (øádkù). Obsahuje 115479 událostí USS.

Skoro to vypadá, ¾e 013 byl natrénován na jiných datech? Srovnáme-li pouze události
USS ve statistikách 013 a 138, zdá se (pohledem na první stránku diffu), ¾e 138
má v¹echna èísla vìt¹í nebo rovna èíslùm z 013, a navíc má nìkterá slova úplnì
nová. Napø. slovo "abdikovali". A to je dùkaz! 013 vzniklo natrénováním na mtrainu!
Zkusíme na mtrainu natrénovat novou statistiku (jak pomocí train0.pl, tak pomocí
train.pl).

sakura 139 ... train0.pl na mtrain.csts
drak 140 ..... train.pl na mtrain.csts

139.stat má 70400220 B, 3186784 událostí. Obsahuje 108933 událostí USS.
140.stat má 70243916 B, 3167576 událostí. Obsahuje 108933 událostí USS.

Teï tedy zkusíme parsing nad obìma novými statistikami.

G 92398 - B 33632 - P 73,3 - T 45:19 - loki 141 ....... nad 139.stat
G 92096 - B 33934 - P 73,1 - T 22:23 - belzebub 143 ... nad 140.stat

Je¹tì jednou testuju úspì¹nost nad statistikou 013. U¾ mì to unavuje, ale zdá se
podezøelé, ¾e by se li¹ila od statistiky 139, kdy¾ jsou pøesnì stejnì velké. A
pøitom tentý¾ parser na jedné z nich funguje na 73,3 % a na druhé údajnì na 74,4 %.
Teï mi diff potvrdil, ¾e obì statistiky se vùbec nijak neli¹í! A z prùbì¾ných výsledkù
to vypadá, ¾e i na 013 výkon nìjak poklesl.



25.5.2004

Vracím se k parsingu po narození Lucinky.
Test drak 150 nad statistikou 013. Kontrola, zda dosáhneme nejlep¹í známé úspì¹nosti.
Optimum bylo dosa¾eno 11.5.2004 a èiní 74,4 % (G 93709).

G 93709 - B 32321 - P 74,4 - T 30:27

Test drak 152 nad statistikou 139. Statistiky 013 a 139 jsou toto¾né, tak¾e by
výsledek 152 mìl být stejný jako 150.

G 93709 - B 32321 - P 74,4 - T 30:16

Test anette 153 nad statistikou 013. "Stará verze parseru", tj. poslední verze
ulo¾ená v CVS.

G 93709 - B 32321 - P 74,4 - T 26:02

Teï se soustøedím na to, aby train.pl umìl vyrobit statistiku toto¾nou s 013.stat.
Verze z 15.9.2003 to zøejmì umí (pou¾il jsem ji 14.5.2004 a vznikla statistika
139, která je s 013 toto¾ná). Pro jistotu je¹tì jednou pustím train0.pl, co¾ je
kopie verze z 15.9.2003, i kdy¾ u¾ má jiné datum. Je to train anette 154, trénuje
se na mtrain datech (1425 souborù).

3186784 událostí - T 10:33 - 154.stat se shoduje s 013.stat

Paralelnì pou¹tím i novìj¹í train.pl, opìt jen pro kontrolu, proto¾e vím, ¾e tvoøí
odli¹nou statistiku. Je to train drak 155, rovnì¾ se trénuje na mtrain datech.
Asi po hodinì práce to spadlo, proto¾e to nena¹lo funkci ntice::shrnout().

Prozkoumám rozdíly mezi train0.pl a train.pl a také rozdíly mezi obìma statistikami.
Vytváøím pøechodový skript train05.pl a budu prùbì¾nì testovat, zda je¹tì dosahuje
stejných výsledkù jako train0.pl. Nejdøív sjednocuji "use" moduly v záhlaví a odstraòuji
sáhodlouhý "pod" komentáø. Je to train anette 156.

3186784 událostí - T 10:38 - 156.stat se shoduje s 013.stat

Nahradím ètení subkategorizaèního slovníku analogickou funkcí z modulu subkat.
Je to train anette 157.

3186784 událostí - T 10:34 - 157.stat se shoduje s 013.stat

Provedu v¹echny úpravy, které nejsou závislé na nahrazení parslib.pl modulem csts.pm.
Vesmìs jsou jen kosmetické. Trénování ntic zatím taky nepøidám. Rozdílový soubor
obou trainù má poøád je¹tì 470 øádkù. Test momentálního train05.pl je anette 158.

3186784 událostí - T 10:44 - 158.stat se shoduje s 013.stat

Nahradím pole $struktura[$i] polem $anot->[$i]{rodic_vzor}. Polo¾ka rodic_vzor
se plní u¾ i v parslib.pl, tak¾e by nemìl vzniknout problém. Je to train anette 159.
Bohu¾el se zøejmì zacyklil. Cyklení zpùsobuje $struktura[$k] na øádku 441. Zatím
nevím proè a pou¹tím train05, kde je tento øádek postaru, v¹echny ostatní struktury
jsou pøepsány pomocí anot. Je to train anette 168.

3192325 událostí (!!!) - T 10:59 - 168.stat se od tìch pøedchozích li¹í!

Mezitím jsem zaøídil, aby $anot->[0]{rodic_vzor} bylo 0 stejnì jako $struktura[0].
Mìlo by tím odpadnout cyklení a mo¾ná také rozdíly mezi statistikami, uvidíme.
Je to train anette 172.

3191989 událostí - T 11:07 - 172.stat se li¹í od 013.stat.

Li¹í se události typu LOK a RAM. "Normální" události se neli¹í. Proto nejvìt¹í
podezøení padá na zmìny ve funkci spocitat_lokalni_konflikty(). Kromì náhrady
$struktury $anotem jsem je¹tì zpøísòoval podmínku na øádku 634 o $i<$#{$anot}.
Toto zpøísnìní teï zakomentovávám a pou¹tím train anette 174.

3186448 událostí - T 11:00 - 174.stat se li¹í od 013.stat i od 172.stat.

Od 013.stat se li¹í ménì ne¾ 172.stat. Události typu LOK u¾ jsou v poøádku, li¹í
se pouze události typu RAM. Na tìch by sice nezále¾elo, proto¾e momentálnì se,
pokud vím, pøi parsingu nepou¾ívají, ale potøebuju vìdìt, ¾e umím vyrobit statistiku
toto¾nou s 013, tak¾e se pokusím opravit i je. To je train anette 175.

3186784 událostí - T 10:49 - 175.stat se shoduje s 013.stat.

Nahradím pole $afun[$i] polem $anot->[$i]{afun}. Kvùli tomu upravuji parslib.pl,
aby pøi ètení vyplòoval afuny do @anot. Train anette 176.

3186784 událostí - T 11:08 - 176.stat se shoduje s 013.stat.

Nahradím pole $slova[$i] polem $anot->[$i]{slovo}. Kvùli tomu upravuji parslib.pl,
aby obsah obou polí byl opravdu toto¾ný. Zatím se toti¾ u @anot nevyplòoval koøen
a u ¾ádného slova se nenahrazovala velká písmena malými. Bohu¾el se to zase nìkde
cyklí. Grrr! A zase je to v lokálních konfliktech! Je to záludná chyba, neoprávnìnými
pøístupy za hranici pole @anot se toto pole natahovalo, co¾ mìlo fatální dùsledky
pro cyklus, který byl délkou pole øízen. Chybu jsem nena¹el, radìji jsem tedy na
zaèátku funkce délku pole zkopíroval, pak jsem se ve v¹ech cyklech ptal na délku
kopie a na konci jsem kopii zkopíroval zpìt do po¹kozeného pole. Train anette 192.

3186784 událostí - T 10:57 - 192.stat se shoduje s 013.stat.

Po odstranìní polí @struktura, @afun a @slova upravuji poslední související øádky,
zejména volání funkcí, ve kterých se døíve tato pole pou¾ívala. Train anette 193.

3186784 událostí - T 13:04 - 193.stat se shoduje s 013.stat.

Zdá se, ¾e nyní je ji¾ v¹e pøipraveno k pøepojení z parslib.pl na csts.pm. Provedu
tedy vlastní pøepojení. Train anette 194.

3158211 událostí - T 21:14 - 194.stat se li¹í od 013.stat :-(



27.5.2004

Pou¹tím parsing nad statistikou 194. Pøedpokládám, ¾e výsledek bude hor¹í ne¾ nad
013. Parse anette 195.

G 93643 - B 32387 - P 74,3 - T 27:34



31.5.2004

Porovnávám statistiky 013 a 194. Li¹í se snad ve v¹ech událostech. Porovnávám poøadí
výskytu událostí v train03.pl (pou¾ívá parslib.pl) a train05.pl (pou¾ívá csts.pm).
Rozdíl je v koøenech koordinací. Star¹í program má v $anot->[$koren]{uznacka} znaèku
koøenového slova nebo interpunkce. Novìj¹í program tam má mno¾inu znaèek zdìdìných
od èlenù koordinace.

train anette 196: train03.pl se záznamem událostí
train anette 197: train05.pl se záznamem událostí
... a¾ po anette 230

Zdá se, ¾e jsem koneènì na¹el v¹echny rozdíly v hledání zdìdìných znaèek. Pou¹tím
nový kompletní trénink train05 (anette 231).

3186784 událostí - T 30:31 - 231.stat má sice stejný poèet událostí jako 013.stat,
ale neshodují se! Taky velikost souborù se li¹í: 013 má 70400220 B, 231 má 72137493 B.
Ale to by mohlo být tím, ¾e jsem pøi ladìní zmìnil OSS na OSSXXX. Dám to do poøádku
a odstraním v¹echny výpisy do souboru "ud", èím¾ by se taky mìl program o tøetinu
urychlit. Train anette 232.

3186784 událostí - T 20:28 - 232.stat se shoduje s 013.stat.

Po 19 dnech se mi tedy koneènì podaøilo modernizovat kód train.pl, ani¾ by se to
podepsalo na generovaných statistikách. Pro tuto chvíli ov¹em rezignuju na nápad,
kvùli kterému to celé zaèalo, toti¾ na zaèlenìní modelu ntic do bì¾ného tréninku.
Jednak u¾ nemám na takové blbosti èas, jednak by to nebylo jen tak, proto¾e ntice
vy¾adují posbírat obrovské mno¾ství nových událostí, z nich¾ lze malý cílový vzorek
odfiltrovat teprve na konci, kdy u¾ se ví, která událost byla vidìna více ne¾ jednou.
Tím se nìkolikanásobnì zvy¹uje pamì»ová nároènost programu (z nìkolika stovek MB
a¾ na asi 2 GB) i èas potøebný na výpoèet (asi dvakrát).

Zakomentovávám tedy øádek s "ntice::ucit()", kopíruji train05.pl do train.pl, ma¾u
v¹echny mezistupnì trainNN.pl a potvrzuji cvs commit. Potom je¹tì naposledy volám
kontrolní "train.pl ; parse.pl" a jdu domù :-)



1.6.2004

Oba závìreèné pokusy dopadly dobøe. Trénink trval 10:46 minut.

G 93709 - B 32321 - P 74,4 - T 25:31

Teï se pokusím opravit chybu v train.pl, kterou jsem objevil pøi jeho modernizaci,
ale nemohl jsem s ní nic dìlat, proto¾e bych nedostal toto¾nou statistiku. Bohu¾el
není zaruèeno, ¾e opravou chyby úspì¹nost stoupne a ne naopak klesne.

Stejnì je dost divné, ¾e lokální konflikty, kterých se ta chyba týká, se dosud podílely
na lep¹í úspì¹nosti (proto¾e kdy¾ jsem je vypnul, úspì¹nost klesla), pøesto¾e sama
slova, která byla pøi lokálních konfliktech pøevì¹ena, dopadla bídnì: 1286 zlep¹ení
proti 2137 zhor¹ením. Tato bilance byla zøejmì zvrácena nepøímými vlivy, napø. ¾e
jiné zavì¹ení uzlu v lokálním konfliktu pùsobilo jako prevence nìkolika dal¹ích chyb.

train anette 235: 3192797 událostí - T 11:18
G 93717 - B 32313 - P 74,4 - T 25:39 - parse anette 236

Sláva, úspì¹nost neklesla, i kdy¾ stoupla jen nepatrnì. Ani bilance lokálních konfliktù
se nezmìnila nijak dramaticky: 1297 zlep¹ení proti 2145 zhor¹ením. Cvs commit.



Je na èase vrátit se ke snahám o vybudování zásobníku stavù a o vracení se v pøípadì
nenaplnìného valenèního rámce. Naposledy jsem se o nìco tímto smìrem pokou¹el 11.5.2004.
Nìjaká pøedstava, jak jsem to chtìl dìlat, je popsaná u 29.4.2004, ale stejnì si
nejsem jistý, ¾e tahle pøedstava nepadla pøi konfrontaci s realitou.

V modulu genstav.pm jsou nyní dvì verze klíèové funkce. V provozu je zatím stále
stará verze pod názvem generovat_stavy(). Nová verze se jmenuje generovat_stavy1()
a nevrací vítìzného kandidáta, nýbr¾ seznam nových stavù, ze kterých se a¾ pak
musí vybrat vítìz.

anette 238: generovat_stavy() u¾ opravdu èásteènì generuje nové stavy, ale ty je¹tì
nemají vliv na výbìr vítìze. Jde tedy jen o potvrzovací bìh, ¾e se nic neposralo.
Úspì¹nost sice zùstala nedotèena, ale výpoèet trvá skoro ètyøikrát déle!

G 93717 - B 32313 - P 74,4 - T 1:36:08

belzebub 249: O krok dál. Z nových stavù u¾ i vybírám vítìze a kontroluju, ¾e se
shoduje s vítìzem, kterého vybral starý kód. Pokud ne, hodí se výjimka.
-> genstav1.pm (genstav0.pm je pùvodní z CVS)

G 93717 - B 32313 - P 74,4 - T 1:22:49

anette 254: Výbìr vítìze z nových stavù obohacen o lokální konflikty. Shoda se
kontroluje a¾ potom.
-> genstav2.pm

G 93717 - B 32313 - P 74,4 - T 1:35:12

Nemáme sice na nový kód pøevedeno celé generování nového stavu, ale jeho podstatnou
èást ano. Nyní zmìním zpùsob, jakým se výsledek funkce generovat_stavy() pøedává
nahoru. Dosud se vracel "max-hash", kde kandidáta popisovaly hodnoty r, z, c, p
a priste. Nyní se bude vracet pole stavù, jeho¾ první prvek bude ten vítìzný. Vítìzný
kandidát u¾ do nìj bude zanesen, tj. u volajícího odpadne následné volání funkce
stav::pridat_zavislost(). Zatím se budou vracet stavy nalezené starým kódem.

belzebub 262 (vý¹e uvedené)
G 93717 - B 32313 - P 74,4 - T 1:27:04



2.6.2004

Funkce generovat_stavy() od nynìj¹ka vrací stavy nalezené novým kódem. K tomu je
potøeba, aby se i závìreèná manipulace se stavem (související s koordinacemi) provádìla
nad novými stavy (a to nad v¹emi je¹tì pøed pøidáním hrany, tím se zajistí kompatibilita).
Pøíslu¹ný kus kódu jsem pøesunul do funkce stav::pridat_zavislost(). Pou¹tím dva
výpoèty, jeden je¹tì vrací stav upravený starým kódem a akorát spoléhá na èást
pøesunutou do pridat_zavislost(), druhý u¾ navíc vrací stavy nalezené novým kódem.
První je belzebub 263, druhý anette 264.

belzebub 263
G 93717 - B 32313 - P 74,4 - T 1:29:30
anette 264
G 92693 - B 33337 - P 73,5 - T 2:10:46

Zdá se, ¾e anette ztrácí na úspì¹nosti! Oba výstupy se li¹í, anette obèas místo
odkazu na rodièe vypí¹e -1!

Obrovská èasová nároènost generování stavù mo¾ná souvisí s tím, ¾e se v¹echny stavy
cachují podle stromù. Vypínám ukládání stavù (zakomentovávám ho).

Vracím kód na úroveò 263, tj. závìreèné manipulace zùstávají pøesunuté do modulu
stav, ale vrací se poøád stav získaný starým kódem. V zájmu zpøehlednìní kódu vyndávám
z generovat_stavy() zavì¹ování koncové interpunkce vyrábím jí samostatnou funkci
generovat_pro_koncovou_interpunkci().

sakura 265
G 93717 - B 32313 - P 74,4 - T 1:34:14

Pøidávám obdobnou funkci pro generování druhé èásti koordinace.

euler 266
G 93717 - B 32313 - P 74,4 - T 1:59:20

Pøidávám obdobnou funkci pro zavì¹ování valenèních závislostí.

anette 267
G 93717 - B 32313 - P 74,4 - T 2:08:05

U pøidávání závislosti do duplikátu stavu v novém kódu jsem na¹el kopii kódu, který
jsem pøed 263 pøesouval do modulu stav. Teï u¾ by tato kopie mìla být nadbyteèná,
proto jsem ji smazal.

euler 268
G 93717 - B 32313 - P 74,4 - T 2:22:52

Do zvlá¹tní funkce jsem pøesunul i základní generování nových stavù a hledání vítìzného
kandidáta.
-> genstav3.pm

sakura 272
G 93717 - B 32313 - P 74,4 - T 1:33:27

Zru¹il jsem funkce gererovat_stavy1(), vybrat_viteze() a generovat_stavy_rozskok().
Patøily k vìtvi, kterou u¾ teï mù¾u prohlásit za slepou.

belzebub 273
G 93717 - B 32313 - P 74,4 - T 1:24:41

Z nového kódu jsem odstranil nepou¾ívanou kopii zpracování koncové interpunkce a
valenèních závislostí.

geri 274
G 93717 - B 32313 - P 74,4 - T 1:53:39

Výbìr vítìze mezi novými stavy jsem pøesunul pøímo do funkce, ve které seznam nových
stavù vzniká. Tam, kde se pùvodnì vybíral vítìz, se automaticky pøedpokládá, ¾e
ho najdeme na nulté pozici.
-> genstav4.pm

anette 275
G 93717 - B 32313 - P 74,4 - T 1:50:31

Do zvlá¹tní funkce jsem pøesunul i volání lokálních konfliktù, vèetnì jejich nové
verze.
-> genstav5.pm

euler 277
G 93717 - B 32313 - P 74,4 - T 2:03:12

Nový pokus vrátit z funkce generovat_stavy() pole stavù dodané novým kódem.
-> genstav6.pm

Chyba, proè to poprvé ne¹lo, je ov¹em mo¾ná schovaná v rozebrat.pm v backtrack(),
opravil jsem ji, ale rozebrat.pm jsem nezálohoval.

anette 279
G 93719 - B 32311 - P 74,4 - T 1:46:02 !!! MALÉ ZLEP©ENÍ - JAK TO?

Odstraòuji zdvojené zpracování lokálních konfliktù. Nadále se bude pou¾ívat pouze
volání vázané na nový kód. Parseru by se mìlo trochu ulevit co do èasových nárokù.

sakura 280
G 93719 - B 32311 - P 74,4 - T 1:40:13 !!! MALÉ ZLEP©ENÍ - JAK TO?

Odstraòuji také alternativní èásti kódu v hlavní èásti genstavu a kontrolu, zda
nový kód produkuje toté¾ co starý. A místní zpracování lokálních konfliktù u¾ nevrací
hash s novým kandidátem. Není to potøeba, proto¾e stejnì rovnou upraví pole nových
stavù.
-> genstav7.pm

belzebub 281
G 93719 - B 32311 - P 74,4 - T 1:21:57 !!! MALÉ ZLEP©ENÍ - JAK TO?

Kvùli znaèné èasové nároènosti bude generování v¹ech pokraèovacích stavù volitelné
a standardnì se bude generovat pouze vítìzný stav. Zatím pouze vytvoøím pøíslu¹ný
vypínaè a vypnu ho.

sakura 282 Alarm! Nízká úspì¹nost!
Rychle je¹tì zkusíme toté¾ s vypínaèem zapnutým. Zaèátek vypadá rozumnì, ale radìji
ho nechám dobìhnout do konce.

sakura 283
G 93719 - B 32311 - P 74,4 - T 1:37:31 !!! MALÉ ZLEP©ENÍ - JAK TO?

Chyba snad opravena, pou¹tím znova s vypnutým vypínaèem.

geri 284
G 93717 - B 32313 - P 74,4 - T 36:35



Generování stavù je pøebudováno. Je¹tì v¹ak není vyøe¹eno ukládání vygenerovaných
stavù tak, aby bylo pozdìji mo¾né se k nìkterému z nich vrátit. To u¾ by se kvùli
rychlosti mìlo urèitì dìlat jen u vytipovaných stromù, kde na konci není v poøádku
valence.

Naposledy jsem se valencí zabýval 22.4.2004, ale jinak. Pak jsem se zabýval zakázanými
pøeskoky sloves. 29.4.2004 jsem u¾ psal pøímo o ukládání stavù a myslel jsem si,
¾e ho mám skoro hotové, ale nebyla to pravda. A¾ dnes to vypadá, ¾e mám funkèní
to, co se mi zdálo funkèní u¾ tenkrát. A je to celé pøebudované.

Nikde ov¹em nemù¾u najít zmínku o tom, zda u¾ je naprogramované poznávání, ¾e ve
vìtì není naplnìn nìjaký valenèní rámec. Mìlo by to být udìlané, proto¾e, pokud
vím, pøed èasem u¾ jsem mìl i statistiku, kolika vìt se ten tyjátr týká.

V modulu subkat.pm je funkce najit_nenaplnene_ramce(), která pøebírá stav analýzy
(napø. kvùli návrhu stromu) a odkaz na valenèní slovník a vrátí 1, pokud zjistí,
¾e ve vìtì existuje sloveso s nenaplnìným rámcem a materiál, kterým by rámec ¹el
naplnit. Tato funkce se momentálnì volá z funkce backtrack() v modulu rozebrat,
ale její výsledek se ignoruje.

Mìlo by se udìlat následující:
- Jestli¾e byla funkce zavolána na danou vìtu poprvé a vrátí 1, zapnout ukládání
  stavù a opakovat analýzu vìty a¾ k tomuto bodu. Funkci ani nemusíme hned znova
  volat, stav by mìl být úplnì stejný, jen vedle bude existovat zásoba zálo¾ních
  stavù.
- Obnovit vybraný stav. Ideální by bylo obnovit druhé nejlep¹í pokraèování z místa,
  ve kterém jsem si zazdil cestu k naplnìnému valenènímu rámci, ale nevíme, které
  místo to je - cestu jsme si mohli zazdít i nepøímo. Proto obnovíme stav, ve kterém
  nejménì ztratíme na váze oproti stavu, který byl v dané chvíli vybrán pùvodnì.
- Samozøejmì z výbìru vynecháme stavy, ke kterým se pozdìji stejnì dospìlo normální
  cestou. Mj. se tak vyhneme opakovanému zkoumání dvojic N-A na rùzných místech
  vìty, kdy¾ ve skuteènosti se do analýzy pohodlnì ve¹ly v¹echny.
- Musíme tedy v nìjakém hashi evidovat v¹echny lesy, ze kterých u¾ jsme ¾dímali
  pokraèovací stavy. Ze zásoby stavù vylouèíme takové, které vycházejí z ji¾ známého
  lesa.
- I tak je nebezpeèí, ¾e zásoba stavù nezvladatelnì poroste. Musíme tedy poèet stavù
  v zásobì shora omezit. Nemám je¹tì jasno jak moc, mo¾ná by staèilo na konstantní
  mocninu poètu slov ve vìtì, tøeba na n^2. Jde nám toti¾ hlavnì o to, aby zásobník
  nerostl exponenciálnì. Nejdel¹í vìta v testovacích datech má asi 100 slov, n^2
  by tedy bylo 10000.
- Poèet stavù ze zásobníku, které skuteènì vyzkou¹íme, by mìl být je¹tì ni¾¹í, abychom
  se výsledku nìkdy doèkali. Navrhuji namátkou zkusit 50 návratù z konce, pokud
  se døíve nenajde zaplnìný valenèní rámec.
  - Tím se také bráním "zacyklení" v pøípadì, ¾e vìta ve skuteènosti nemá dost
    materiálu do rámcù, ale na¹e primitivní metoda to nezjistila, napø. kdy¾ je
    ve vìtì jeden akuzativ, ale 2 slovesa, která by ho chtìla. Ze zacyklení by se
    sice teoreticky vyklouzlo vyzkou¹ením v¹ech mo¾ných stavù, ale jejich poèet
    je v praxi nutné pova¾ovat za blízký nekoneènu.
- Pokud i po "valenèním backtrackingu" zùstane nìkterý rámec nenaplnìn, mìli bychom
  se vrátit k výsledku, který jsme navrhovali jako první, proto¾e pozdìj¹ími úpravami
  jsme pravdìpodobnì pokazili dal¹í vìci.
  - Lep¹í v¹ak bude otestovat, jak to dopadá v praxi, zda tøeba jeden návrat v prùmìru
    nepøinese nìjaký u¾itek.



4.6.2004

Upravuji rozebrat.pm tak, aby se standardnì pracovalo bez ukládání zálo¾ních stavù,
ale v momentì, kdy se na konci najde nenaplnìný (a naplnitelný) slovesný rámec,
se celý rozbor zopakuje s ukládáním stavù. Zatím se s nimi nic nedìlá. Ov¹em pozor,
nejspí¹ se nedìlá vùbec nic navíc, proto¾e jsem zapomnìl vynulovat výchozí stav,
tak¾e strom je ihned hotový.

G 93717 - B 32313 - P 74,4 - T 22:01 - belzebub 285

Oprava. U¾ resetuju stav pøed novou analýzou.

G 93717 - B 32313 - P 74,4 - T 22:31 - belzebub 286



7.6.2004

Opravil jsem funkci subkat::najit_nenaplnene_ramce(), nyní snad vrací to, co má.

G 93719 - B 32311 - P 74,4 - T 1:51:54 - anette 305

Byla tam chyba. Po nalezení první vìty s nenaplnìným rámcem se u¾ pøepoèítávaly
v¹echny.

G 93718 - B 32312 - P 74,4 - T 1:28:15 - anette 307 :-(



10.6.2004

Poprvé probìhla celá analýza se zapnutým vracením se pro valenèní doplnìní. Neoèekával
jsem nijak pøevratné výsledky, ale zatím se výsledek zcela shoduje s výsledkem
analýzy, pøi ní¾ byla dotyèná vlastnost vypnuta, co¾ je podezøelé.

G 93718 - B 32312 - P 74,4 - T 1:31:59 - freki 312

Pou¹tím to celé je¹tì jednou, ale pøidávám statistiku, v kolika vìtách k návratu
do¹lo, pøípadnì ke kolika návratùm do¹lo a kolikrát to vùbec vedlo k nìjaké zmìnì
(zatím zjevnì nikdy).

Opraveno nìkolik chyb, teï u¾, zdá se, backtracking funguje, akorát v nìm je¹tì
chybí restrikce na poèet stavù, tak¾e hrozí, ¾e buï "nikdy" neskonèí, nebo skonèí
chybou pro nedostatek pamìti. Pokusný bìh na vìtì 6 nasbíral 42000 stavù, pak jsem
ho utnul, proto¾e byl pu¹tìn interaktivnì do more a nemìl jsem na nìj èas. Chtìlo
by to pøi vybírání návratového stavu posoudit, zda v tomto stavu je¹tì je ¹ance
zaplnit nìjakou nezaplnìnou valenci. Jinak ho rovnou oznaèit za zpracovaný.

freki 335 ... Podle oèekávání hned první backtracking vyhoøel na nedostatku pamìti
(nageneroval pøes 59000 stavù, zpracoval jich asi 4000 a spotøeboval pøes 2 GB).



11.6.2004

Potøebujeme seznam slov, která ve vìtì pøedstavují rezervu pro naplòování rámcù.
Jsou to slova, která splòují valenèní podmínky toho kterého slovesa, ale také je
je¹tì ¾ádné sloveso neanga¾ovalo (valenènì; mohou v¹ak tøeba neprávem viset na
modálním slovesu). Abychom takový seznam získali, musíme upravit funkci, která
zatím pouze zji¹»uje, zda lze uspokojit neuspokojené po¾adavky, ale má na víc.



14.-18.6.2004

Pracuju na modulu subkat.pm, aby dokázal øíct, které vazby v navrhované analýze
chybí a které pro jejich naplnìní nelze vyu¾ít. Vytvoøil jsem funkci obohatit_pole_deti(),
která mi umo¾ní seøadit dìti slovesa podle pravdìpodobnosti, ¾e jde o argumenty.
V pátek 18.6.2004 v 18:29 jsem to koneènì dopsal, teï pøijde ladìní.



7.7.2004

Po dovolené pou¹tím parse.pl. Nezaèal se vracet u¾ u vìty 6, ale a¾ u vìty 17.
Ani tady se ale nezdá, ¾e by to mìlo nìkdy skonèit. Oprava: Stav, ve kterém není
volný nìjaký nadìjný uzel (tj. takový, který by mohl zaplnit valenci), se rovnou
oznaèí za zpracovaný. Výpoèet konverguje sice o nìco rychleji, doopravdy zpracovaných
je teï asi 16000 uzlù, ale stejnì je to neúnosnì dlouhé a stejnì to nakonec skonèí
na nedostatku pamìti. Pùjdeme tedy je¹tì o krok dál. Budeme hledat stavy, kde je
nadìjný uzel u¾ rovnou pøipojen ke slovesu, které jeho pomoc potøebuje. Budeme
ignorovat fakt, ¾e nìkteré prùchody odepisujeme døíve, ne¾ mohlo být pøipojení
vùbec povoleno. Jestli¾e u nìkterého nadìjného uzlu vyzkou¹íme v¹echna jeho pøipojení
ke v¹em hledajícím slovesùm a nepomù¾e to, pøestaneme daný uzel pova¾ovat za nadìji.
Potøebujeme vìdìt, pro které sloveso je který uzel nadìjí.

Zmìna. Nebudeme si komplikovat evidenci tím, pro jaké sloveso je jaký uzel nadìjí.
Prostì dovolíme pokraèování jen ze stavù tìsnì po zavì¹ení nìkterého nadìjného
uzlu. První úspìch: vìta 17 je první, kterou backtracking pro¹el úspì¹nì (tj.
podaøilo se mu valence zaplnit)! Bylo nasbíráno 11295 stavù, z toho jen 407 bylo
na konci ve frontì nezpracovaných.

I teï bohu¾el hrozí krach výpoètu z dùvodu nedostatku pamìti. Zpracované stavy
by se mìly ihned po zpracování (nebo zavr¾ení) vyprazdòovat a¾ na pøíznak {zpracovano}.
Byla by s tím ale spojena dal¹í èasová re¾ie a navíc se obávám, zda je to bezpeèné,
tj. zda opravdu nikde nesahám na jiné polo¾ky zpracovaných stavù.

Zatím se zdá, ¾e výpoèet by mohl mít ¹anci na dobìhnutí, i kdy¾ i tak bude trvat
øádovì déle ne¾ normální výpoèty.

geri 362
Výpoèet umìle zastaven na vìtì, kde nejspí¹ neexistuje optimální zaplnìní rámcù.
V okam¾iku zastavení mìl proces alokováno 2,3 GB pamìti, nageneroval 101193 stavù,
z toho 4017 zbývalo zpracovat (av¹ak poèet nezpracovaných stále pomalu rostl).

Kromì vyprazdòování stavù bych asi mìl omezit celkový poèet generovaných stavù (tøeba
na 50000?) a celkový poèet návratù (500?). Zatím zavádím vyprazdòování stavù a
omezení poètu návratù na 500.

geri 363 - Nakonec také Segmentation fault.

Omezuji poèet návratù na 100.

geri 364



13.7.2004, Kolna

Pøi psaní disertace nará¾ím na problém vzta¾ných vìt a toho, proè se pravidlo
pro nì urèené uplatní tak málokrát.

Kolikrát se zkoumá, zda jde o správnou závislost typu "který"? 1160-krát.
Ve v¹ech tìchto pøípadech u¾ je skuteènì pøítomno zájmeno "který", ale je¹tì
není ovìøena shoda. Pøes nìkterá zájmena se také zkou¹í natahovat celá øada
závislostí. Mìla by se chytat i zájmena visící pøes pøedlo¾ku, ale nemám ovìøeno,
¾e to funguje, bìhem výpoètu jsem nic takového nevidìl.

Na konci výpoètu u¾ se pøekvapivì neobjevuje statistika úspì¹nosti tohoto pravidla,
tak¾e nemám podle èeho ovìøit, jak to je. V testovacích datech je celkem 801 výskytù
tvarù zájmena "který". 48 z nich visí pøes pøedlo¾ku.

Ve 483 pøípadech se skuteènì pravidlo chytlo. Z toho 389-krát pravidlo zabralo
správnì, úspì¹nost je tedy 80,5 %.



16.7.2004

Kapitola o plodnosti uzlù. Pøetrénovat a znova pustit parser, jednak jako kontrolu,
¾e v¹e ¾ije, jednak pøi trénování pøidat událost ZPL - znaèková plodnost. Napø.
"ZPL N7 2 10" znamená, ¾e byl desetkrát zaznamenán pøípad, kdy uzel se znaèkou
N7 mìl dvì dìti.

geri 367 - 3 448 405 událostí - 76 MB - T 11:08
geri 369 - parse.pl nad 367.stat, je to podezøelé, asi nebude úspì¹nost taková,
jaká má být. Také se mi výpoèet zdá pomalý. Skonèilo to po 767 vìtách!
G 15500 - B 5391 - P 74,2 - T 6:22
Aha! Zùstal zapnutý filtr, který propustil pouze vìty obsahující zájmeno "který"!
Vypínám, pou¹tím znova.

G 93785 - B 32245 - P 74,4 - T 22:12 - geri 370

Pøekvapení. Po vypnutí valence1 se úspì¹nost neèekanì zlep¹ila o 67 závislostí
oproti nejlep¹ímu zaznamenanému stavu pøed jejím zapnutím. Potvrzuji do CVS (kam
souèasnì pøidávám modul plodnost.pm).

Zkou¹ím "typickou plodnost" (TFM). Pravdìpodobnost i èetnost závislosti se násobí
pravdìpodobností, ¾e uzel bude mít dal¹í dítì. Tato pravdìpodobnost má ov¹em pouze
tøi hodnoty. 0, pokud kvóta dìtí u¾ byla naplnìna èi pøekroèena. 1, pokud je¹tì
nebyla dosa¾ena. A 0,5, pokud uzel neupøednostòuje jednoznaènì konkrétní poèet
dìtí (tj. není pravda, ¾e dotyèná m-znaèka byla vidìt alespoò 100×, a z toho alespoò
v 80 % s daným poètem dìtí).

G 93039 - P 73,8 % (geri 375)

Zkou¹ím "hlídání kvóty dìtí" (QFM). Plodnostní pravdìpodobnost nyní nabývá pouze
hodnot 0 a 1. Nula je pro uzly, které jednoznaènì preferují urèitou kvótu, a té
u¾ dosáhly nebo ji dokonce pøekroèily. Pro v¹echny ostatní je jednièka.

G 93113 - P 73,9 % (geri 377)



17.7.2004

Implementuji úplnou plodnost (FFM). Dvì varianty: 3 a více dìtí se buï pova¾uje
za jediný stav, nebo se pro ka¾dou znaèku zohledòují v¹echny poèty dìtí, se kterými
byla vidìna. Pokud se 3 a více dìtí eviduje najednou, dostane uzel, který u¾ má
3 dìti, automaticky 0.5. Pozor, opravené poèítání pravdìpodobnosti oproti Modelu Jedna: kdy¾
chce uzel buï 0 nebo 2 dìti, ale rozhodnì ne 1, a u¾ jedno dostal, má velmi vysokou
pravdìpodobnost, ¾e dostane i druhé!

G 93677 - P 74,3 % (geri 378)

Je¹tì druhá varianta - i velké poèty dìtí se poèítají samostatnì.

G 90640 - P 71,9 % (geri 380)



Vzdálenost. Kromì standardního zohledòování sousedství a pøípadného poètu intervenujících
èárek se je¹tì pravdìpodobnost a èetnost závislosti dìlí vzdáleností obou uzlù.
Èiním tak na radu Tomá¹e Holana, kterému to pomohlo.

G 93845 - P 74,5 % - T 22:34 (geri 381)

Nový rekord! CVS commit.



19.7.2004

Vèera jsem zkoumal výskyt neprojektivity (pomocí ../neproj/neproj.pl) ve výstupech
jednotlivých parserù. Zjistil jsem, ¾e u mne se vyskytly v¹eho v¹udy dvì (kvùli
modelu n-tic, jinak by nebyly ¾ádné), u Tomových parserù kolem 200 (u jednoho a¾
1500) a u Zdeòkova pøes 2000 (to u¾ odpovídá jejich skuteènému poètu v testovacích
datech).

Souèasnì mì zaskoèilo zji¹tìní, ¾e jak Tomá¹, tak Zdenìk si nedìlají hlavu s tím,
zda jimi zplozená struktura je strom!

Dnes budu pøidávat neprojektivity do svého parseru. Zaèínám sbìrem rematizátorù
pro typ RHEM-PREP-cokoli. Kvùli zachování statistického pøístupu se chci mno¾inu
rematizátorù nauèit z trénovacích dat, nepídím se proto po seznamu, který urèitì
mají anotátoøi treebanku.

Budu také muset zjistit, zda se nìkteré rematizátory vyskytují v datech v podobné
konstelaci, ani¾ by byly zavì¹eny neprojektivnì na uzel za pøedlo¾kou.

Bohu¾el se to stává pomìrnì èasto. 48 rematizátorù se vyskytlo aspoò jednou jako
rematizátor a aspoò v 50% pøeva¾uje jejich zavì¹ení na uzel za pøedlo¾kou nad jinými
zavì¹eními; obvyklý podíl je v¹ak jen mezi 60 a 70%.

Dvì mo¾nosti: 1) natvrdo pøipojovat rematizátory za pøedlo¾ky. Vzhledem k vý¹e
uvedené statistice by to nemìlo mít moc velký úspìch. 2) pøi zmerèení rematizátoru
pouze udìlit výjimku ze zákazu neprojektivních hran. Model rozhodne, zda bude výjimka
vyu¾ita.

geri 383: pouze povolit, ale nevnucovat
G 94054 - P 74,6 - T 23:19 - Nový rekord!

Chtìlo by to zefektivnit a lépe spravovat (volitelné zapínání v konfiguraci), ale
to teï odkládám. Tak, jak to je, pøidávám neproj.pm do cvs + commit.

Infinitivy: jestli¾e infinitiv visí na svém levém sousedovi, v¹em uzlùm, které
mají povoleno zleva viset na tomto sousedovi, povolit také viset na infinitivu.

geri 384
G 94074 - P 74,6 - T 23:17 - Nový rekord!

Li a v¹ak: pouze povolíme jejich neprojektivní pøeskakování, zbytek a» u¾ si vyøe¹í
statistika.

geri 392
G 94080 - P 74,6 - T 23:57 - Nový rekord, i kdy¾ u¾ pomìrnì zanedbatelný. cvs commit



20.7.2004

Zaèíná masivní testování za úèelem získání závìreèných èísel do disertace.
Vypínám podmínìnou pravdìpodobnost, místo ní absolutní èetnost závislosti.

geri 394
G 90684 - P 72,0 - T 23:11

Pøidávám alternativní verzi funkce zjistit_povol(), která vedle komponentového
budování stromu umo¾ní také budování shora dolù. Pozor, zatím je dùsledkem vypnutí
kontroly projektivity, tak¾e výsledek bude asi stra¹ný.
geri 395
Zdá se, ¾e se výpoèet zacyklil u vìty 14. Parser asi bohu¾el poèítá s tím, ¾e závislosti
jsou povolovány urèitým zpùsobem, a teï nemám èas ho uèit nìco jiného. Zkusím je¹tì
funkci obohatit o kontrolu projektivity a kdy¾ to nepomù¾e, tak to zabalím. Ne,
balím to hned. Kontrola, ¾e funguje pùvodní nastavení (abscetnost=0, komponentove=1).
geri 400
G 93845 - P 74,5 - T 23:30
Je¹tì zùstaly vypnuté neprojektivity. Pøi této pøíle¾itosti je trochu umravním
a jejich zapínání pøesunu do parser.ini (zatím bylo nutné ho zakomentovat v genstav.pm).
Zru¹ím model neproj.pm (i z CVS) a v¹e pøesunu do povol.pm.
geri 407
G 94080 - P 74,6 - T 25:39 OK.

Redukce znaèek. Natrénovat model neredukovaných znaèek. Také se pokusit o redukci
zpùsobem pou¾ívaným v Modelu Jedna - nìkde mám pøibli¾ný pøeklad v¹ech znaèek.
freki 401 - trénuje s vypnutou redukcí znaèek
3 970 666 událostí - T 11:40
freki 408 - parse.pl nad 401 (i teï je pochopitelnì vypnutá redukce)
G 88351 - P 70,1 - T 26:37

Natrénovat model znaèek redukovaných baltimorskou metodou.
freki 410 - trénuje s baltimorskou redukcí
3 659 134 událostí - T 11:13
freki 411 - parse.pl nad 410 (zapnuta baltimorská redukce)
G 89535 - P 71,0 - T 26:02

Rùzná míra lexikalizace (ne té selektivní, ale lambda).
Opìt zapnout souèasnou redukci znaèek a pou¾ít statistiku 374.stat.
geri 412 - parse.pl: ls = 0.734375
G 94080 - P 74,6 - T 25:45
freki 413 - parse.pl: ls = 0
G 93090 - P 73,9 - T 40:21
freki 414 - parse.pl: ls = 1
G 69142 - P 54,9 - T 39:27

Selektivní lexikalizace.
geri 416 - train.pl: vypnutá selektivní lexikalizace
3 061 758 událostí - T 10:34
geri 418 - parse.pl nad 416.stat
G 91038 - P 72,2 - T 24:14

Je¹tì potøebujeme vypínat selektivní lexikalizaci jednotlivých slovních druhù
zvlá¹».
train geri 420 - bez pøedlo¾ek - T 11:40
  parse geri 426
  G 93904 - P 74,5 - T 31:33
train geri 421 - bez podøadících spojek - T 18:47
  parse geri 427
  G 93604 - P 74,3 - T 31:38
train geri 422 - bez zájmen - T 18:32
  parse freki 428
  G 93668 - P 74,3 - T 35:07
train freki 423 - bez vybraných pøíslovcí - T 17:17
  parse freki 429
  G 93487 - P 74,2 - T 34:42
train geri 432 - bez slovesa být - 3365461 událostí - T 11:01
  parse geri 433
  G 92235 - P 73,2 - T 24:40
train freki 425 - bez pseudovalence (tj. selektivní lexikalizace sloves) - T 17:12
  parse drak 431
  G 93987 - P 74,6 - T 24:05



21.7.2004

Dal¹í problém s pseudovalencí je na stranì 52. Jsou tam úspì¹nosti mìøené nejen
dávno, ale hlavnì jen na závislostech na slovesech (Sb|Obj|AuxT|Pnom|Adv). Vèera
jsem zjistil, ¾e na celkové úspì¹nosti se vypnutí pseudovalence na prvním desetinném
místì vùbec neprojeví (by» malý rozdíl v poètu správných závislostí existuje).

S vypnutou pseudovalencí (431.vysledky) to bylo 84,6 %.
Se zapnutou pseudovalencí (412.vysledky) to bylo 84,9 %.

Opìt poèítám normální úspì¹nost na v¹ech uzlech. Vyhodnocení pseudovalence u¾ máme
ovìøíme ji ale i v kombinaci s valencí0. Valenci0 také vyhodnotíme samostatnì.
Valenci1 u¾ kvùli èasovým nárokùm nebudeme znova testovat a zveøejníme èíslo zji¹tìné
posledním pokusem. Stejnì nebylo na celých datech.

Pro pseudoval=0 pou¾ít statistiku 425, pro pseudoval=1 pou¾ít 374.

pseudoval=0, valence=0 ... u¾ máme (bìh 431 vèera): G 93987 - P 74,6 - T 24:05 freki
pseudoval=0, valence=1 ... geri 434:                G 91866 - P 72,9 - T 24:51 geri
pseudoval=1, valence=0 ... freki 435:               G 91882 - P 72,9 - T 25:11 freki
pseudoval=1, valence=1 ... drak 436:                G 91882 - P 72,9 - T 24:46 drak
Toto¾ný výsledek na posledních dvou øádcích mi byl podezøelý, nìkolikrát jsem kontroloval
záznam nastavení, ale opravdu to bylo pu¹tìno správnì. A® NA TO, ®E BYLO VYPNUTO SELEX BÝT
OPRAVA:
pseudoval=0, valence=1 ... geri  437:               G 93987 - P 74,6 - T 24:21 geri
pseudoval=1, valence=0 ... freki 439:               G 94080 - P 74,6 - T 24:37 freki
pseudoval=1, valence=1 ... drak  438:               G 94080 - P 74,6 - T 25:17 drak
Teï u¾ výsledky nekolidují s døívìj¹ími zji¹tìními, ale je podezøelé, ¾e parametr
$konfig{valence} nemá na výsledky ¾ádný vliv. Ukazuje se, ¾e pøi pøestavbì genstav.pm
se úplnì vytratila podmínka, která se na tento parametr dívá. Podmínku vracím a
øádky s valence=0 testuju znova, mo¾ná se budeme divit.
pseudoval=0, valence=0 ... teï u¾ nemusí odpovídat vèerej¹ímu 431; geri 440: G 93987 P 74,6
pseudoval=1, valence=0 ... freki                                        441: G 94080 P 74,6
Inu, valence zøejmì trvá na svém, ¾e celkový výsledek nijak ovlivòovat nebude.

®árlivost. Pou¹tím trénink, který si u OZZ (a u nièeho jiného!) v¹ímá, zda na daném
rodièi visí je¹tì jiný uzel se stejnou znaèkou jako posuzované dítì.
train geri 442 - 3449293 událostí - T 11:29
parse geri 444 - G 81075 - P 64,3 - T 24:57

®árlivost opìt vypnuta, pro jistotu pou¹tím kontrolní bìh, který má zjistit, zda
opìt dosahujeme maximální známé úspì¹nosti G 94080 - P 74,6.
geri 445 - G 94080 - P 74,6 - T 24:21
Potvrzeno.

Zákaz pøeskakování sloves (definovaný souborem zakazy_preskoceni.txt). Vypínám ho
pøíznakem nepreskocv=0. Pøetrénování není nutné.
freki 446 - G 93914 - P 74,5 - T 22:27

Plodnost se zatím zapínala a vypínala natvrdo v kódu. Pøedìlávám ji tak, aby se
dala zapnout v konfiguraèním souboru a navíc aby se dalo vybrat ze tøí pøístupù
popsaných v disertaci (FFM, TFM a QFM). Statistika plodnosti není pøímou souèástí
hlavní statistiky, ale ète se ze zvlá¹tního souboru plodnost.txt. Proto pøepínaè
umis»uju mezi parametry, jejich¾ zmìna nevy¾aduje pøetrénování.

ffm - geri 447   - G 93852 - P 74,5 - T 25:26
tfm - freki 448  - G 93292 - P 74,0 - T 24:27
qfm - drak 449   - G 93315 - P 74,0 - T 24:22
nic - sakura 450 - G 94080 - P 74,6 - T 31:27

Experimenty se vzdáleností.
1: Vzdálenost v ¾ádné podobì není parametrem pro váhu závislosti.
2: Parametrem je, zda øídící a závislý spolu sousedí (standard Modelu Jedna).
3: Tøetí stav - výskyt èárky mezi øídícím a závislým. Nyní je parametrem B/D/,.
4: Jako 3, ale váha závislosti se navíc dìlí vzdáleností mezi obìma uzly.
Nejdøíve je tøeba natrénovat modely pro 1 a 2. Pro 3 u¾ natrénováno máme a 4 trénování nevy¾aduje.

1: train geri 451  - 3283615 událostí - T 10:42
   parse geri 456  - G 91200 - P 72,4 - T 24:08
2: train freki 452 - 3418129 událostí - T 10:41
   parse freki 457 - G 91926 - P 72,9 - T 24:32
3: 374.stat
   parse drak 453  - G 94032 - P 74,6 - T 23:38
4: 374.stat
   známý výsledek  - G 94080 - P 74,6

Koordinace. Nejdøíve kontrolní bìh, ¾e je opìt úspì¹nost na maximu.
parse geri 458  - G 94080 - P 74,6 - T 24:34
Teï prostì zkusím koordinace=0 v parser.ini. Je tam napsáno, ¾e se musí pøetrénovat,
to¾ pøetrénujem.
train freki 459 - 3390516 událostí - T 23:02
parse freki 460 - G 92267 - P 73,2 - T 22:35



22.7.2004

Krátké vìty. Zatím se nedají vypínat a zapínat. Zaøadím pøepínaè do sekce nevy¾adující
pøetrénování, proto¾e pøi pøetrénování se potøebné statistiky sbírají ka¾dopádnì.
geri 461 - G 93838 - P 74,5

N-tice. Podobnì jako krátké vìty dosud nebyly volitelné, teï budou.
geri 462 - G 92556 - P 73,4
Chyba, souèasnì zùstaly vypnuté i krátké vìty! Znova!
geri 463 - G 93054 - P 73,8

Pevná omezení.

Pøipojování koncové interpunkce ke koøeni.
freki 464 - G 91339 - 72,5

Závislosti na koøeni nerozli¹ují smìr, ale zato kontrolují pøítomnost slovesa ve
vìtì. Pozor, pøi zmìnì tohoto pøepínaèe se musí pøetrénovat!
train geri 465 - 3445058 událostí
parse geri 466 - G 94027 - P 74,6



23.7.2004

Plodnost koøenu nesmí být vìt¹í ne¾ 2.
parse geri 468 - G 93725 - P 74,4

Právì jedna vnìj¹í závislost do úseku mezi dvìma èárkami.
parse geri 469 - G 93545 - P 74,2

Na èárce nesmí viset nic.
parse geri 470 - G 93923 - P 74,5

Zákaz pøeskakování bezdìtných pøedlo¾ek.
parse geri 471 - G 94024 - P 74,6

Zákaz pøeskakování podstatných jmen v genitivu.
parse geri 472 - G 94112 - P 74,7
Wow! Tak¾e pøesto¾e to kdysi pomáhalo, teï je naopak lep¹í to vypnout!
cvs commit
Pøedcházející pokusy u¾ pøepoèítávat nebudu, akorát v¹ude, kde v disertaci mluvím
o závìreèné úspì¹nosti, zmìním 74,6 na 74,7.

Zvlá¹tní zpracování vzta¾ných vìt se zájmenem "který".
parse geri 473 - G 93967 - P 74,6
V d-test datech se 801-krát vyskytuje tvar zájmena "který".
1160-krát se parser ptal na nìkterou závislost, která pøes "který" mìla vést (na nìkteré
se mohl ptát opakovanì a pøes nìkteré výskyty "který" mohlo vést nìkolik potenciálních
závislostí, zejména proto¾e pøed zájmenem le¾elo nìkolik podstatných jmen. 483-krát
se nakonec pravidlo aplikovalo a závislost byla pøijata; z toho 389x správnì. To
dává úspì¹nost pravidla 80,5 %.

Vypnutí v¹ech vypínatelných vlastností Modelu Dva najednou:
vztaz = 0
nepreskocg = 0 (má být nyní vypnuto i ve finální verzi)
predlozky = 0
carka_je_list = 0
mezicarkove_useky = 0
koren_2_deti = 0
pod_korenem_sloveso_misto_smeru = 0
koncint = 0
----- tady konèí pevná omezení
ntice = 0
krvety = 0
koordinace = 0
vzdalenost = 0
vzdalenost_delitel = 0
... plodnost zùstává vypnutá stejnì jako ve finální verzi
nepreskocv = 0
selex = 0
pseudoval = 0
upravovat_mzn = 0 (místo 2)
abscetnost = 1 (místo 0)
neselektivní lexikalizace zùstala na lambda = 0.734375

Musíme pøetrénovat, pak teprv testy!
train geri 474 - 3459989 událostí - T 9:10
parse geri 475 - G 71160 - P 56,5 - T 13:29 (!)

Teï zase v¹e zapnout, a¾ na pevná omezení.
I tak se to musí pøetrénovat a nemù¾e se pou¾ít 374.stat, proto¾e za pevné omezení
pova¾uju i to, ¾e se pøi trénování pod koøenem místo smìru kouká na pøítomnost slovesa.
train geri 477 - 3445058 událostí - T 11:03
parse geri 478 - G 91177 - P 72,3 - T 21:57



Rychle ovìøit, ¾e po opìtovném zapnutí v¹ech úspì¹ných vylep¹ení a pøepnutí na 374.stat
se úspì¹nost vrátí k rekordní hodnotì.
parse geri 479

dtest data 0.5 (bez pøetrénování na 0.5!)
parse geri 484 - G 46505 - B 17213 - P 73,0
etest data 0.5 (bez pøetrénování na 0.5!)
parse geri 485 - G 47653 - B 17737 - P 72,9

Pøetrénovávám podle trénovacích dat z Baltimoru.
train geri 486 - 1218787 událostí - T 2:45
parse geri 488 dtest - G 45299 - P 71,1
parse geri 487 etest - G 46504 - P 71,1

ETEST 1.0 (s maximálním výkonem a 374.stat)!!!
A 125713 - G 94121 - B 31592 - P 74,9



24.7.2004

Natrénovat na rùzných zdrojích morfologie. Bohu¾el se to nebude týkat vedlej¹ích
statistik, jako jsou n-tice, krátké vìty èi zákazy pøeskakování sloves. Nemám u¾
èas, abych to dotáhl do konce. Pokud se ale potvrdí, ¾e nejlépe to funguje na
statistice z taggeru, nebude ¾ádné dotahování do konce nutné.

human
  train geri 491  - 3397730 událostí - T 10:56
tagger a
  u¾ hotovo (374) - 3448365 událostí
tagger b
  train geri 492  - 5238005 událostí - T 11:27
dictionary
  train freki 493 - 6394663 událostí - T 27:12

Je docela divné, o kolik více událostí se objeví pøi pou¾ití taggeru b oproti taggeru
a. Teï probìhne parsing. Nejdøív ka¾dý na svém, "human" vynecháváme, proto¾e bychom
ho museli testovat na jiných datech.

tagger a - tagger a (374.stat)
  u¾ hotovo (472): G 94112 - P 74,7
tagger b - tagger b (492.stat)
  geri 495
dictionary - dictionary (493.stat)
  freki 496

human    - tagger a
human    - tagger b

Parsing nad 493.stat (nezjednoznaènìná morfologie) spadl na nedostatku pamìti.
Nejdøív ze statistiky vyházím vìci, které se u¾ léta trénují jen ze zvìdavosti,
konkrétnì události typu RAM, OSZ, OZS, ZZZ, ZSZ, ZZS, ZSS. Tím se statistika zmen¹í,
potom se ale asi stejnì bude muset zkoumat, co je pøi výmìnì morfologického zdroje
¹patnì.

MM ad train geri 497.stat - 2875424 událostí (97 MB) - T 20:14
MD a  parse geri 505 - G 91949 - P 73,0

MM ad parse geri
Nìkde se ztrácí pamì»! Po naètení statistiky do parseru má proces jen 400 MB,
ale pak se klidnì vy¹plhá na 2 GB a spadne!



1.8.2004

Pøeprogramoval jsem rozepisování alternativ jiným zpùsobem a pøestala se ztrácet
pamì».

MM ad train i parse - G 85754 - P 68,0 - T 47:22 - geri 524

Problém je, ¾e pøi trénování se zøejmì alternativy rozepisovaly ¹patnì. Proto upravím
train.pl, aby pou¾íval tuté¾ funkci, a pustím trénink je¹tì jednou.

train geri 526 - 2872481 událostí (96 MB) - T 33:20
parse geri 527 - G 85460 - P 67,8 - T 47:29

Druhá verze: nejednoznaèná morfologie, ale bez rozepisování alternativ (tj. øetìzec
znaèek se pova¾uje za jedinou znaèku).

train geri 528 - 1774510 událostí (55 MB) - T 9:09
parse geri 529 - G 89553 - P 71,1 - T 21:23

DOSUD ZJI©TÌNO:
526+527: G 85460 - P 67,8 - T 47:29 - oba MM ad rozepsanì
528+529: G 89553 - P 71,1 - T 21:23 - oba MM ad nerozepsanì
374+472: G 94112 - P 74,7 - T 24:21 - oba MD a

Teï znova natrénujeme podle MD b.

train geri 530 - 2379504 událostí (56 MB) - T 7:41
parse geri 531

Prùbì¾ná úspì¹nost je opìt dìsivì nízká, jak to?
Regulární výraz pro <MDt src="b"> chytal úplné nesmysly. Je nutné pøetrénovat.

train geri 534 - 1381009 událostí (34 MB) - T 7:30
parse geri 535 - G 93920 - P 74,5 - T 23:46

Nové nastudování MD a:

train geri 536 - 1379879 událostí (33 MB) - T 7:44
parse geri 537 - G 93840 - P 74,5 - T 22:35
GRRR!!!
Jak to, ¾e to není toto¾né s 374+472?
Zapínám rozepisování alternativ (mo¾ná se stopovì vyskytlo i u MD?), pou¾ívám 374.stat.
parse geri 538 - G 93721 - P 74,4 - T 40:47



2.8.2004

Tak¾e znova. Zru¹íme souèasný zpùsob rozepisování, zapneme ten pùvodní (i kdy¾
si myslím, ¾e je chybný). A pou¾ijeme 374.stat a MD a.

parse geri 539 - G 93721 - P 74,4 :-(( - T 26:11

Bez ohledu na výsledek pátrání po pùvodním optimu budu vyplòovat ostatní buòky
tabulky. Jejich odchylky od hodnot, které bych dostal, kdybych znal a odstranil
pøíèinu problému s optimem, by pravdìpodobnì byly zanedbatelné.

MM ad + MD a, tj. nastavit zdroj na MD a a statistiku na 526.stat. Rozepisování
alternativ opìt vypnout kvùli èasovým nárokùm.

parse freki 541 - G 91866 - P 72,9 - T 26:43

MM ad + MD b, tj. nastavit zdroj na MD b a statistiku na 526.stat. Rozepisování
alternativ vypnout kvùli èasovým nárokùm.

parse geri 542 - G 91964 - P 73,0 - T 29:42

MD a + MM ad, tj. nastavit zdroj na MM ad, zapnout rozepisování alternativ, pøepnout
na statistiku 536.stat.

parse freki 543 - G 87236 - P 69,2 - T 48:52

MD a + MD b, tj. nastavit zdroj na MD b, vypnout rozepisování alternativ, pøepnout
na statistiku 536.stat.

parse belzebub 544 - G 93900 - P 74,5 - T 24:45

MD b + MM ad, tj. nastavit zdroj na MM ad, zapnout rozepisování alternativ, pøepnout
na statistiku 534.stat.

parse drak 545 - G 87237 - P 69,2 - T 46:50

MD b + MD a, tj. nastavit zdroj na MD a, vypnout rozepisování alternativ, pøepnout
na statistiku 534.stat.

parse geri 546 - G 93743 - 74,4 - T 29:04

human: Nejdøíve je potøeba natrénovat statistiku.

train loki 547 - 1354520 událostí (33 MB) - T 13:31

human + MM ad, tj. nastavit zdroj na MM ad, zapnout rozepisování alternativ, pøepnout
na statistiku 547.stat.

parse geri 548 - G 87239 - P 69,2 - T 46:39

human + MD a, tj. nastavit zdroj na MD a, vypnout rozepisování alternativ, pøepnout
na statistiku 547.stat.

parse geri 549 - G 93188 - P 73,9 - T 23:41

human + MD b, tj. nastavit zdroj na MD b, vypnout rozepisování alternativ, pøepnout
na statistiku 547.stat.

parse freki 550 - G 93296 - P 74,0 - T 23:12

DOSUD ZJI©TÌNO:

MM ne + MM ne = 528+529: G 89553 - P 71,1 - T 21:23 (ne znamená nerozepsanì)
MM ad + MM ad = 526+527: G 85460 - P 67,8 - T 47:29
MM ad + MD a  = 526+541: G 91866 - P 72,9 - T 26:43
MM ad + MD b  = 526+542: G 91964 - P 73,0 - T 29:42
MD a  + MM ad = 536+543: G 87236 - P 69,2 - T 48:52
MD a  + MD a  = 374+472: G 94112 - P 74,7 - T 24:21 (mìlo by být toté¾ jako 536+537, ale není, chybu neznám)
MD a  + MD b  = 536+544: G 93900 - P 74,5 - T 24:45
MD b  + MM ad = 534+545: G 87237 - P 69,2 - T 46:50
MD b  + MD a  = 534+546: G 93743 - P 74,4 - T 29:04
MD b  + MD b  = 534+535: G 93920 - P 74,5 - T 23:46
human + MM ad = 547+548: G 87239 - P 69,2 - T 46:39
human + MD a  = 547+549: G 93188 - P 73,9 - T 23:41
human + MD b  = 547+550: G 93296 - P 74,0 - T 23:12



3.8.2004

cvs tag rel-3-4, aby se dala snadno rozbalit dosud nejlep¹í verze parseru. Souèasná
verze sice na rozdíl od ní umí lépe rozepisovat alternativy, ale zatím je to za
cenu poklesu úspì¹nosti. Na hledání chyby teï nemám èas, musím ho odlo¾it.

Souèasnou verzi kopíruju do zálo¾ní slo¾ky a pøes ni rozbaluju rel-3-4. Pou¹tím
pokusný bìh, který má ovìøit, ¾e jsme se opravdu vrátili k úspì¹nosti 74,7 % (G 94112).

parse geri 551 - G 94112 - P 74,7 - T 24:53

Pro jistotu do CVS ukládám i novìj¹í verzi (správné rozepisování, ni¾¹í úspì¹nost).
Ihned ji také taguji, aby se dala samostatnì rozbalit.
cvs commit
cvs tag rel-3-4b

cvs commit, aby se uchovala verze, která umí správnì rozepisovat alternativy. Pak
se v¹ak musím vrátit k optimální verzi co do úspì¹nosti, abych mohl pokraèovat
v pokusech pro disertaci.

Zjistit úspì¹nost na vìtách, a to jak celkovou, tak na vìtách jednotlivých délek.
Upravuju parse.pl. Pøidávám do nìj taky jedinou zmìnu, kterou mìla jeho rel-3-4b
oproti rel-3-4 - v tomto pøípadì by toti¾ nemìla mít opravdu ¾ádný vliv na úspì¹nost.

parse geri 552 - G 94112 - P 74,7
7319 vìt, z toho 1539 stoprocentních, tj. vìtná úspì¹nost 21,0 %.
126030 slov, z toho 10716 ve stoprocentních vìtách, tj. vá¾ená vìtná úspì¹nost 32,1 %.
Podle délky vìt:
délka - vìt - správných - úspì¹nost
 1  55  55 100,0
 2 199 198  99,5
 3 151 122  80,8
 4 209 148  70,8
 5 274 196  71,5
 6 220 118  53,6
 7 276 128  46,4
 8 248  93  37,5
 9 267  98  36,7
10 313  85  27,2
11 282  64  22,7
12 289  50  17,3
13 289  48  16,6
14 297  29   9,8
15 280  31  11,1
16 262  16   6,1
17 273  11   4,0
18 275  14   5,1
19 249  10   4,0
20 231   6   2,6
21 218   6   2,8
22 198   4   2,0
23 193   3   1,6
24 183   2   1,1
25 162   2   1,2
30 101   1   1,0
32  70   1   1,4

Je¹tì zji¹»uju aktuální SLOVNÍ úspì¹nost na rùznì dlouhých vìtách.

parse geri 557

Úspì¹nost vá¾ená obtí¾ností (opìt celková i na vìtách urèité délky).

parse geri 559
VAZENO OBTIZNOSTI: A 118711 - G 88372.7251405133 - P 0.744435858012427
D   2 - N   99 - A    199 - G    198 - P  99.5
D   3 - N  100 - A    302 - G    275 - P  91.2
D   4 - N  156 - A    627 - G    553 - P  88.3
D   5 - N  219 - A   1096 - G    978 - P  89.3
D   6 - N  183 - A   1100 - G    926 - P  84.2
D   7 - N  236 - A   1656 - G   1381 - P  83.4
D   8 - N  217 - A   1736 - G   1444 - P  83.2
D   9 - N  237 - A   2136 - G   1757 - P  82.3
D  10 - N  281 - A   2817 - G   2276 - P  80.8
D  11 - N  256 - A   2820 - G   2244 - P  79.6
D  12 - N  264 - A   3179 - G   2536 - P  79.8
D  13 - N  266 - A   3468 - G   2772 - P  79.9
D  14 - N  275 - A   3861 - G   2993 - P  77.5
D  15 - N  261 - A   3920 - G   3056 - P  78.0
D  16 - N  245 - A   3930 - G   2955 - P  75.2
D  17 - N  256 - A   4368 - G   3314 - P  75.9
D  18 - N  259 - A   4675 - G   3573 - P  76.4
D  19 - N  235 - A   4482 - G   3378 - P  75.4
D  20 - N  219 - A   4389 - G   3286 - P  74.9
D  21 - N  207 - A   4360 - G   3277 - P  75.2
D  22 - N  189 - A   4158 - G   3000 - P  72.2
D  23 - N  184 - A   4246 - G   3149 - P  74.2
D  24 - N  175 - A   4209 - G   3146 - P  74.7
D  25 - N  155 - A   3888 - G   2872 - P  73.9
D  26 - N  147 - A   3825 - G   2769 - P  72.4
D  27 - N  149 - A   4030 - G   2880 - P  71.5
D  28 - N  117 - A   3294 - G   2464 - P  74.8
D  29 - N  115 - A   3360 - G   2448 - P  72.9
D  30 - N   97 - A   2929 - G   2100 - P  71.7
D  31 - N   69 - A   2160 - G   1536 - P  71.1
D  32 - N   67 - A   2170 - G   1546 - P  71.2
D  33 - N   70 - A   2336 - G   1699 - P  72.8
D  34 - N   57 - A   1947 - G   1345 - P  69.1
D  35 - N   49 - A   1734 - G   1195 - P  69.0
D  36 - N   43 - A   1575 - G   1085 - P  68.9
D  37 - N   37 - A   1404 - G    962 - P  68.5
D  38 - N   34 - A   1295 - G    913 - P  70.5
D  39 - N   38 - A   1482 - G   1045 - P  70.5
D  40 - N   36 - A   1443 - G    991 - P  68.7
D  41 - N   24 - A   1000 - G    713 - P  71.3
D  42 - N   23 - A    984 - G    647 - P  65.8
D  43 - N   24 - A   1050 - G    726 - P  69.2
D  44 - N   17 - A    774 - G    522 - P  67.6
D  45 - N   19 - A    880 - G    606 - P  68.9
D  46 - N   15 - A    720 - G    483 - P  67.1
D  47 - N   12 - A    598 - G    422 - P  70.7
D  48 - N   16 - A    799 - G    558 - P  69.9
D  49 - N   12 - A    624 - G    429 - P  68.8
D  50 - N   13 - A    686 - G    457 - P  66.7
D  51 - N    9 - A    500 - G    332 - P  66.5
D  52 - N    5 - A    306 - G    206 - P  67.6
D  53 - N    8 - A    468 - G    301 - P  64.4
D  54 - N    4 - A    265 - G    184 - P  69.6
D  55 - N    2 - A    162 - G    118 - P  73.3
D  56 - N    5 - A    330 - G    231 - P  70.2
D  57 - N    4 - A    280 - G    125 - P  44.9
D  58 - N    2 - A    171 - G     89 - P  52.3
D  59 - N    0 - A     58 - G     35 - P  61.0
D  60 - N    3 - A    236 - G    157 - P  66.7
D  61 - N    1 - A    120 - G     67 - P  56.6
D  62 - N    0 - A     61 - G     30 - P  50.0
D  63 - N    2 - A    186 - G    101 - P  54.5
D  64 - N    1 - A    126 - G     84 - P  67.2
D  65 - N    0 - A     64 - G     29 - P  46.2
D  66 - N    0 - A     65 - G     40 - P  62.1
D  68 - N    1 - A    134 - G     76 - P  57.4
D  70 - N    0 - A     69 - G     45 - P  65.7
D  72 - N    0 - A     71 - G     41 - P  58.3
D  73 - N    0 - A     72 - G     39 - P  54.8
D  74 - N    0 - A     73 - G     51 - P  70.3
D  75 - N    0 - A     74 - G     30 - P  41.3
D 100 - N    0 - A     99 - G     49 - P  50.0
Výpoèet skonèil v 17:03:52.
Program bìµel 00:24:22 hodin.



4.8.2004

Zji¹»uju, jaká bude úspì¹nost, kdy¾ vynechám závislosti, které byly vidìt ménì
ne¾ pìtkrát (tzv. experiment 1 v disertaci). A jaká bude pøesnost a úplnost.

parse geri 562

Navíc pøidávám jako alternativní závislosti, které dosahují alespoò 90% váhy vítìzné
závislosti. Proto¾e to vy¾aduje generovat v¹echny stavy a bude to trvat mnohem déle,
pou¹tím to ihned. Je¹tì bych mìl vymyslet, jak se zjistí P+R obou pokusù najednou.
Z èasových dùvodù se na to ale asi vyka¹lu úplnì.

parse geri 563 - AA 126030 - A 133500 - G 95622 - P 71,6 - R 75,9 - F 73,7

Pou¹tím test, který dodá úspì¹nost rozdìlenou podle vzorových s-znaèek (afunù).

parse freki 564; výsledky viz disertace, èást 13.5.

Chystám trénink na men¹ích datech.

1000 vìt: train geri 566
  parse freki 570 - A 126030 - G 84202 - B 41828 - P 0.668110767277632 - T 33:13
10000:    train freki 567
  parse freki 571 - A 126030 - G 90130 - B 35900 - P 0.715147187177656 - T 33:05
25000:    train freki 568
  parse geri 572  - A 126030 - G 92499 - B 33531 - P 0.733944298976434 - T 38:08
50000:    train geri 569
  parse geri 573  - A 126030 - G 93623 - B 32407 - P 0.742862810441958 - T 38:35



Nyní parsing na umìle zmen¹eném modelu (tj. pou¾ijeme 374.stat, ale vyházíme z nìj
v¹echny události vidìné N-krát).

N<1:  3351830 ud, 574.stat, 73 MB, parse freki 579 - G 94112 - P 74,7 - T 24:42
N<=1:  944195 ud, 575.stat, 20 MB, parse freki 580 - G 93802 - P 74,4 - T 24:19
N<=2:  538557 ud, 576.stat, 11 MB, parse geri 581  - G 93638 - P 74,3 - T 24:27
N<=5:  238984 ud, 577.stat,  5 MB, parse geri 582  - G 93159 - P 73,9 - T 24:14
N<=10: 123386 ud, 578.stat,  2 MB, parse drak 583  - G 92595 - P 73,5 - T 23:19

Trénuju výhradnì na Lidových novinách. 865 souborù.
train geri 584, 698671 slov, pøes 39900 vìt, NEVYPSALA SE ®ÁDNÁ STATISTIKA!
train geri 600, 865 souborù, 39978 vìt, 698671 slov, 2187990 událostí, 48 MB, T 6:00
parse geri 601 - G 93534 - P 74.2 - T 24:30

Pro srovnání potøebujeme trénovací sadu, ve které bude stejný nebo témìø stejný
poèet vìt, ale ze v¹ech zdrojù, pokud mo¾no ve stejném pomìru, v jakém se podílejí
na celých trénovacích datech. Celkem máme 73088 vìt, chceme vybrat 39978 vìt.
Vezmeme tedy ka¾dý (73088/39978)-tý, tj. ka¾dý 1,83-tý soubor.

train freki 602, 864 souborù, 39687 vìt, 679665 slov, 2171319 událostí, 48 MB, T 5:55
parse geri 603 - G 93392 - P 74,1 - T 24:43

Zjistit, jak se od sebe li¹í úspì¹nost jednotlivých blokù testovacích dat o 100
vìtách. Pou¹tím zase klasický parsing se 374.stat, akorát na konci se vypí¹e zvlá¹»
úspì¹nost blokù.

parse geri 605

Výsledky:
minimum 67,7 %
maximum 82,2 %
Prùbì¾ný stav 77 % po 1000 testovacích vìtách!
Pøi správném seøazení se dá najít 12 blokù, jejich¾ celková úspì¹nost je 80,1 %.
Obdobnì nejhor¹ích 12 blokù má dohromady 69,8 %.

Tak je¹tì poslední sada testù. Trénuju s vynecháním vìt obsahujících ExD.
train geri 610 - 53594 vìt - 974838 slov - ALE KURVA NENÍ TAM POSLEDNÍ VÌTA!!! - T 8:17
train geri 613 - 53595 vìt - 974841 slov - 2837809 událostí - 63 MB - T 12:41
parse geri 621 - A 99094 - G 75418 - P 76.1 - T 18:07

Trénuju s vynecháním vìt obsahujících Coord nebo Apos.
train freki 612 - T 5:56
train geri 614 - 36261 vìt - 422292 slov - 1507160 událostí - 32 MB - T 9:29
parse geri 618 - A 41598 - G 34456 - P 82,8

Trénuju s vynecháním vìt obsahujících ExD, Coord nebo Apos.
train freki 611 - T 5:43
train freki 615 - 25970 vìt - 354784 slov - 1323832 událostí - 28 MB - T 5:29
parse freki 622 - A 36116 - G 29959 - P 83,0 - T 6:07



6.8.2004

Potøebuju nové srovnání 7 parserù, kde bude za mùj parser pou¾ita jeho nejnovìj¹í
verze (G 94112 P 74,7). Napø. 552.csts.

We cannot use standard test data because we need held-out data to learn which parser specializes in what. PDT 1.0 d-test data contain 153 files. We keep the first 76 files for testing. The remaining 77 files will be used as held-out data. lv28.csts is the 76th file. The first sentence of lv29.csts is labeled ln94207:76-p3s14 but there are no labels in vse1.csts. The sentence begins with: Celník mi øekl: A» vám ty kvìtiny nikdy nezvadnou a opice a» se u vás furt usmívá Here begins vseb.csts (held-out data). The first part is vsea.csts (new test data).
New tests: vsea.csts contains 62677 words
ec on vsea.csts: G 53275 - P 85.0 %
mc on vsea.csts: G 52233 - P 83.3 %
z¾ on vsea.csts: G 47729 - P 76.2 %
dz on vsea.csts: G 47335 - P 75.5 %
th(r2l) on vsea.csts: G 45331 - P 72.3 %
th(l2r) on vsea.csts: G 44063 - P 70.3 %
th(pshrt) on vsea.csts: G 39806 - P 63.5 %
all parsers: G 27817 - P 44.4 %
at least one parser: G 60255 - P 96.1 %
absolute majority or ec: G 53761 - P 85.8 %
absolute majority P+R: G 49277 - left-out 8352 - P 90.7 - R 78.6 - F 84.2
tips: - for all parsers number of times they contribute whenever ec is wrong; - voting where ec has 3 votes, mc 2 votes, others 1 vote each.
Now the same for three parsers (ec, mc, dz).
All parsers: G 42090 - P 67.2 %
At least one parser: G 58126 - P 92.7 %
Absolute majority P+R: G 52627 - O 3890 - P 89.5 - R 84.0 - F 86.7 J
Absolute majority or ec: G 54044 - P 86.2 %

A teï vezmeme vseb.csts a zjistíme trojice mzn-záv/mzn-øíï-ec/mzn-øíï-mc+dz, pøi
nich¾ má pravdu èastìji mc+dz ne¾ ec (>50%).

A 62669 (JAK TO?) - G 53821 - P 85,9

Dal¹í mo¾nosti:
1. Po¾adovat vy¹¹í úspì¹nost jednotlivých trojic (75%, 90%...)
2. Zkusit jen dvojice mzn-záv/mzn-øíï-ec.
3. Zkusit jen dvojice mzn-záv/mzn-øíï-mc+dz.
4. Zkusit znova trojice i dvojice, ale jen slovní druhy bez pádù.
5. Naopak zkusit kompletní úpravu znaèek, nejen tu zjednodu¹enou popsanou vý¹e.

Na celých upravených znaèkách, mc+dz proti ec.
A 62677 - G 53561 - P 85,5

Zvý¹en po¾adavek na alespoò 2 výskyty, pøes 50%.
A 62677 - G 53458 - P 85,3

Zvý¹en po¾adavek na alespoò 2 výskyty, pøes 75% (90% ani nemá smysl, to se skoro nevyskytuje).
A 62677 - G 53392 - P 85,2
Výtah z pøedních míst seznamu:
N1#Z,        9       9  1.000000
PseJ^Vp      8       8  1.000000
NY2N2N2      6       6  1.000000
A6Rv-1N6         6       6  1.000000
...
N6Rs-1Rv-1       6       7  0.857143
VBZ,Jµe      6       7  0.857143
N4VBVf       6       7  0.857143
N1J^Vp      32      39  0.820513
A1VpN1       8      10  0.800000
N6VBRv-1         4       5  0.800000
A4J^N4      11      14  0.785714

Opìt uvolnìno na aspoò 1 výskyt, pøes 50 %. Místo trojic se uva¾ují dvojice (øídící od Charniaka).
A 62677 - G 53768 - P 85,8

Místo trojic dvojice jako u pøedcházejícího pokusu, ale místo od Charniaka se øídící bere od MC+DZ.
A 62677 - G 53853 - P 85,9 !!!

Místo úplných upravených znaèek brát jen slovní druh a pád.
A 62677 - G 53963 - P 86,1 !!!

Toté¾, ale nyní nesoutì¾í MC+DZ proti EC, nýbr¾ DZ proti EC i MC (ti se nemusejí shodovat).
A 62677 - G 53271 - P 85,0 (dokonce o 4 závislosti hor¹í ne¾ EC sám)

Toté¾, ale nyní se EC musí shodovat s MC.
A 62677 - G 53268 - P 85,0 (je¹tì o dal¹í 3 závislosti hor¹í)

Vrátit se k tomu, ¾e soutì¾í MC+DZ proti EC. Zkusit je¹tì samotné slovní druhy bez
pádù.
A 62677 - G 53999 - P 86,2 !!! to u¾ se koneènì blí¾í k tomu, co dokázalo bezkontextové hlasování :-(

Bezkontextové hlasování (MC+DZ mù¾e pøehlasovat EC v¾dycky, EC má pøednost pouze
kdy¾ má ka¾dý parser vlastní názor).
A 62677 - G 54044 - P 86,2 !!!

Je¹tì zkusíme popis souboje obrátit, ale mìlo by to snad být toté¾ co pøedtím.
Tedy: uèíme se, kdy mù¾e EC zvítìzit, i kdy¾ je ve sporu s MC a DZ, kteøí se shodují.
Rodièe zji¹»ujeme podle názoru EC. Øídící znaèka je úplnì upravená, závislá jen
slovní druh.
A 62677 - G 54058 - P 86,2 !!!

Toté¾, ale obì znaèky jsou jen slovní druh.
A 62677 - G 54078 - P 86,3 !!!

Toté¾, ale obì znaèky jsou úplnì upravené.
A 62677 - G 54090 - P 86,3 !!!



Je¹tì by stálo za to vìdìt, kdy má vyhrat Collins místo Charniaka, kdy¾ v¹ichni
3 máme svùj vlastní názor. Ale teï u¾ to nestíhám vyzkou¹et.
tips: - for all parsers number of times they contribute whenever ec is wrong;
 - voting where ec has 3 votes, mc 2 votes, others 1 vote each.
Use weights produced by some parsers (dz, th). Look at z¾ if it used the "last rule" for that constituent.
Ze sekce 13.5 jasnì vyplývá, ¾e neumím koordinace a apozice. Schválnì, jestli mi model nìkdy dovolí pøehlasovat Charniaka v závislosti èehokoli na J^ nebo Z,.

Roz¹íøit zkoumání kontextu tak, ¾e pro libovolnou kombinaci názorù a znaèek budeme
schopni øíct, v kolika procentech se stalo, ¾e nìkterá skupina parserù mìla pravdu.
Stihnout to je¹tì pøidat do koneèné verze disertace!



Udìlat cvs commit kvùli pøidanému vyhodnoceni.pm! Nebude to taková sranda, ono
se to toti¾ brání, ¾e prý souèasná verze není up-to-date!



Urgentnì po dopsání disertace: Ulo¾it do CVS novìj¹í verzi parseru (zejména
train.pl a model.pm), která umí správnì rozepisovat varianty. Vyvolat z CVS
star¹í verzi, která umìla dosáhnout maxima 74,7 % na MDa+MDa. Odladit, najít
chybu a slouèit obì verze.



###############################################################################
Nápady:
- Do zpracování neprojektivit pøidat neprojektivity koncové interpunkce
  v uzávorkovaných vìtách.
- jiný pøístup k zákazu pøeskokù: pøi trénování si u ka¾dé závislosti pamatovat,
  zda pøeskoèila sloveso
- 25.5.2004: train.pl: Ve funkci spocitat_lokalni_konflikty() se pou¾ívá pole
  @rodic, které ale pøi tréninku vùbec neexistuje! Asi je to omyl, je tam toti¾
  vìtev if a else, v jedné z nich je pou¾it @rodic a ve druhé $anot->[]{rodic_vzor}.
  Bohu¾el to nemù¾u teï hned opravit a podívat se, co to udìlá s úspì¹ností, proto¾e
  momentálnì krok za krokem upravuju train.pl, aby mohl pou¾ívat nové knihovny
  a pøitom produkoval poøád TUTÉ® statistiku.
- 14.5.2004: genstav.pm: Dokonèování koordinací by se mìlo øídit systémem zákazù.
- 26.3.2004: DTEST: 16329 sloves v 7319 vìtách, tedy 2,23 slovesa na
  vìtu (vèetnì tvarù pomocného slovesa být).
  OSNOVA KAPITOLY O SUBKATEGORIZACI
  - Vysvìtlit subkategorizaci.
  - Vysvìtlit, proè mù¾e pomoci pøi parsingu.
    - SLÍBIL JSEM, ®E V KAPITOLE 9 UKÁ®U, JAK ZÍSKAT SEZNAM.
  - Tabulka typických argumentù (> 50 % výskytù)
    POZOR, ASI ÚPLNÌ IGNORUJU VÝSKYTY, KDY DANÝ ÈLEN VISÍ NA NÌÈEM
    JINÉM NE® NA SLOVESE.
  - ®árlivá slova, tabulky.
    CHTÌLO BY TO PLYNULEJ©Í PØECHOD K ®ÁRLIVOSTI. VYSVÌTLIT, PROÈ SE
    TÍM ZABÝVÁM.
  - Odhalení, ¾e je vlastnì dost málo chyb, s jejich¾ odstranìním to
    mù¾e pomoci, by mìlo pøijít a¾ na konec, spí¹ jako výsledek
    pátrání, proè subkategorizace nenese velké ovoce. Aby bylo do té
    doby o èem psát.
  ---
  - Jak èasto slovesu nìco chybí? 8583 (6,8 %).
  - Jak èasto slovesu nìco pøebývá?
  - Jak èasto jsou na slovese zavì¹eny vzájemnì nekompatibilní vìci?
  ---
  Vf ... infinitiv
  VB ... pøítomný èas
  Vp ... pøíèestí minulé
  Vs ... pøíèestí trpné
  Nejèastìj¹í pøípad: N4 má viset na Vf, ale bylo zavì¹eno na VB.
  P = mìli viset a povìsil jsem / povìsil jsem
  R = mìli viset a povìsil jsem / mìli viset
  29829 vìcí mìlo viset pod slovesem a zároveò jsem je pod to
  správné sloveso i povìsil. 38412 mìlo být. 45255 bylo.
  P = 29829 / 45255 = 65,9 %
  R = 29829 / 38412 = 77,7 %
  F = 2PR/(P+R) = 71,3 %
- 8.4.2004: Koordinace: Ka¾dé "a" musí mít pod sebou koordinaci!
  Pokud tìsnì za "a" le¾í sloveso, musí to být koordinace sloves!
- 8.4.2004: 592 pøípadù (0,47 %), kdy visí Z: na VB, kdy¾ mìlo viset
  na J^. 535 pøípadù, kdy ve stejné situaci figurovalo Vp místo VB.
- 8.4.2004: Do závìru disertace: Named entities by pomohly.
- 8.4.2004: KOPR: Jak se pozná typická závislost, kterou nìjaký
  parser umí lépe ne¾ jiné parsery?
- 8.4.2004: Tomovy rady:
  - selektivní lexikalizace v¹ech nejèastìj¹ích slov bez ohledu na
    slovní druh
  - váha vzdálenosti øídícího a závislého uzlu a¾ do vzdálenosti 15
    (ale je to váha, kterou se pøenásobí celá pravdìpodobnost,
    neuchovávají se tedy samostatné èetnosti událostí o jednotlivých
    vzdálenostech)
- 8.4.2004: Vá¾ené výskyty u sloves. Zatím jsme poèítali slovesa, se
  kterými bylo dané doplnìní vidìt. Teï budeme také poèítat,
  kolikrát bylo doplnìní se kterým slovesem vidìt.
  nd = poèet výskytù doplnìní
  ns = poèet sloves celkem
  ¹ = nd / ns
  Já si do poètu sloves nezapamatuji toto sloveso 1×, ale...???
  Normalizovat na nejèastìj¹í sloveso?
  To taky nejde, nìkterá slovesa jsou extrémnì èastá!
  ¹ je nìco jako ¹ance doplnìní trefit co nejvíc sloves.
  Problém: ¹ není pravdìpodobnost. Mù¾e nabývat neomezenì vysokých
  hodnot. Jen¾e jen málo doplnìní se vyskytlo víckrát, ne¾ jaký je
  poèet sloves:
  N3 6943
  VINF 15263
  N7 10770
  J 10613
  PR4(se) 17253
  R6(v) 16186
  S 22934
  Z 31708
  N4 39375
  DB 38834
  N1 77233
  ¹(N4) = 7,1. Interpretace: Kolikrát se mohlo vyskytnout s ka¾dým
  slovesem? Tím vydìlit jeho výskyty - normalizace na èetnost - ale
  ne, to bychom dostali v¾dy poèet sloves!
- 8.4.2004: Pro ka¾dé heslo a ka¾dou vazbu si pamatovat pomìr:
  (kolikrát pod sebou má tuto vazbu) / (kolikrát se heslo vyskytlo)
  Pokud se heslo vyskytlo alespoò 5×, zapamatovat si vazbu. Pokud
  pak taková vazba ve vìtì je a dostane ji jiné heslo, které po ní
  netou¾í stejnì silnì, pokusit se pøehodnotit.
- 8.4.2004: Která valenèní doplnìní mají nejhor¹í úspì¹nost?
- 8.4.2004: Pokud existuje nìco jako typická chyba, je to závislost
  na koordinacích.
- 8.4.2004: Roztøídit chyby do skupin podle:
  - valenèní znaèky závislého uzlu
  - lemmatu chybnì navr¾eného øídícího uzlu
  - lemmatu správného øídícího uzlu
- Zkontrolovat, zda mám nejlep¹í a nejnovìj¹í seznam valencí.
- Valence pøedem: pouze pøidat do znaèek heslo tam, kde jde o sloveso.
- Valence EX POST: budovat zásobník stromù a na konci stromy seøadit
  podle míry, do jaké uspokojují valenèní po¾adavky svých uzlù.
- Vylep¹ení pøedlo¾ek: do znaèek strkat heslo, ne tvar!
- Neodvozená pøíslovce zkopírovat do znaèek.
- Podmínit lambdy konkrétními slovy (napø. u slova být potøebujeme vìdìt, ¾e
  ¹lo o slovo být, i kdyby o druhém èlenu závislosti mìly rozhodovat jen
  znaèky).
- Mo¾ná konkrétnì u slova být by stálo za to pøidat slovní tvar do znaèky.
- Dìti - na konci projít zásobník a pøehodnotit stromy podle toho,
  kolik dìtí má který uzel.
- Podmínìné pravdìpodobnosti: nejdøíve vybrat øídící uzel (napø. podle
  vzdálenosti od optimálního poètu dìtí), potom vybírat mezi jeho
  kandidáty na závislý uzel, pravdìpodobnosti jsou podmínìné.
- Je¹tì vylep¹it koordinace. A nezapomínat na apozice.
- Valence: Je-li naplnìn podmìt, u¾ nepøipojovat dal¹í. Obdobnì u koøene
  naplnìno sloveso, u pøedlo¾ky jmenná fráze.
- Valence: negativní pravdìpodobnosti: v¹em závislostem, které nevedou
  k uspokojení nìjakého valenèního po¾adavku, adekvátnì sní¾it pravdìpodobnost.
- Valence: Nelze pøeskoèit neuspokojeného zájemce.
- Pøi stejné pravdìpodobnosti dvou závislostí dát pøednost závislosti
  mezi slovy, která k sobì mají ve vìtì blí¾.
- Dal¹í zpùsob, jak èelit Honzovým chybám v pádech: pou¾ít morfologickou
  analýzu (popø. s preferencí pádu, který vybral Honza). Poznámka: Obèas nejde
  jen o pády, napøíklad infinitiv "pomoci" mylnì oznaèený jako podstatné jméno
  doká¾e taky poøádnì nabourat syntaxi.
- Vypoèítané lambdy (zkombinovat tolik rozmìrù, kolik to utáhne).
- Dal¹í otázka kromì plodnosti: je u¾ valenèní místo zaplnìno? Pokud
  ano, pravdìpodobnost je blízká nule.
- Obtí¾nìj¹í úkol: rozpoznat okam¾ik, kdy se posledního kandidáta na
  zaplnìní valenèního místa chystám povìsit jinam.
- Rozli¹ovat taggery A a B.
- Dovolit si nìkteré závislosti nerozhodnout.
- Dovolit si nìkde dát na výbìr s vahami.
- Vylep¹it plodnost. Napø. èárka má buï 0, nebo 2, ale nikdy 1. Kdy¾
  u¾ dvojka pøevá¾í nulu, je nutné to dotáhnout do konce a neskejsnout
  na jednièce.
- Nesnesitelnì magnetické souøadící spojky. Pøitom:
    - Spojka musí spojovat vìci stejného druhu.
    - Vìci, které nejsou z rùzných stran spojky, musí být oddìleny
    èárkou.
    - Alespoò 2 vìci jsou vìt¹inou spojeny, ale není to absolutnì
    platné pravidlo, spojky jako "v¹ak" se nìkdy spokojí s jediným
    èlenem.

- Distinguish the a tagger from the b tagger. Try the morphological analysis weighed using the taggers (both).
- Pomocí analýzy, co bylo kdy kam zavì¹eno, zjistit, jakto¾e lokální konflikty v souhrnu pomáhají, aèkoli jejich vlastní
  vyhodnocení øíká, ¾e to, co mají dìlat, dìlají blbì?

###############################################################################
Úkoly od Honzy:
1. Nìco udìlat s neprojektivitami (a zjistit, co s nimi dìlal Mike).
2. Pøípadnì okolo parsingu: pøevést neprojektivity na projektivity a
zpìt (=> èlánek?).
3. Eugene Charniak: ME inspired parser - prozkoumat, jak to funguje.
###############################################################################
Moje vlastní úkoly:
- Pøeèíst následující èlánky:
  M. Volk, G. Schneider: Comparing a Statistical and a Rule-Based
  Tagger for German (http://xxx.lanl.gov:80/ps/cs/9811002).
  Anoop Sarkar: Incremental Parser Generation for Tree Adjoining
  Grammar. Proceedings of 34th ACL, Student Session, Santa Cruz, 1996.



-------------
Zajímavé vìty
-------------
"Kolik má¹ vlastnì penìz, Michaeli?" ptá se snìdý novináø s brýlemi
nejslavnìj¹ího zpìváka planety.
